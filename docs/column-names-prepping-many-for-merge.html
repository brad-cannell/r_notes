<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Column Names: Prepping Many for Merge | R Notes</title>
  <meta name="description" content="This is the Bookdown for Brad Cannellâ€™s R Notes." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Column Names: Prepping Many for Merge | R Notes" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://brad-cannell.github.io/r_notes/" />
  
  <meta property="og:description" content="This is the Bookdown for Brad Cannellâ€™s R Notes." />
  <meta name="github-repo" content="brad-cannell/r_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Column Names: Prepping Many for Merge | R Notes" />
  
  <meta name="twitter:description" content="This is the Bookdown for Brad Cannellâ€™s R Notes." />
  

<meta name="author" content="Brad Cannell" />


<meta name="date" content="2022-03-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="arranging-columns-with-across.html"/>
<link rel="next" href="contingency-tables.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.20/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i>Organization</a></li>
</ul></li>
<li class="part"><span><b>I Programming</b></span></li>
<li class="chapter" data-level="1" data-path="my-package-notes.html"><a href="my-package-notes.html"><i class="fa fa-check"></i><b>1</b> Packages: Quick Start</a>
<ul>
<li class="chapter" data-level="1.1" data-path="my-package-notes.html"><a href="my-package-notes.html#overview"><i class="fa fa-check"></i><b>1.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="1.2" data-path="my-package-notes.html"><a href="my-package-notes.html#useful-websites"><i class="fa fa-check"></i><b>1.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="1.3" data-path="my-package-notes.html"><a href="my-package-notes.html#quick-process"><i class="fa fa-check"></i><b>1.3</b> Quick Process</a></li>
<li class="chapter" data-level="1.4" data-path="my-package-notes.html"><a href="my-package-notes.html#before-creating-the-package"><i class="fa fa-check"></i><b>1.4</b> Before creating the package</a></li>
<li class="chapter" data-level="1.5" data-path="my-package-notes.html"><a href="my-package-notes.html#create"><i class="fa fa-check"></i><b>1.5</b> Step 1: Create the package project</a></li>
<li class="chapter" data-level="1.6" data-path="my-package-notes.html"><a href="my-package-notes.html#notes"><i class="fa fa-check"></i><b>1.6</b> Step 2: Add a NOTES file</a></li>
<li class="chapter" data-level="1.7" data-path="my-package-notes.html"><a href="my-package-notes.html#license"><i class="fa fa-check"></i><b>1.7</b> Step 3: Add license</a></li>
<li class="chapter" data-level="1.8" data-path="my-package-notes.html"><a href="my-package-notes.html#modify"><i class="fa fa-check"></i><b>1.8</b> Step 4: Modify the description file</a></li>
<li class="chapter" data-level="1.9" data-path="my-package-notes.html"><a href="my-package-notes.html#readme"><i class="fa fa-check"></i><b>1.9</b> Step 5: Add README</a></li>
<li class="chapter" data-level="1.10" data-path="my-package-notes.html"><a href="my-package-notes.html#git"><i class="fa fa-check"></i><b>1.10</b> Step 6: Add Git</a></li>
<li class="chapter" data-level="1.11" data-path="my-package-notes.html"><a href="my-package-notes.html#github"><i class="fa fa-check"></i><b>1.11</b> Step 7: Connect to GitHub</a></li>
<li class="chapter" data-level="1.12" data-path="my-package-notes.html"><a href="my-package-notes.html#package-functions"><i class="fa fa-check"></i><b>1.12</b> Step 8: Add functions to the package</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="left-off-here..html"><a href="left-off-here..html"><i class="fa fa-check"></i><b>2</b> Left off hereâ€¦.</a>
<ul>
<li class="chapter" data-level="2.1" data-path="left-off-here..html"><a href="left-off-here..html#working-with-r-scripts"><i class="fa fa-check"></i><b>2.1</b> Working with R scripts</a></li>
<li class="chapter" data-level="2.2" data-path="left-off-here..html"><a href="left-off-here..html#step-3-writing-help-pages"><i class="fa fa-check"></i><b>2.2</b> Step 3: Writing help pages</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="left-off-here..html"><a href="left-off-here..html#example-roxygen-header"><i class="fa fa-check"></i><b>2.2.1</b> Example <code>roxygen</code> header</a></li>
<li class="chapter" data-level="2.2.2" data-path="left-off-here..html"><a href="left-off-here..html#dont-run-the-examples"><i class="fa fa-check"></i><b>2.2.2</b> Donâ€™t run the examples</a></li>
<li class="chapter" data-level="2.2.3" data-path="left-off-here..html"><a href="left-off-here..html#keyboard-shortcut-for-inserting-roxygen-comment"><i class="fa fa-check"></i><b>2.2.3</b> Keyboard shortcut for inserting roxygen #â€™ comment</a></li>
<li class="chapter" data-level="2.2.4" data-path="left-off-here..html"><a href="left-off-here..html#documenting-package"><i class="fa fa-check"></i><b>2.2.4</b> Documenting Package:</a></li>
<li class="chapter" data-level="2.2.5" data-path="left-off-here..html"><a href="left-off-here..html#once-package-is-complete-ish"><i class="fa fa-check"></i><b>2.2.5</b> Once package is complete (ish)</a></li>
<li class="chapter" data-level="2.2.6" data-path="left-off-here..html"><a href="left-off-here..html#notes-about-package-notes"><i class="fa fa-check"></i><b>2.2.6</b> Notes about package notes:</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="left-off-here..html"><a href="left-off-here..html#step-4-synchronize-with-github"><i class="fa fa-check"></i><b>2.3</b> Step 4: Synchronize with GitHub</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="left-off-here..html"><a href="left-off-here..html#get-rid-of-.ds_store"><i class="fa fa-check"></i><b>2.3.1</b> Get rid of .DS_Store</a></li>
<li class="chapter" data-level="2.3.2" data-path="left-off-here..html"><a href="left-off-here..html#example-modify-description"><i class="fa fa-check"></i><b>2.3.2</b> Example: Modify Description</a></li>
<li class="chapter" data-level="2.3.3" data-path="left-off-here..html"><a href="left-off-here..html#example-installation-instructions-for-readme"><i class="fa fa-check"></i><b>2.3.3</b> Example Installation instructions for README:</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="left-off-here..html"><a href="left-off-here..html#step-5-testing"><i class="fa fa-check"></i><b>2.4</b> Step 5: Testing</a></li>
<li class="chapter" data-level="2.5" data-path="left-off-here..html"><a href="left-off-here..html#vignettes"><i class="fa fa-check"></i><b>2.5</b> Vignettes</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="left-off-here..html"><a href="left-off-here..html#to-create-a-vignette"><i class="fa fa-check"></i><b>2.5.1</b> To create a vignette:</a></li>
<li class="chapter" data-level="2.5.2" data-path="left-off-here..html"><a href="left-off-here..html#vignette-notes"><i class="fa fa-check"></i><b>2.5.2</b> Vignette Notes:</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="left-off-here..html"><a href="left-off-here..html#adding-and-documenting-data"><i class="fa fa-check"></i><b>2.6</b> Adding and documenting data</a></li>
<li class="chapter" data-level="2.7" data-path="left-off-here..html"><a href="left-off-here..html#submitting-to-cran"><i class="fa fa-check"></i><b>2.7</b> Submitting to CRAN</a></li>
<li class="chapter" data-level="2.8" data-path="left-off-here..html"><a href="left-off-here..html#errors-warnings-notes"><i class="fa fa-check"></i><b>2.8</b> Errors, warnings, notes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="creating-rmd-templates.html"><a href="creating-rmd-templates.html"><i class="fa fa-check"></i><b>3</b> Creating Rmd Templates</a>
<ul>
<li class="chapter" data-level="3.1" data-path="creating-rmd-templates.html"><a href="creating-rmd-templates.html#overview-1"><i class="fa fa-check"></i><b>3.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="3.2" data-path="creating-rmd-templates.html"><a href="creating-rmd-templates.html#useful-websites-1"><i class="fa fa-check"></i><b>3.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="3.3" data-path="creating-rmd-templates.html"><a href="creating-rmd-templates.html#create-a-package"><i class="fa fa-check"></i><b>3.3</b> Create a package</a></li>
<li class="chapter" data-level="3.4" data-path="creating-rmd-templates.html"><a href="creating-rmd-templates.html#add-a-template-to-your-package"><i class="fa fa-check"></i><b>3.4</b> Add a template to your package</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html"><i class="fa fa-check"></i><b>4</b> Tidy Evaluation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#overview-2"><i class="fa fa-check"></i><b>4.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="4.2" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#useful-websites-2"><i class="fa fa-check"></i><b>4.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="4.3" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#load-packages"><i class="fa fa-check"></i><b>4.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="4.4" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#simulate-data"><i class="fa fa-check"></i><b>4.4</b> ğŸ”¢Simulate data</a></li>
<li class="chapter" data-level="4.5" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#load-starwars-data"><i class="fa fa-check"></i><b>4.5</b> Load Starwars data</a></li>
<li class="chapter" data-level="4.6" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#key_functions"><i class="fa fa-check"></i><b>4.6</b> Key Functions</a></li>
<li class="chapter" data-level="4.7" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#for_loop"><i class="fa fa-check"></i><b>4.7</b> Example using Tidy Eval in For Loop</a></li>
<li class="chapter" data-level="4.8" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#functions"><i class="fa fa-check"></i><b>4.8</b> Example using Tidy Eval in Functions</a></li>
<li class="chapter" data-level="4.9" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#purrr"><i class="fa fa-check"></i><b>4.9</b> Using tidyeval with purrr</a></li>
<li class="chapter" data-level="4.10" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#quirks"><i class="fa fa-check"></i><b>4.10</b> Other Quirks and Lessons Learned</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#when-doesnt-work"><i class="fa fa-check"></i><b>4.10.1</b> When !! doesnâ€™t work</a></li>
<li class="chapter" data-level="4.10.2" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#unquoting-inside-non-dplyr-functions"><i class="fa fa-check"></i><b>4.10.2</b> Unquoting inside non-dplyr functions</a></li>
<li class="chapter" data-level="4.10.3" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#using-a-quoture-to-create-variable-name-in-mutate"><i class="fa fa-check"></i><b>4.10.3</b> Using a quoture to create variable name in mutate</a></li>
<li class="chapter" data-level="4.10.4" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#using-a-quoture-to-turn-a-variable-name-into-a-constant-value"><i class="fa fa-check"></i><b>4.10.4</b> Using a quoture to turn a variable name into a constant value</a></li>
<li class="chapter" data-level="4.10.5" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#convert-a-string-to-a-quoture"><i class="fa fa-check"></i><b>4.10.5</b> Convert a string to a quoture</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#example-i-created-for-steph-yap"><i class="fa fa-check"></i><b>4.11</b> Example I created for Steph Yap</a></li>
<li class="chapter" data-level="4.12" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#other"><i class="fa fa-check"></i><b>4.12</b> Other questions / notes / reminders</a></li>
</ul></li>
<li class="part"><span><b>II Working with External Files</b></span></li>
<li class="part"><span><b>III Data Management</b></span></li>
<li class="chapter" data-level="5" data-path="arranging-columns-with-across.html"><a href="arranging-columns-with-across.html"><i class="fa fa-check"></i><b>5</b> Arranging Columns with Across</a>
<ul>
<li class="chapter" data-level="5.1" data-path="arranging-columns-with-across.html"><a href="arranging-columns-with-across.html#solution-by-lmc"><i class="fa fa-check"></i><b>5.1</b> Solution by LMc:</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html"><i class="fa fa-check"></i><b>6</b> Column Names: Prepping Many for Merge</a>
<ul>
<li class="chapter" data-level="6.1" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#overview-3"><i class="fa fa-check"></i><b>6.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="6.2" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#useful-websites-3"><i class="fa fa-check"></i><b>6.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="6.3" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#load-packages-1"><i class="fa fa-check"></i><b>6.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="6.4" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#simulate-data-1"><i class="fa fa-check"></i><b>6.4</b> ğŸ”¢Simulate data</a></li>
<li class="chapter" data-level="6.5" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#get-the-existing-column-names"><i class="fa fa-check"></i><b>6.5</b> Get the existing column names</a></li>
<li class="chapter" data-level="6.6" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#standardize-new-column-names"><i class="fa fa-check"></i><b>6.6</b> Standardize new column names</a></li>
<li class="chapter" data-level="6.7" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#turn-this-into-a-function"><i class="fa fa-check"></i><b>6.7</b> Turn this into a function</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#make-a-unit-test-for-the-function"><i class="fa fa-check"></i><b>6.7.1</b> Make a unit test for the function</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#manual-changes-to-column-names"><i class="fa fa-check"></i><b>6.8</b> Manual changes to column names</a></li>
<li class="chapter" data-level="6.9" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#have-r-write-out-the-rename-code"><i class="fa fa-check"></i><b>6.9</b> Have R write out the rename code</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#make-it-a-function"><i class="fa fa-check"></i><b>6.9.1</b> Make it a function</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#rename-the-columns"><i class="fa fa-check"></i><b>6.10</b> Rename the columns</a></li>
<li class="chapter" data-level="6.11" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#repeat-the-process-for-v2"><i class="fa fa-check"></i><b>6.11</b> Repeat the process for V2</a></li>
<li class="chapter" data-level="6.12" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#repeat-the-process-for-v3"><i class="fa fa-check"></i><b>6.12</b> Repeat the process for V3</a></li>
<li class="chapter" data-level="6.13" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#merge-all-3-visits"><i class="fa fa-check"></i><b>6.13</b> Merge all 3 visits</a></li>
<li class="chapter" data-level="6.14" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#final-data-cleaning"><i class="fa fa-check"></i><b>6.14</b> Final data cleaning</a></li>
<li class="chapter" data-level="6.15" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#the-dplyr-way"><i class="fa fa-check"></i><b>6.15</b> ğŸŸ£The dplyr way</a>
<ul>
<li class="chapter" data-level="6.15.1" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#standardize-new-column-names-1"><i class="fa fa-check"></i><b>6.15.1</b> Standardize new column names</a></li>
<li class="chapter" data-level="6.15.2" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#manual-changes-to-column-names-1"><i class="fa fa-check"></i><b>6.15.2</b> Manual changes to column names 1</a></li>
<li class="chapter" data-level="6.15.3" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#merge-all-3-visits-1"><i class="fa fa-check"></i><b>6.15.3</b> Merge all 3 visits</a></li>
<li class="chapter" data-level="6.15.4" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#manual-changes-to-column-names-2"><i class="fa fa-check"></i><b>6.15.4</b> Manual changes to column names 2</a></li>
<li class="chapter" data-level="6.15.5" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#final-data-cleaning-1"><i class="fa fa-check"></i><b>6.15.5</b> Final data cleaning</a></li>
</ul></li>
<li class="chapter" data-level="6.16" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#making-a-key-in-google-sheets"><i class="fa fa-check"></i><b>6.16</b> ğŸŸ¢ Making a key in Google Sheets</a>
<ul>
<li class="chapter" data-level="6.16.1" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#create-the-google-sheet-column-name-key"><i class="fa fa-check"></i><b>6.16.1</b> Create the Google Sheet column name key</a></li>
<li class="chapter" data-level="6.16.2" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#import-the-google-sheet-column-name-key"><i class="fa fa-check"></i><b>6.16.2</b> Import the Google Sheet column name key</a></li>
<li class="chapter" data-level="6.16.3" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#reorder-and-rename-the-current-data-frame"><i class="fa fa-check"></i><b>6.16.3</b> Reorder and rename the current data frame</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Analysis</b></span></li>
<li class="chapter" data-level="7" data-path="contingency-tables.html"><a href="contingency-tables.html"><i class="fa fa-check"></i><b>7</b> Contingency Tables</a>
<ul>
<li class="chapter" data-level="7.1" data-path="contingency-tables.html"><a href="contingency-tables.html#overview-4"><i class="fa fa-check"></i><b>7.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="7.2" data-path="contingency-tables.html"><a href="contingency-tables.html#useful-websites-4"><i class="fa fa-check"></i><b>7.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="7.3" data-path="contingency-tables.html"><a href="contingency-tables.html#load-packages-2"><i class="fa fa-check"></i><b>7.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="7.4" data-path="contingency-tables.html"><a href="contingency-tables.html#scenario"><i class="fa fa-check"></i><b>7.4</b> Scenario</a></li>
<li class="chapter" data-level="7.5" data-path="contingency-tables.html"><a href="contingency-tables.html#manually-create-data"><i class="fa fa-check"></i><b>7.5</b> Manually create data</a></li>
<li class="chapter" data-level="7.6" data-path="contingency-tables.html"><a href="contingency-tables.html#matrix"><i class="fa fa-check"></i><b>7.6</b> Matrix</a></li>
<li class="chapter" data-level="7.7" data-path="contingency-tables.html"><a href="contingency-tables.html#table"><i class="fa fa-check"></i><b>7.7</b> Table</a></li>
<li class="chapter" data-level="7.8" data-path="contingency-tables.html"><a href="contingency-tables.html#base-r-data-frame-with-rownames"><i class="fa fa-check"></i><b>7.8</b> Base R data frame with rownames</a></li>
<li class="chapter" data-level="7.9" data-path="contingency-tables.html"><a href="contingency-tables.html#tibble"><i class="fa fa-check"></i><b>7.9</b> Tibble</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="effect-measure-modification.html"><a href="effect-measure-modification.html"><i class="fa fa-check"></i><b>8</b> Effect-measure modification</a>
<ul>
<li class="chapter" data-level="8.1" data-path="effect-measure-modification.html"><a href="effect-measure-modification.html#overview-5"><i class="fa fa-check"></i><b>8.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="8.2" data-path="effect-measure-modification.html"><a href="effect-measure-modification.html#useful-websites-5"><i class="fa fa-check"></i><b>8.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="8.3" data-path="effect-measure-modification.html"><a href="effect-measure-modification.html#load-packages-3"><i class="fa fa-check"></i><b>8.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="8.4" data-path="effect-measure-modification.html"><a href="effect-measure-modification.html#simulate-data-2"><i class="fa fa-check"></i><b>8.4</b> ğŸ”¢Simulate data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="risk-difference.html"><a href="risk-difference.html"><i class="fa fa-check"></i><b>9</b> Risk Difference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="risk-difference.html"><a href="risk-difference.html#overview-6"><i class="fa fa-check"></i><b>9.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="9.2" data-path="risk-difference.html"><a href="risk-difference.html#useful-websites-6"><i class="fa fa-check"></i><b>9.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="9.3" data-path="risk-difference.html"><a href="risk-difference.html#load-packages-4"><i class="fa fa-check"></i><b>9.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="9.4" data-path="risk-difference.html"><a href="risk-difference.html#data-summary"><i class="fa fa-check"></i><b>9.4</b> Data Summary</a></li>
<li class="chapter" data-level="9.5" data-path="risk-difference.html"><a href="risk-difference.html#simulate-data-3"><i class="fa fa-check"></i><b>9.5</b> ğŸ”¢Simulate data</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="risk-difference.html"><a href="risk-difference.html#simulate-a-matrix-object"><i class="fa fa-check"></i><b>9.5.1</b> Simulate a matrix object</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="risk-difference.html"><a href="risk-difference.html#analysis"><i class="fa fa-check"></i><b>9.6</b> ğŸ“ˆAnalysis</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="risk-difference.html"><a href="risk-difference.html#incidence-proportion"><i class="fa fa-check"></i><b>9.6.1</b> Incidence proportion</a></li>
<li class="chapter" data-level="9.6.2" data-path="risk-difference.html"><a href="risk-difference.html#risk-differences"><i class="fa fa-check"></i><b>9.6.2</b> Risk Differences</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Data Visualization</b></span></li>
<li class="part"><span><b>VI Presenting Results</b></span></li>
<li class="chapter" data-level="10" data-path="blogdown.html"><a href="blogdown.html"><i class="fa fa-check"></i><b>10</b> Blogdown</a>
<ul>
<li class="chapter" data-level="10.1" data-path="blogdown.html"><a href="blogdown.html#overview-7"><i class="fa fa-check"></i><b>10.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="10.2" data-path="blogdown.html"><a href="blogdown.html#useful-websites-7"><i class="fa fa-check"></i><b>10.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="10.3" data-path="blogdown.html"><a href="blogdown.html#load-packages-5"><i class="fa fa-check"></i><b>10.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="10.4" data-path="blogdown.html"><a href="blogdown.html#blogdown-commands-to-remember"><i class="fa fa-check"></i><b>10.4</b> Blogdown commands to remember</a></li>
<li class="chapter" data-level="10.5" data-path="blogdown.html"><a href="blogdown.html#creating-new-content"><i class="fa fa-check"></i><b>10.5</b> Creating new content</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="blogdown.html"><a href="blogdown.html#step-1.-create-a-landing-page"><i class="fa fa-check"></i><b>10.5.1</b> Step 1. Create a landing page</a></li>
<li class="chapter" data-level="10.5.2" data-path="blogdown.html"><a href="blogdown.html#step-2.-add-widgets-to-the-landing-page"><i class="fa fa-check"></i><b>10.5.2</b> Step 2. Add widgets to the landing page</a></li>
<li class="chapter" data-level="10.5.3" data-path="blogdown.html"><a href="blogdown.html#step-3.-add-content-to-the-widgets"><i class="fa fa-check"></i><b>10.5.3</b> Step 3. Add content to the widgets</a></li>
<li class="chapter" data-level="10.5.4" data-path="blogdown.html"><a href="blogdown.html#step-4.-add-a-banner-image-to-the-landing-page."><i class="fa fa-check"></i><b>10.5.4</b> Step 4. Add a banner image to the landing page.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="blogdown.html"><a href="blogdown.html#editing-widget-metadata"><i class="fa fa-check"></i><b>10.6</b> Editing widget metadata</a></li>
<li class="chapter" data-level="10.7" data-path="blogdown.html"><a href="blogdown.html#editing-about-widget-content"><i class="fa fa-check"></i><b>10.7</b> Editing about widget content</a></li>
<li class="chapter" data-level="10.8" data-path="blogdown.html"><a href="blogdown.html#adjusting-site-configuration-files"><i class="fa fa-check"></i><b>10.8</b> Adjusting site configuration files</a></li>
<li class="chapter" data-level="10.9" data-path="blogdown.html"><a href="blogdown.html#other-little-adjustments"><i class="fa fa-check"></i><b>10.9</b> Other little adjustments</a></li>
<li class="chapter" data-level="10.10" data-path="blogdown.html"><a href="blogdown.html#custom-css"><i class="fa fa-check"></i><b>10.10</b> Custom CSS</a></li>
<li class="chapter" data-level="10.11" data-path="blogdown.html"><a href="blogdown.html#changing-the-domain"><i class="fa fa-check"></i><b>10.11</b> Changing the domain</a></li>
<li class="chapter" data-level="10.12" data-path="blogdown.html"><a href="blogdown.html#error-fixes"><i class="fa fa-check"></i><b>10.12</b> Error fixes</a>
<ul>
<li class="chapter" data-level="10.12.1" data-path="blogdown.html"><a href="blogdown.html#blogdowncheck_netlify"><i class="fa fa-check"></i><b>10.12.1</b> blogdown::check_netlify()</a></li>
</ul></li>
<li class="chapter" data-level="10.13" data-path="blogdown.html"><a href="blogdown.html#adding-google-analytics"><i class="fa fa-check"></i><b>10.13</b> Adding Google Analytics</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="book-chapters.html"><a href="book-chapters.html"><i class="fa fa-check"></i><b>11</b> Bookdown: Creating Book Chapters</a>
<ul>
<li class="chapter" data-level="11.1" data-path="book-chapters.html"><a href="book-chapters.html#chapter-overview"><i class="fa fa-check"></i><b>11.1</b> Chapter overview</a></li>
<li class="chapter" data-level="11.2" data-path="book-chapters.html"><a href="book-chapters.html#motivating-example"><i class="fa fa-check"></i><b>11.2</b> Motivating example</a></li>
<li class="chapter" data-level="11.3" data-path="book-chapters.html"><a href="book-chapters.html#body"><i class="fa fa-check"></i><b>11.3</b> Body</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="book-chapters.html"><a href="book-chapters.html#language"><i class="fa fa-check"></i><b>11.3.1</b> Language</a></li>
<li class="chapter" data-level="11.3.2" data-path="book-chapters.html"><a href="book-chapters.html#text-conventions"><i class="fa fa-check"></i><b>11.3.2</b> Text conventions</a></li>
<li class="chapter" data-level="11.3.3" data-path="book-chapters.html"><a href="book-chapters.html#special-sections"><i class="fa fa-check"></i><b>11.3.3</b> Special sections</a></li>
<li class="chapter" data-level="11.3.4" data-path="book-chapters.html"><a href="book-chapters.html#images"><i class="fa fa-check"></i><b>11.3.4</b> Images</a></li>
<li class="chapter" data-level="11.3.5" data-path="book-chapters.html"><a href="book-chapters.html#font-awesome"><i class="fa fa-check"></i><b>11.3.5</b> Font Awesome</a></li>
<li class="chapter" data-level="11.3.6" data-path="book-chapters.html"><a href="book-chapters.html#links"><i class="fa fa-check"></i><b>11.3.6</b> Links</a></li>
<li class="chapter" data-level="11.3.7" data-path="book-chapters.html"><a href="book-chapters.html#code-blocks"><i class="fa fa-check"></i><b>11.3.7</b> Code blocks</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="book-chapters.html"><a href="book-chapters.html#cross-references"><i class="fa fa-check"></i><b>11.4</b> Cross-references</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="book-chapters.html"><a href="book-chapters.html#cr-figs"><i class="fa fa-check"></i><b>11.4.1</b> Cross-referencing figures</a></li>
<li class="chapter" data-level="11.4.2" data-path="book-chapters.html"><a href="book-chapters.html#cross-referencing-chapters"><i class="fa fa-check"></i><b>11.4.2</b> Cross-referencing chapters</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="book-chapters.html"><a href="book-chapters.html#citations"><i class="fa fa-check"></i><b>11.5</b> Citations</a></li>
<li class="chapter" data-level="11.6" data-path="book-chapters.html"><a href="book-chapters.html#previewing-the-chapter"><i class="fa fa-check"></i><b>11.6</b> Previewing the chapter</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="book-chapters.html"><a href="book-chapters.html#miscelaneous"><i class="fa fa-check"></i><b>11.6.1</b> Miscelaneous</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="book-chapters.html"><a href="book-chapters.html#additional-resources-function-to-check"><i class="fa fa-check"></i><b>11.7</b> Additional resources: function to check</a></li>
<li class="chapter" data-level="11.8" data-path="book-chapters.html"><a href="book-chapters.html#key-terms-function-to-add-to-appendix"><i class="fa fa-check"></i><b>11.8</b> Key terms : function to add to appendix</a></li>
<li class="chapter" data-level="11.9" data-path="book-chapters.html"><a href="book-chapters.html#final-example-code-function-to-add-to-appendix"><i class="fa fa-check"></i><b>11.9</b> Final example code : function to add to appendix</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html"><i class="fa fa-check"></i><b>12</b> Bookdown: Quick Start</a>
<ul>
<li class="chapter" data-level="12.1" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#overview-8"><i class="fa fa-check"></i><b>12.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="12.2" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#useful-websites-8"><i class="fa fa-check"></i><b>12.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="12.3" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#creating-the-bookdown-project-locally"><i class="fa fa-check"></i><b>12.3</b> Creating the bookdown project locally</a></li>
<li class="chapter" data-level="12.4" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#initiate-a-git-repository"><i class="fa fa-check"></i><b>12.4</b> Initiate a git repository</a></li>
<li class="chapter" data-level="12.5" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#create-a-github-repository-for-the-book"><i class="fa fa-check"></i><b>12.5</b> Create a github repository for the book</a></li>
<li class="chapter" data-level="12.6" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#configuring-a-publishing-source-for-the-github-pages-site"><i class="fa fa-check"></i><b>12.6</b> Configuring a publishing source for the GitHub Pages site</a></li>
<li class="chapter" data-level="12.7" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#modify-_bookdown.yml"><i class="fa fa-check"></i><b>12.7</b> Modify _bookdown.yml</a></li>
<li class="chapter" data-level="12.8" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#modify-_output.yml"><i class="fa fa-check"></i><b>12.8</b> Modify _output.yml</a></li>
<li class="chapter" data-level="12.9" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#modify-style.css"><i class="fa fa-check"></i><b>12.9</b> Modify style.css</a></li>
<li class="chapter" data-level="12.10" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#modify-index.rmd"><i class="fa fa-check"></i><b>12.10</b> Modify index.Rmd</a></li>
<li class="chapter" data-level="12.11" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#creating-bookdown-chapters"><i class="fa fa-check"></i><b>12.11</b> Creating bookdown chapters</a></li>
<li class="chapter" data-level="12.12" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#knitting-the-book"><i class="fa fa-check"></i><b>12.12</b> Knitting the book</a></li>
<li class="chapter" data-level="12.13" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#errors-and-warnings"><i class="fa fa-check"></i><b>12.13</b> Errors and warnings</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="flexdashboard.html"><a href="flexdashboard.html"><i class="fa fa-check"></i><b>13</b> Flexdashboard</a>
<ul>
<li class="chapter" data-level="13.1" data-path="flexdashboard.html"><a href="flexdashboard.html#overview-9"><i class="fa fa-check"></i><b>13.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="13.2" data-path="flexdashboard.html"><a href="flexdashboard.html#useful-websites-9"><i class="fa fa-check"></i><b>13.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="13.3" data-path="flexdashboard.html"><a href="flexdashboard.html#load-packages-6"><i class="fa fa-check"></i><b>13.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="13.4" data-path="flexdashboard.html"><a href="flexdashboard.html#tips"><i class="fa fa-check"></i><b>13.4</b> Tips</a></li>
<li class="chapter" data-level="13.5" data-path="flexdashboard.html"><a href="flexdashboard.html#simulate-data-4"><i class="fa fa-check"></i><b>13.5</b> ğŸ”¢Simulate data</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="flextable.html"><a href="flextable.html"><i class="fa fa-check"></i><b>14</b> Flextable</a>
<ul>
<li class="chapter" data-level="14.1" data-path="flextable.html"><a href="flextable.html#overview-10"><i class="fa fa-check"></i><b>14.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="14.2" data-path="flextable.html"><a href="flextable.html#useful-websites-10"><i class="fa fa-check"></i><b>14.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="14.3" data-path="flextable.html"><a href="flextable.html#load-packages-7"><i class="fa fa-check"></i><b>14.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="14.4" data-path="flextable.html"><a href="flextable.html#load-data"><i class="fa fa-check"></i><b>14.4</b> Load data</a></li>
<li class="chapter" data-level="14.5" data-path="flextable.html"><a href="flextable.html#i-and-j"><i class="fa fa-check"></i><b>14.5</b> ğŸ”µ i and j</a></li>
<li class="chapter" data-level="14.6" data-path="flextable.html"><a href="flextable.html#flextable-wrappers"><i class="fa fa-check"></i><b>14.6</b> ğŸ”µ Flextable wrappers</a></li>
<li class="chapter" data-level="14.7" data-path="flextable.html"><a href="flextable.html#addingmodifying-table-content"><i class="fa fa-check"></i><b>14.7</b> ğŸ”µ Adding/modifying table content</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="flextable.html"><a href="flextable.html#add-table-title-with-bold-part"><i class="fa fa-check"></i><b>14.7.1</b> Add table title with bold part</a></li>
<li class="chapter" data-level="14.7.2" data-path="flextable.html"><a href="flextable.html#adding-blank-rows"><i class="fa fa-check"></i><b>14.7.2</b> Adding blank rows</a></li>
<li class="chapter" data-level="14.7.3" data-path="flextable.html"><a href="flextable.html#change-column-header-text"><i class="fa fa-check"></i><b>14.7.3</b> Change column header text</a></li>
<li class="chapter" data-level="14.7.4" data-path="flextable.html"><a href="flextable.html#change-row-header-text"><i class="fa fa-check"></i><b>14.7.4</b> Change row header text</a></li>
<li class="chapter" data-level="14.7.5" data-path="flextable.html"><a href="flextable.html#add-footnote"><i class="fa fa-check"></i><b>14.7.5</b> Add footnote</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="flextable.html"><a href="flextable.html#formatting"><i class="fa fa-check"></i><b>14.8</b> ğŸ”µ Formatting</a>
<ul>
<li class="chapter" data-level="14.8.1" data-path="flextable.html"><a href="flextable.html#change-font-to-tnr"><i class="fa fa-check"></i><b>14.8.1</b> Change font to TNR</a></li>
<li class="chapter" data-level="14.8.2" data-path="flextable.html"><a href="flextable.html#conditional-formatting"><i class="fa fa-check"></i><b>14.8.2</b> Conditional formatting</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="flextable.html"><a href="flextable.html#layout"><i class="fa fa-check"></i><b>14.9</b> ğŸ”µLayout</a>
<ul>
<li class="chapter" data-level="14.9.1" data-path="flextable.html"><a href="flextable.html#autofit-to-contents"><i class="fa fa-check"></i><b>14.9.1</b> Autofit to contents</a></li>
</ul></li>
<li class="chapter" data-level="14.10" data-path="flextable.html"><a href="flextable.html#examples"><i class="fa fa-check"></i><b>14.10</b> ğŸ”µ Examples</a>
<ul>
<li class="chapter" data-level="14.10.1" data-path="flextable.html"><a href="flextable.html#lead-panel-summarize-votes"><i class="fa fa-check"></i><b>14.10.1</b> LEAD panel summarize votes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="language-for-publications.html"><a href="language-for-publications.html"><i class="fa fa-check"></i><b>15</b> Language for publications</a>
<ul>
<li class="chapter" data-level="15.1" data-path="language-for-publications.html"><a href="language-for-publications.html#overview-11"><i class="fa fa-check"></i><b>15.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="15.2" data-path="language-for-publications.html"><a href="language-for-publications.html#useful-websites-11"><i class="fa fa-check"></i><b>15.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="15.3" data-path="language-for-publications.html"><a href="language-for-publications.html#load-packages-8"><i class="fa fa-check"></i><b>15.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="15.4" data-path="language-for-publications.html"><a href="language-for-publications.html#statistical-software"><i class="fa fa-check"></i><b>15.4</b> Statistical software</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="language-for-publications.html"><a href="language-for-publications.html#r"><i class="fa fa-check"></i><b>15.4.1</b> R</a></li>
<li class="chapter" data-level="15.4.2" data-path="language-for-publications.html"><a href="language-for-publications.html#stata"><i class="fa fa-check"></i><b>15.4.2</b> Stata</a></li>
<li class="chapter" data-level="15.4.3" data-path="language-for-publications.html"><a href="language-for-publications.html#sas"><i class="fa fa-check"></i><b>15.4.3</b> SAS</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="language-for-publications.html"><a href="language-for-publications.html#irb"><i class="fa fa-check"></i><b>15.5</b> IRB</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="officer.html"><a href="officer.html"><i class="fa fa-check"></i><b>16</b> Officer</a>
<ul>
<li class="chapter" data-level="16.1" data-path="officer.html"><a href="officer.html#overview-12"><i class="fa fa-check"></i><b>16.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="16.2" data-path="officer.html"><a href="officer.html#useful-websites-12"><i class="fa fa-check"></i><b>16.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="16.3" data-path="officer.html"><a href="officer.html#load-packages-9"><i class="fa fa-check"></i><b>16.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="16.4" data-path="officer.html"><a href="officer.html#formatted-text"><i class="fa fa-check"></i><b>16.4</b> Formatted text</a></li>
<li class="chapter" data-level="16.5" data-path="officer.html"><a href="officer.html#bulleted-list"><i class="fa fa-check"></i><b>16.5</b> Bulleted list</a></li>
<li class="chapter" data-level="16.6" data-path="officer.html"><a href="officer.html#adding-on-to-the-end-of-a-file."><i class="fa fa-check"></i><b>16.6</b> Adding on to the end of a file.</a></li>
<li class="chapter" data-level="16.7" data-path="officer.html"><a href="officer.html#using-bookmarks"><i class="fa fa-check"></i><b>16.7</b> Using bookmarks</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>17</b> Tables</a>
<ul>
<li class="chapter" data-level="17.1" data-path="tables.html"><a href="tables.html#overview-13"><i class="fa fa-check"></i><b>17.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="17.2" data-path="tables.html"><a href="tables.html#projects-to-review-and-incorporate"><i class="fa fa-check"></i><b>17.2</b> Projects to review and incorporate</a></li>
<li class="chapter" data-level="17.3" data-path="tables.html"><a href="tables.html#useful-websites-13"><i class="fa fa-check"></i><b>17.3</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="17.4" data-path="tables.html"><a href="tables.html#load-packages-10"><i class="fa fa-check"></i><b>17.4</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="17.5" data-path="tables.html"><a href="tables.html#simulate-data-5"><i class="fa fa-check"></i><b>17.5</b> ğŸ”¢Simulate data</a></li>
<li class="chapter" data-level="17.6" data-path="tables.html"><a href="tables.html#example-table-1"><i class="fa fa-check"></i><b>17.6</b> ğŸ”µ Example: Table 1</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="tables.html"><a href="tables.html#step-1.-calculate-the-outcome-distribution"><i class="fa fa-check"></i><b>17.6.1</b> Step 1. Calculate the outcome distribution</a></li>
<li class="chapter" data-level="17.6.2" data-path="tables.html"><a href="tables.html#step-2.-prepare-to-calculate-summary-statistics"><i class="fa fa-check"></i><b>17.6.2</b> Step 2. Prepare to calculate summary statistics</a></li>
<li class="chapter" data-level="17.6.3" data-path="tables.html"><a href="tables.html#step-3.-create-a-data-frame-that-contains-our-summary-statistics"><i class="fa fa-check"></i><b>17.6.3</b> Step 3. Create a data frame that contains our summary statistics</a></li>
<li class="chapter" data-level="17.6.4" data-path="tables.html"><a href="tables.html#step-5.-create-flextable"><i class="fa fa-check"></i><b>17.6.4</b> Step 5. Create flextable</a></li>
<li class="chapter" data-level="17.6.5" data-path="tables.html"><a href="tables.html#step-6.-formatting-flextable"><i class="fa fa-check"></i><b>17.6.5</b> Step 6. Formatting flextable</a></li>
<li class="chapter" data-level="17.6.6" data-path="tables.html"><a href="tables.html#load-word-template-for-officer"><i class="fa fa-check"></i><b>17.6.6</b> ğŸ“ Load Word template for officer</a></li>
<li class="chapter" data-level="17.6.7" data-path="tables.html"><a href="tables.html#generate-word-reports"><i class="fa fa-check"></i><b>17.6.7</b> ğŸ“ Generate Word reports</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII Shiny</b></span></li>
<li class="part"><span><b>VIII Collaborating</b></span></li>
<li class="chapter" data-level="18" data-path="git-and-github.html"><a href="git-and-github.html"><i class="fa fa-check"></i><b>18</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="18.1" data-path="git-and-github.html"><a href="git-and-github.html#overview-14"><i class="fa fa-check"></i><b>18.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="18.2" data-path="git-and-github.html"><a href="git-and-github.html#useful-websites-14"><i class="fa fa-check"></i><b>18.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="18.3" data-path="git-and-github.html"><a href="git-and-github.html#get-rid-of-.ds_store-1"><i class="fa fa-check"></i><b>18.3</b> Get rid of .DS_Store</a></li>
<li class="chapter" data-level="18.4" data-path="git-and-github.html"><a href="git-and-github.html#amend"><i class="fa fa-check"></i><b>18.4</b> Amend</a></li>
<li class="chapter" data-level="18.5" data-path="git-and-github.html"><a href="git-and-github.html#pull-requests"><i class="fa fa-check"></i><b>18.5</b> Pull Requests</a></li>
<li class="chapter" data-level="18.6" data-path="git-and-github.html"><a href="git-and-github.html#branches"><i class="fa fa-check"></i><b>18.6</b> Branches</a></li>
</ul></li>
<li class="part"><span><b>IX Appendix</b></span></li>
<li class="chapter" data-level="19" data-path="appendix-a-terms-and-definitions.html"><a href="appendix-a-terms-and-definitions.html"><i class="fa fa-check"></i><b>19</b> Appendix A: Terms and Definitions</a>
<ul>
<li class="chapter" data-level="19.1" data-path="appendix-a-terms-and-definitions.html"><a href="appendix-a-terms-and-definitions.html#overview-15"><i class="fa fa-check"></i><b>19.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="19.2" data-path="appendix-a-terms-and-definitions.html"><a href="appendix-a-terms-and-definitions.html#useful-websites-15"><i class="fa fa-check"></i><b>19.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="19.3" data-path="appendix-a-terms-and-definitions.html"><a href="appendix-a-terms-and-definitions.html#terms"><i class="fa fa-check"></i><b>19.3</b> ğŸ“–Terms</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="appendix-a-terms-and-definitions.html"><a href="appendix-a-terms-and-definitions.html#general-terms"><i class="fa fa-check"></i><b>19.3.1</b> General Terms</a></li>
<li class="chapter" data-level="19.3.2" data-path="appendix-a-terms-and-definitions.html"><a href="appendix-a-terms-and-definitions.html#general-statistics-terms"><i class="fa fa-check"></i><b>19.3.2</b> General statistics terms</a></li>
<li class="chapter" data-level="19.3.3" data-path="appendix-a-terms-and-definitions.html"><a href="appendix-a-terms-and-definitions.html#measures-of-occurence"><i class="fa fa-check"></i><b>19.3.3</b> Measures of occurence</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="column-names-prepping-many-for-merge" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Column Names: Prepping Many for Merge</h1>
<!--
Hidden comments placeholder
-->
<p><img src="https://picsum.photos/200/300" /><!-- --></p>
<div id="overview-3" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> â­ï¸Overview</h2>
<p>The inspiration for this chapter came about when I was trying to merge the QDS visit 1 through visit 5 files that were part of the Link2Care project. All of the QDS files (plus some other files) needed to be merged together into a final analysis data set. However, not all questions were asked at all visits and column names were inconsistently used across visits. Even when the names were almost the same, a visit number was attached to the name (e.g., TODAY_V1, TODAY_V2, TODAY_V3, etc.). Finally, each data set contained 800+ columns, which made renaming them all manually tedious and error prone. So, Iâ€™m trying to come up with a better way.</p>
<p>One method I came up with was reading in the variable names from the Word codebooks and then modifying them. Using this method required making some custom styles in Word and applying those styles to the column names. This seemed to work pretty well at first, but then Joe and James made some changes to QDS, which rendered the codebooks Iâ€™d made all the changes to obsolete. This left me with two options:</p>
<ol style="list-style-type: decimal">
<li><p>Have some of the variable name adjustments pulled from the codebook and some of the variable name adjustments done manually in the R code (e.g., T26, visit type).</p></li>
<li><p>Keep all of the adjustments in the codebook, which means converting the new codebooks to word documents, and going back through them to format all of the old column names again.</p></li>
</ol>
<p>Neither of these options seems very robust or future-proof. While it might be a lot of work upfront, Iâ€™m starting to think that just doing all of the variable renaming in the R code might be the way to go. Below, Iâ€™m going to play around with how to automate as much of this process as possible.</p>
</div>
<div id="useful-websites-3" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> ğŸŒUseful websites</h2>
<ul>
<li><a href="https://github.com/brad-cannell/link2care_public/issues/1">GitHub issue</a><br />
</li>
<li><a href="https://www.r4epi.com/subsetting-data-frames.html">R4Epi rename_with exampe</a><br />
</li>
<li><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with documentation</a><br />
</li>
<li><a href="https://arbor-analytics.com/post/getting-your-data-into-r-from-google-sheets/">Getting your data into R from Google Sheets</a><br />
</li>
<li><a href="https://community.rstudio.com/t/rename-with-a-named-vector-list-and-contribution-to-the-tidyverse/2383">RStudio Community: Rename with a named vector/list and contribution to the tidyverse</a></li>
</ul>
</div>
<div id="load-packages-1" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> ğŸ“¦Load packages</h2>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="column-names-prepping-many-for-merge.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb137-2"><a href="column-names-prepping-many-for-merge.html#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb137-3"><a href="column-names-prepping-many-for-merge.html#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(testthat)</span>
<span id="cb137-4"><a href="column-names-prepping-many-for-merge.html#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb137-5"><a href="column-names-prepping-many-for-merge.html#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb137-6"><a href="column-names-prepping-many-for-merge.html#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(googlesheets4)</span></code></pre></div>
</div>
<div id="simulate-data-1" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> ğŸ”¢Simulate data</h2>
<p>Simulate 3 QDS data sets. Donâ€™t worry about the values much. They really arenâ€™t the issue for this example.</p>
<ul>
<li><code>SUBJECT</code>: No change in column name across visits.<br />
</li>
<li><code>TODAY_V</code> and VISIT_V: The _V1, _V2, _V3 part changes.<br />
</li>
<li><code>SQ_2</code>: Only exists in v1, and the name is altered.<br />
</li>
<li><code>GROUP</code>: Only exists in v3.<br />
</li>
<li><code>WEIGHT</code> and <code>WEIGHT3</code>: Doesnâ€™t exist in v2 and doesnâ€™t follow any naming convention.<br />
</li>
<li><code>DEMO16G</code> and <code>DEM14GV3</code>: The variable was named incorrectly in v1.<br />
</li>
<li><code>DS10A_V2</code>: Only asked in v2 and doesnâ€™t follow typical naming convention.<br />
</li>
<li><code>DEM15V1</code>: Only asked in v1 and I want to change the name completely.<br />
</li>
<li><code>T26A_V1</code>: Only exists in v1 and v3. Also, it needs to be renamed.<br />
</li>
<li><code>T26A_V1A</code> and <code>T26A_V1B</code>: Only exists in v1 and v3. Needs to be renamed, and it requires using the dummy variable naming convention.<br />
</li>
<li><code>T31_V1B</code>, <code>T31_V3B</code>, <code>T31B_V1</code>, and <code>T31B_V3</code>: Added these later. In v1, v3, v4, and v5 there is a column named <code>T31B_V1</code> and a column named <code>T31_V1B</code>. The <code>standardize_col_names()</code> function converts both of these to <code>t_31b</code>, which causes <code>rename_with()</code> to throw an error. Further, I canâ€™t just manually change it to <code>t33</code> (what it will ultimately end up being named) before I run <code>standardize_col_names()</code> because then in conflicts with <code>T33_V1</code>. I need to find a solution inside of the <code>standardize_col_names()</code> function.</li>
</ul>
<p>Additionally, we want to convert all column names to lower case and follow these naming conventions:</p>
<ul>
<li>The typical way that variables are named in these data sets is:
<ul>
<li><abbreviated_tool_name><question_number>[optionally:dummy_variable_lettered]
<ul>
<li>For example: BPM1_V1, LSN3_V1<br />
</li>
</ul></li>
<li><abbreviated_tool_name>_<question_number>[optionally:dummy_variable_lettered]
<ul>
<li>For example: Screening Question 2 is named: SQ_2<br />
</li>
<li>OR: The dummy variable for the â€œEMAILâ€ Response to Screening Question 18 is: SQ_18A<br />
</li>
</ul></li>
<li>Many questions also have the visit number embedded in the name.
<ul>
<li>For example: Demographics question 1 is: DEM1V1.<br />
</li>
</ul></li>
<li>However, there are some exceptions to this rule - intentional or not.
<ul>
<li>For example, the fifth MMSE question is: MMS4V</li>
</ul></li>
</ul></li>
<li>In order to improve consistency in the variable names, we will adopt the following convention:
<ul>
<li><abbreviated_tool_name>_<question_number>[optionally:dummy_variable_lettered]
<ul>
<li>dummy variables will be numbered a-z<br />
</li>
<li>For example, sq_12, t_14a<br />
</li>
</ul></li>
<li>We will drop visit number from the variable name an use an explicit visit variable.<br />
</li>
<li>Exceptions: Demographic variables that almost anyone should be reasonably able to understand without the codebook will be given intuitive, descriptive names (e.g., age, race, gender, marital_status, etc.).<br />
</li>
<li>Iâ€™m also going to change â€œSUBJECTâ€ to â€œid.â€</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="column-names-prepping-many-for-merge.html#cb138-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb138-2"><a href="column-names-prepping-many-for-merge.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUBJECT  =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2002</span>),</span>
<span id="cb138-3"><a href="column-names-prepping-many-for-merge.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">TODAY_V1 =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2018-04-07&quot;</span>, <span class="st">&quot;2018-05-03&quot;</span>)),</span>
<span id="cb138-4"><a href="column-names-prepping-many-for-merge.html#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">VISIT_V1 =</span> <span class="dv">1</span>,</span>
<span id="cb138-5"><a href="column-names-prepping-many-for-merge.html#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SQ_2     =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb138-6"><a href="column-names-prepping-many-for-merge.html#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">WEIGHT   =</span> <span class="fu">c</span>(<span class="dv">179</span>, <span class="dv">194</span>),</span>
<span id="cb138-7"><a href="column-names-prepping-many-for-merge.html#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">DEMO16G  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb138-8"><a href="column-names-prepping-many-for-merge.html#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">DEM15V1  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb138-9"><a href="column-names-prepping-many-for-merge.html#cb138-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V1  =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb138-10"><a href="column-names-prepping-many-for-merge.html#cb138-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V1A =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb138-11"><a href="column-names-prepping-many-for-merge.html#cb138-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V1B =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb138-12"><a href="column-names-prepping-many-for-merge.html#cb138-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">T31_V1B  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb138-13"><a href="column-names-prepping-many-for-merge.html#cb138-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">T31B_V1  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb138-14"><a href="column-names-prepping-many-for-merge.html#cb138-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="column-names-prepping-many-for-merge.html#cb139-1" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb139-2"><a href="column-names-prepping-many-for-merge.html#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUBJECT  =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2002</span>),</span>
<span id="cb139-3"><a href="column-names-prepping-many-for-merge.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">TODAY_V2 =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2018-04-30&quot;</span>, <span class="st">&quot;2018-05-07&quot;</span>)),</span>
<span id="cb139-4"><a href="column-names-prepping-many-for-merge.html#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">VISIT_V2 =</span> <span class="dv">2</span></span>
<span id="cb139-5"><a href="column-names-prepping-many-for-merge.html#cb139-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="column-names-prepping-many-for-merge.html#cb140-1" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb140-2"><a href="column-names-prepping-many-for-merge.html#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUBJECT  =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2002</span>),</span>
<span id="cb140-3"><a href="column-names-prepping-many-for-merge.html#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">TODAY_V3 =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2018-05-31&quot;</span>, <span class="st">&quot;2018-06-08&quot;</span>)),</span>
<span id="cb140-4"><a href="column-names-prepping-many-for-merge.html#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">VISIT_V3 =</span> <span class="dv">3</span>,</span>
<span id="cb140-5"><a href="column-names-prepping-many-for-merge.html#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">GROUP    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb140-6"><a href="column-names-prepping-many-for-merge.html#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">WEIGHT3  =</span> <span class="fu">c</span>(<span class="dv">179</span>, <span class="dv">194</span>),</span>
<span id="cb140-7"><a href="column-names-prepping-many-for-merge.html#cb140-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">DEM14GV3 =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb140-8"><a href="column-names-prepping-many-for-merge.html#cb140-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V3  =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb140-9"><a href="column-names-prepping-many-for-merge.html#cb140-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V3A =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb140-10"><a href="column-names-prepping-many-for-merge.html#cb140-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V3B =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb140-11"><a href="column-names-prepping-many-for-merge.html#cb140-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">T31_V3B  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb140-12"><a href="column-names-prepping-many-for-merge.html#cb140-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">T31B_V3  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb140-13"><a href="column-names-prepping-many-for-merge.html#cb140-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="get-the-existing-column-names" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Get the existing column names</h2>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="column-names-prepping-many-for-merge.html#cb141-1" aria-hidden="true" tabindex="-1"></a>v1_old_names <span class="ot">&lt;-</span> <span class="fu">names</span>(v1)</span>
<span id="cb141-2"><a href="column-names-prepping-many-for-merge.html#cb141-2" aria-hidden="true" tabindex="-1"></a>v1_old_names</span></code></pre></div>
<pre><code>##  [1] &quot;SUBJECT&quot;  &quot;TODAY_V1&quot; &quot;VISIT_V1&quot; &quot;SQ_2&quot;     &quot;WEIGHT&quot;   &quot;DEMO16G&quot; 
##  [7] &quot;DEM15V1&quot;  &quot;T26A_V1&quot;  &quot;T26A_V1A&quot; &quot;T26A_V1B&quot; &quot;T31_V1B&quot;  &quot;T31B_V1&quot;</code></pre>
</div>
<div id="standardize-new-column-names" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Standardize new column names</h2>
<ul>
<li>Remove _v{1, 2, 3} and v{1, 2, 3} from column names</li>
<li>Replace spaces with underscores</li>
<li>Convert to lower case</li>
<li>Add underscore in-between the abbreviated tool name and question number</li>
</ul>
<p>This wonâ€™t be perfect, but it will drastically reduce the number of manual changes we have to make.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="column-names-prepping-many-for-merge.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove _v1 from column name</span></span>
<span id="cb143-2"><a href="column-names-prepping-many-for-merge.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove v1 at end of column name (e.g., DEM1v3)</span></span>
<span id="cb143-3"><a href="column-names-prepping-many-for-merge.html#cb143-3" aria-hidden="true" tabindex="-1"></a>v1_new_names <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(v1_old_names, <span class="st">&quot;_V1|V1&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb143-4"><a href="column-names-prepping-many-for-merge.html#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace spaces with underscores</span></span>
<span id="cb143-5"><a href="column-names-prepping-many-for-merge.html#cb143-5" aria-hidden="true" tabindex="-1"></a>v1_new_names <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(v1_new_names, <span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>)</span>
<span id="cb143-6"><a href="column-names-prepping-many-for-merge.html#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to lower case</span></span>
<span id="cb143-7"><a href="column-names-prepping-many-for-merge.html#cb143-7" aria-hidden="true" tabindex="-1"></a>v1_new_names <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(v1_new_names)</span>
<span id="cb143-8"><a href="column-names-prepping-many-for-merge.html#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add underscore in-between the abbreviated tool name and question number</span></span>
<span id="cb143-9"><a href="column-names-prepping-many-for-merge.html#cb143-9" aria-hidden="true" tabindex="-1"></a>v1_new_names <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(v1_new_names, <span class="st">&quot;([a-z])(</span><span class="sc">\\</span><span class="st">d)&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1_</span><span class="sc">\\</span><span class="st">2&quot;</span>)</span>
<span id="cb143-10"><a href="column-names-prepping-many-for-merge.html#cb143-10" aria-hidden="true" tabindex="-1"></a>v1_new_names</span></code></pre></div>
<pre><code>##  [1] &quot;subject&quot;  &quot;today&quot;    &quot;visit&quot;    &quot;sq_2&quot;     &quot;weight&quot;   &quot;demo_16g&quot;
##  [7] &quot;dem_15&quot;   &quot;t_26a&quot;    &quot;t_26aa&quot;   &quot;t_26ab&quot;   &quot;t_31b&quot;    &quot;t_31b&quot;</code></pre>
</div>
<div id="turn-this-into-a-function" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Turn this into a function</h2>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="column-names-prepping-many-for-merge.html#cb145-1" aria-hidden="true" tabindex="-1"></a>standardize_col_names <span class="ot">&lt;-</span> <span class="cf">function</span>(.data) {</span>
<span id="cb145-2"><a href="column-names-prepping-many-for-merge.html#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the existing column names</span></span>
<span id="cb145-3"><a href="column-names-prepping-many-for-merge.html#cb145-3" aria-hidden="true" tabindex="-1"></a>  old_names <span class="ot">&lt;-</span> <span class="fu">names</span>(.data)</span>
<span id="cb145-4"><a href="column-names-prepping-many-for-merge.html#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a string that contains _V1 through _V5 and V1 through V5 to pass to</span></span>
<span id="cb145-5"><a href="column-names-prepping-many-for-merge.html#cb145-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the regular expression below</span></span>
<span id="cb145-6"><a href="column-names-prepping-many-for-merge.html#cb145-6" aria-hidden="true" tabindex="-1"></a>  v_num <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;_V&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">collapse =</span> <span class="st">&quot;|&quot;</span>)</span>
<span id="cb145-7"><a href="column-names-prepping-many-for-merge.html#cb145-7" aria-hidden="true" tabindex="-1"></a>  vnum <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;V&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">collapse =</span> <span class="st">&quot;|&quot;</span>)</span>
<span id="cb145-8"><a href="column-names-prepping-many-for-merge.html#cb145-8" aria-hidden="true" tabindex="-1"></a>  v_pattern <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">paste</span>(v_num, vnum, <span class="at">sep =</span> <span class="st">&quot;|&quot;</span>), <span class="at">collapse =</span> <span class="st">&quot;|&quot;</span>)</span>
<span id="cb145-9"><a href="column-names-prepping-many-for-merge.html#cb145-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove _v{1, 2, 3} from column name</span></span>
<span id="cb145-10"><a href="column-names-prepping-many-for-merge.html#cb145-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove v{1, 2, 3} at end of column name (e.g., DEM1v3)</span></span>
<span id="cb145-11"><a href="column-names-prepping-many-for-merge.html#cb145-11" aria-hidden="true" tabindex="-1"></a>  new_names <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(old_names, v_pattern, <span class="st">&quot;&quot;</span>)</span>
<span id="cb145-12"><a href="column-names-prepping-many-for-merge.html#cb145-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace spaces with underscores</span></span>
<span id="cb145-13"><a href="column-names-prepping-many-for-merge.html#cb145-13" aria-hidden="true" tabindex="-1"></a>  new_names <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(new_names, <span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>)</span>
<span id="cb145-14"><a href="column-names-prepping-many-for-merge.html#cb145-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to lower case</span></span>
<span id="cb145-15"><a href="column-names-prepping-many-for-merge.html#cb145-15" aria-hidden="true" tabindex="-1"></a>  new_names <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(new_names)</span>
<span id="cb145-16"><a href="column-names-prepping-many-for-merge.html#cb145-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add underscore in-between the abbreviated tool name and question number</span></span>
<span id="cb145-17"><a href="column-names-prepping-many-for-merge.html#cb145-17" aria-hidden="true" tabindex="-1"></a>  new_names <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(new_names, <span class="st">&quot;([a-z])(</span><span class="sc">\\</span><span class="st">d)&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1_</span><span class="sc">\\</span><span class="st">2&quot;</span>)</span>
<span id="cb145-18"><a href="column-names-prepping-many-for-merge.html#cb145-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return character vector of standardized column names</span></span>
<span id="cb145-19"><a href="column-names-prepping-many-for-merge.html#cb145-19" aria-hidden="true" tabindex="-1"></a>  new_names</span>
<span id="cb145-20"><a href="column-names-prepping-many-for-merge.html#cb145-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-21"><a href="column-names-prepping-many-for-merge.html#cb145-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-22"><a href="column-names-prepping-many-for-merge.html#cb145-22" aria-hidden="true" tabindex="-1"></a><span class="co"># For testing</span></span>
<span id="cb145-23"><a href="column-names-prepping-many-for-merge.html#cb145-23" aria-hidden="true" tabindex="-1"></a><span class="co"># standardize_col_names(v1)</span></span></code></pre></div>
<div id="make-a-unit-test-for-the-function" class="section level3" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Make a unit test for the function</h3>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="column-names-prepping-many-for-merge.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&quot;standardize_col_names produces the expected column names.&quot;</span>, {</span>
<span id="cb146-2"><a href="column-names-prepping-many-for-merge.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  v1_test <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb146-3"><a href="column-names-prepping-many-for-merge.html#cb146-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">SUBJECT  =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2002</span>),</span>
<span id="cb146-4"><a href="column-names-prepping-many-for-merge.html#cb146-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">TODAY_V1 =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2018-04-07&quot;</span>, <span class="st">&quot;2018-05-03&quot;</span>)),</span>
<span id="cb146-5"><a href="column-names-prepping-many-for-merge.html#cb146-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">VISIT_V1 =</span> <span class="dv">1</span>,</span>
<span id="cb146-6"><a href="column-names-prepping-many-for-merge.html#cb146-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">SQ_2     =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb146-7"><a href="column-names-prepping-many-for-merge.html#cb146-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">WEIGHT   =</span> <span class="fu">c</span>(<span class="dv">179</span>, <span class="dv">194</span>),</span>
<span id="cb146-8"><a href="column-names-prepping-many-for-merge.html#cb146-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">DEMO16G  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb146-9"><a href="column-names-prepping-many-for-merge.html#cb146-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">DEM15V1  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb146-10"><a href="column-names-prepping-many-for-merge.html#cb146-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">T26A_V1  =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb146-11"><a href="column-names-prepping-many-for-merge.html#cb146-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">T26A_V1A =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb146-12"><a href="column-names-prepping-many-for-merge.html#cb146-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">T26A_V1B =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb146-13"><a href="column-names-prepping-many-for-merge.html#cb146-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">TEST_V8 =</span> <span class="dv">0</span></span>
<span id="cb146-14"><a href="column-names-prepping-many-for-merge.html#cb146-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb146-15"><a href="column-names-prepping-many-for-merge.html#cb146-15" aria-hidden="true" tabindex="-1"></a>  new_names <span class="ot">&lt;-</span> <span class="fu">standardize_col_names</span>(v1_test)</span>
<span id="cb146-16"><a href="column-names-prepping-many-for-merge.html#cb146-16" aria-hidden="true" tabindex="-1"></a>  expceted_new_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb146-17"><a href="column-names-prepping-many-for-merge.html#cb146-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;subject&quot;</span>, <span class="st">&quot;today&quot;</span>, <span class="st">&quot;visit&quot;</span>, <span class="st">&quot;sq_2&quot;</span>, <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;demo_16g&quot;</span>, <span class="st">&quot;dem_15&quot;</span>, </span>
<span id="cb146-18"><a href="column-names-prepping-many-for-merge.html#cb146-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;t_26a&quot;</span>, <span class="st">&quot;t_26aa&quot;</span>, <span class="st">&quot;t_26ab&quot;</span>, <span class="st">&quot;test_v_8&quot;</span></span>
<span id="cb146-19"><a href="column-names-prepping-many-for-merge.html#cb146-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb146-20"><a href="column-names-prepping-many-for-merge.html#cb146-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_equal</span>(new_names, expceted_new_names)</span>
<span id="cb146-21"><a href="column-names-prepping-many-for-merge.html#cb146-21" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Test passed ğŸ˜€</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="column-names-prepping-many-for-merge.html#cb148-1" aria-hidden="true" tabindex="-1"></a>new_names <span class="ot">&lt;-</span> <span class="fu">standardize_col_names</span>(v1)</span></code></pre></div>
</div>
</div>
<div id="manual-changes-to-column-names" class="section level2" number="6.8">
<h2><span class="header-section-number">6.8</span> Manual changes to column names</h2>
<p>The step above used to standardize column names fixes most of them, but some manual changes to variable names still need to be made.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="column-names-prepping-many-for-merge.html#cb149-1" aria-hidden="true" tabindex="-1"></a>new_names[new_names <span class="sc">==</span> <span class="st">&quot;sq_2&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;sq_hispanic&quot;</span></span>
<span id="cb149-2"><a href="column-names-prepping-many-for-merge.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co"># demo_16g was incorrectly numbered when the data was created</span></span>
<span id="cb149-3"><a href="column-names-prepping-many-for-merge.html#cb149-3" aria-hidden="true" tabindex="-1"></a>new_names[new_names <span class="sc">==</span> <span class="st">&quot;demo_16g&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;dem_14g&quot;</span></span>
<span id="cb149-4"><a href="column-names-prepping-many-for-merge.html#cb149-4" aria-hidden="true" tabindex="-1"></a>new_names[new_names <span class="sc">==</span> <span class="st">&quot;dem_15&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;dem_veteran&quot;</span></span>
<span id="cb149-5"><a href="column-names-prepping-many-for-merge.html#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the extra &quot;a&quot; out of all the T26 col names</span></span>
<span id="cb149-6"><a href="column-names-prepping-many-for-merge.html#cb149-6" aria-hidden="true" tabindex="-1"></a>new_names <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(new_names, <span class="st">&quot;t_26a&quot;</span>, <span class="st">&quot;t_26&quot;</span>)</span>
<span id="cb149-7"><a href="column-names-prepping-many-for-merge.html#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the second t_31b to t_33</span></span>
<span id="cb149-8"><a href="column-names-prepping-many-for-merge.html#cb149-8" aria-hidden="true" tabindex="-1"></a>new_names[new_names <span class="sc">==</span> <span class="st">&quot;t_31b&quot;</span>][<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;t_33&quot;</span></span></code></pre></div>
</div>
<div id="have-r-write-out-the-rename-code" class="section level2" number="6.9">
<h2><span class="header-section-number">6.9</span> Have R write out the rename code</h2>
<p>So that you donâ€™t have to type it out by hand. Ideally, you only have to run this code once, copy and paste into the rename code chunk below, and then just make small updates to the rename code chunk if changes are made to QDS.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="column-names-prepping-many-for-merge.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If needed, run the code below. Copy and paste the output into the rename() </span></span>
<span id="cb150-2"><a href="column-names-prepping-many-for-merge.html#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co"># code chunk. Make manual changes as needed.</span></span>
<span id="cb150-3"><a href="column-names-prepping-many-for-merge.html#cb150-3" aria-hidden="true" tabindex="-1"></a>new_old_name_pairs <span class="ot">&lt;-</span> <span class="fu">paste</span>(new_names, <span class="fu">names</span>(v1), <span class="at">sep =</span> <span class="st">&quot; = &quot;</span>)</span>
<span id="cb150-4"><a href="column-names-prepping-many-for-merge.html#cb150-4" aria-hidden="true" tabindex="-1"></a>new_old_name_pairs <span class="ot">&lt;-</span> <span class="fu">paste</span>(new_old_name_pairs, <span class="at">collapse =</span> <span class="st">&quot;, </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb150-5"><a href="column-names-prepping-many-for-merge.html#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(new_old_name_pairs)</span></code></pre></div>
<pre><code>## subject = SUBJECT, 
## today = TODAY_V1, 
## visit = VISIT_V1, 
## sq_hispanic = SQ_2, 
## weight = WEIGHT, 
## dem_14g = DEMO16G, 
## dem_veteran = DEM15V1, 
## t_26 = T26A_V1, 
## t_26a = T26A_V1A, 
## t_26b = T26A_V1B, 
## t_31b = T31_V1B, 
## t_33 = T31B_V1</code></pre>
<div id="make-it-a-function" class="section level3" number="6.9.1">
<h3><span class="header-section-number">6.9.1</span> Make it a function</h3>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="column-names-prepping-many-for-merge.html#cb152-1" aria-hidden="true" tabindex="-1"></a>write_rename <span class="ot">&lt;-</span> <span class="cf">function</span>(.data, .new_names) {</span>
<span id="cb152-2"><a href="column-names-prepping-many-for-merge.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  new_old_name_pairs <span class="ot">&lt;-</span> <span class="fu">paste</span>(.new_names, <span class="fu">names</span>(.data), <span class="at">sep =</span> <span class="st">&quot; = &quot;</span>)</span>
<span id="cb152-3"><a href="column-names-prepping-many-for-merge.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  new_old_name_pairs <span class="ot">&lt;-</span> <span class="fu">paste</span>(new_old_name_pairs, <span class="at">collapse =</span> <span class="st">&quot;, </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb152-4"><a href="column-names-prepping-many-for-merge.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(new_old_name_pairs)</span>
<span id="cb152-5"><a href="column-names-prepping-many-for-merge.html#cb152-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb152-6"><a href="column-names-prepping-many-for-merge.html#cb152-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-7"><a href="column-names-prepping-many-for-merge.html#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="co"># For testing</span></span>
<span id="cb152-8"><a href="column-names-prepping-many-for-merge.html#cb152-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rename</span>(v1, new_names)</span></code></pre></div>
<pre><code>## subject = SUBJECT, 
## today = TODAY_V1, 
## visit = VISIT_V1, 
## sq_hispanic = SQ_2, 
## weight = WEIGHT, 
## dem_14g = DEMO16G, 
## dem_veteran = DEM15V1, 
## t_26 = T26A_V1, 
## t_26a = T26A_V1A, 
## t_26b = T26A_V1B, 
## t_31b = T31_V1B, 
## t_33 = T31B_V1</code></pre>
</div>
</div>
<div id="rename-the-columns" class="section level2" number="6.10">
<h2><span class="header-section-number">6.10</span> Rename the columns</h2>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="column-names-prepping-many-for-merge.html#cb154-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> v1 <span class="sc">%&gt;%</span> </span>
<span id="cb154-2"><a href="column-names-prepping-many-for-merge.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb154-3"><a href="column-names-prepping-many-for-merge.html#cb154-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> SUBJECT, </span>
<span id="cb154-4"><a href="column-names-prepping-many-for-merge.html#cb154-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">today =</span> TODAY_V1, </span>
<span id="cb154-5"><a href="column-names-prepping-many-for-merge.html#cb154-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">visit =</span> VISIT_V1, </span>
<span id="cb154-6"><a href="column-names-prepping-many-for-merge.html#cb154-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sq_hispanic =</span> SQ_2, </span>
<span id="cb154-7"><a href="column-names-prepping-many-for-merge.html#cb154-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> WEIGHT, </span>
<span id="cb154-8"><a href="column-names-prepping-many-for-merge.html#cb154-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">dem_14g =</span> DEMO16G, </span>
<span id="cb154-9"><a href="column-names-prepping-many-for-merge.html#cb154-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">dem_veteran =</span> DEM15V1, </span>
<span id="cb154-10"><a href="column-names-prepping-many-for-merge.html#cb154-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_26 =</span> T26A_V1, </span>
<span id="cb154-11"><a href="column-names-prepping-many-for-merge.html#cb154-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_26a =</span> T26A_V1A, </span>
<span id="cb154-12"><a href="column-names-prepping-many-for-merge.html#cb154-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_26b =</span> T26A_V1B, </span>
<span id="cb154-13"><a href="column-names-prepping-many-for-merge.html#cb154-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_31b =</span> T31_V1B, </span>
<span id="cb154-14"><a href="column-names-prepping-many-for-merge.html#cb154-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_33 =</span> T31B_V1</span>
<span id="cb154-15"><a href="column-names-prepping-many-for-merge.html#cb154-15" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="repeat-the-process-for-v2" class="section level2" number="6.11">
<h2><span class="header-section-number">6.11</span> Repeat the process for V2</h2>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="column-names-prepping-many-for-merge.html#cb155-1" aria-hidden="true" tabindex="-1"></a>new_names <span class="ot">&lt;-</span> <span class="fu">standardize_col_names</span>(v2)</span>
<span id="cb155-2"><a href="column-names-prepping-many-for-merge.html#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rename</span>(v2, new_names)</span></code></pre></div>
<pre><code>## subject = SUBJECT, 
## today = TODAY_V2, 
## visit = VISIT_V2</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="column-names-prepping-many-for-merge.html#cb157-1" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> v2 <span class="sc">%&gt;%</span> </span>
<span id="cb157-2"><a href="column-names-prepping-many-for-merge.html#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb157-3"><a href="column-names-prepping-many-for-merge.html#cb157-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> SUBJECT, </span>
<span id="cb157-4"><a href="column-names-prepping-many-for-merge.html#cb157-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">today =</span> TODAY_V2, </span>
<span id="cb157-5"><a href="column-names-prepping-many-for-merge.html#cb157-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">visit =</span> VISIT_V2</span>
<span id="cb157-6"><a href="column-names-prepping-many-for-merge.html#cb157-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="repeat-the-process-for-v3" class="section level2" number="6.12">
<h2><span class="header-section-number">6.12</span> Repeat the process for V3</h2>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="column-names-prepping-many-for-merge.html#cb158-1" aria-hidden="true" tabindex="-1"></a>new_names <span class="ot">&lt;-</span> <span class="fu">standardize_col_names</span>(v3)</span></code></pre></div>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="column-names-prepping-many-for-merge.html#cb159-1" aria-hidden="true" tabindex="-1"></a>new_names[new_names <span class="sc">==</span> <span class="st">&quot;weight_3&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;weight&quot;</span></span>
<span id="cb159-2"><a href="column-names-prepping-many-for-merge.html#cb159-2" aria-hidden="true" tabindex="-1"></a>new_names[new_names <span class="sc">==</span> <span class="st">&quot;dem_15&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;dem_veteran&quot;</span></span>
<span id="cb159-3"><a href="column-names-prepping-many-for-merge.html#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the extra &quot;a&quot; out of all the T26 col names</span></span>
<span id="cb159-4"><a href="column-names-prepping-many-for-merge.html#cb159-4" aria-hidden="true" tabindex="-1"></a>new_names <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(new_names, <span class="st">&quot;t_26a&quot;</span>, <span class="st">&quot;t_26&quot;</span>)</span>
<span id="cb159-5"><a href="column-names-prepping-many-for-merge.html#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the second t_31b to t_33</span></span>
<span id="cb159-6"><a href="column-names-prepping-many-for-merge.html#cb159-6" aria-hidden="true" tabindex="-1"></a>new_names[new_names <span class="sc">==</span> <span class="st">&quot;t_31b&quot;</span>][<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;t_33&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="column-names-prepping-many-for-merge.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rename</span>(v3, new_names)</span></code></pre></div>
<pre><code>## subject = SUBJECT, 
## today = TODAY_V3, 
## visit = VISIT_V3, 
## group = GROUP, 
## weight = WEIGHT3, 
## dem_14g = DEM14GV3, 
## t_26 = T26A_V3, 
## t_26a = T26A_V3A, 
## t_26b = T26A_V3B, 
## t_31b = T31_V3B, 
## t_33 = T31B_V3</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="column-names-prepping-many-for-merge.html#cb162-1" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> v3 <span class="sc">%&gt;%</span> </span>
<span id="cb162-2"><a href="column-names-prepping-many-for-merge.html#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb162-3"><a href="column-names-prepping-many-for-merge.html#cb162-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">subject =</span> SUBJECT, </span>
<span id="cb162-4"><a href="column-names-prepping-many-for-merge.html#cb162-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">today =</span> TODAY_V3, </span>
<span id="cb162-5"><a href="column-names-prepping-many-for-merge.html#cb162-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">visit =</span> VISIT_V3, </span>
<span id="cb162-6"><a href="column-names-prepping-many-for-merge.html#cb162-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> GROUP, </span>
<span id="cb162-7"><a href="column-names-prepping-many-for-merge.html#cb162-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> WEIGHT3, </span>
<span id="cb162-8"><a href="column-names-prepping-many-for-merge.html#cb162-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">dem_14g =</span> DEM14GV3, </span>
<span id="cb162-9"><a href="column-names-prepping-many-for-merge.html#cb162-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_26 =</span> T26A_V3, </span>
<span id="cb162-10"><a href="column-names-prepping-many-for-merge.html#cb162-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_26a =</span> T26A_V3A, </span>
<span id="cb162-11"><a href="column-names-prepping-many-for-merge.html#cb162-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_26b =</span> T26A_V3B, </span>
<span id="cb162-12"><a href="column-names-prepping-many-for-merge.html#cb162-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_31b =</span> T31_V3B, </span>
<span id="cb162-13"><a href="column-names-prepping-many-for-merge.html#cb162-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_33 =</span> T31B_V3</span>
<span id="cb162-14"><a href="column-names-prepping-many-for-merge.html#cb162-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="merge-all-3-visits" class="section level2" number="6.13">
<h2><span class="header-section-number">6.13</span> Merge all 3 visits</h2>
<p>Merge all 3 visits into a single data frame</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="column-names-prepping-many-for-merge.html#cb163-1" aria-hidden="true" tabindex="-1"></a>qds_all_visits <span class="ot">&lt;-</span> v1 <span class="sc">%&gt;%</span> </span>
<span id="cb163-2"><a href="column-names-prepping-many-for-merge.html#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(v2) <span class="sc">%&gt;%</span> </span>
<span id="cb163-3"><a href="column-names-prepping-many-for-merge.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(v3) <span class="sc">%&gt;%</span> </span>
<span id="cb163-4"><a href="column-names-prepping-many-for-merge.html#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(subject, visit)</span>
<span id="cb163-5"><a href="column-names-prepping-many-for-merge.html#cb163-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-6"><a href="column-names-prepping-many-for-merge.html#cb163-6" aria-hidden="true" tabindex="-1"></a>qds_all_visits</span></code></pre></div>
<pre><code>## # A tibble: 6 Ã— 13
##   subject today      visit sq_hispanic weight dem_14g dem_veteran  t_26 t_26a
##     &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1    2001 2018-04-07     1           1    179       0           1     2     0
## 2    2001 2018-04-30     2          NA     NA      NA          NA    NA    NA
## 3    2001 2018-05-31     3          NA    179       2          NA     2     0
## 4    2002 2018-05-03     1           0    194       1           0     4     0
## 5    2002 2018-05-07     2          NA     NA      NA          NA    NA    NA
## 6    2002 2018-06-08     3          NA    194       3          NA     4     0
## # â€¦ with 4 more variables: t_26b &lt;dbl&gt;, t_31b &lt;dbl&gt;, t_33 &lt;dbl&gt;, group &lt;dbl&gt;</code></pre>
</div>
<div id="final-data-cleaning" class="section level2" number="6.14">
<h2><span class="header-section-number">6.14</span> Final data cleaning</h2>
<ul>
<li>Make a couple more column name changes<br />
</li>
<li>Carry forward time-invariant variables</li>
</ul>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="column-names-prepping-many-for-merge.html#cb165-1" aria-hidden="true" tabindex="-1"></a>qds_all_visits <span class="sc">%&gt;%</span> </span>
<span id="cb165-2"><a href="column-names-prepping-many-for-merge.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> subject, <span class="at">date_visit =</span> today) <span class="sc">%&gt;%</span> </span>
<span id="cb165-3"><a href="column-names-prepping-many-for-merge.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Carry forward time-invariant variables</span></span>
<span id="cb165-4"><a href="column-names-prepping-many-for-merge.html#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb165-5"><a href="column-names-prepping-many-for-merge.html#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(sq_hispanic, dem_veteran, group, <span class="at">.direction =</span> <span class="st">&quot;downup&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb165-6"><a href="column-names-prepping-many-for-merge.html#cb165-6" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb165-7"><a href="column-names-prepping-many-for-merge.html#cb165-7" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-5b1049789a0a061fc748" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5b1049789a0a061fc748">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[2001,2001,2001,2002,2002,2002],["2018-04-07","2018-04-30","2018-05-31","2018-05-03","2018-05-07","2018-06-08"],[1,2,3,1,2,3],[1,1,1,0,0,0],[179,null,179,194,null,194],[0,null,2,1,null,3],[1,1,1,0,0,0],[2,null,2,4,null,4],[0,null,0,0,null,0],[1,null,1,0,null,0],[0,null,0,0,null,0],[0,null,0,0,null,0],[1,1,1,2,2,2]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>date_visit<\/th>\n      <th>visit<\/th>\n      <th>sq_hispanic<\/th>\n      <th>weight<\/th>\n      <th>dem_14g<\/th>\n      <th>dem_veteran<\/th>\n      <th>t_26<\/th>\n      <th>t_26a<\/th>\n      <th>t_26b<\/th>\n      <th>t_31b<\/th>\n      <th>t_33<\/th>\n      <th>group<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6,7,8,9,10,11,12,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="the-dplyr-way" class="section level2" number="6.15">
<h2><span class="header-section-number">6.15</span> ğŸŸ£The dplyr way</h2>
<p>Try getting the same result as above using dplyr (rename_with) functions instead of creating and manipulating separate column name vectors.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="column-names-prepping-many-for-merge.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up environment first</span></span>
<span id="cb166-2"><a href="column-names-prepping-many-for-merge.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="column-names-prepping-many-for-merge.html#cb167-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb167-2"><a href="column-names-prepping-many-for-merge.html#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUBJECT  =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2002</span>),</span>
<span id="cb167-3"><a href="column-names-prepping-many-for-merge.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">TODAY_V1 =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2018-04-07&quot;</span>, <span class="st">&quot;2018-05-03&quot;</span>)),</span>
<span id="cb167-4"><a href="column-names-prepping-many-for-merge.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">VISIT_V1 =</span> <span class="dv">1</span>,</span>
<span id="cb167-5"><a href="column-names-prepping-many-for-merge.html#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SQ_2     =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb167-6"><a href="column-names-prepping-many-for-merge.html#cb167-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">WEIGHT   =</span> <span class="fu">c</span>(<span class="dv">179</span>, <span class="dv">194</span>),</span>
<span id="cb167-7"><a href="column-names-prepping-many-for-merge.html#cb167-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">DEMO16G  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb167-8"><a href="column-names-prepping-many-for-merge.html#cb167-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">DEM15V1  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb167-9"><a href="column-names-prepping-many-for-merge.html#cb167-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V1  =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb167-10"><a href="column-names-prepping-many-for-merge.html#cb167-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V1A =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb167-11"><a href="column-names-prepping-many-for-merge.html#cb167-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V1B =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb167-12"><a href="column-names-prepping-many-for-merge.html#cb167-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">T31_V1B  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb167-13"><a href="column-names-prepping-many-for-merge.html#cb167-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">T31B_V1  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb167-14"><a href="column-names-prepping-many-for-merge.html#cb167-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Making these up to test standardize_col_names when more than one duplicate </span></span>
<span id="cb167-15"><a href="column-names-prepping-many-for-merge.html#cb167-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># column name would be created.</span></span>
<span id="cb167-16"><a href="column-names-prepping-many-for-merge.html#cb167-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">T32_V1B  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb167-17"><a href="column-names-prepping-many-for-merge.html#cb167-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">T32B_V1  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb167-18"><a href="column-names-prepping-many-for-merge.html#cb167-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb167-19"><a href="column-names-prepping-many-for-merge.html#cb167-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-20"><a href="column-names-prepping-many-for-merge.html#cb167-20" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb167-21"><a href="column-names-prepping-many-for-merge.html#cb167-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUBJECT  =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2002</span>),</span>
<span id="cb167-22"><a href="column-names-prepping-many-for-merge.html#cb167-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">TODAY_V2 =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2018-04-30&quot;</span>, <span class="st">&quot;2018-05-07&quot;</span>)),</span>
<span id="cb167-23"><a href="column-names-prepping-many-for-merge.html#cb167-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">VISIT_V2 =</span> <span class="dv">2</span></span>
<span id="cb167-24"><a href="column-names-prepping-many-for-merge.html#cb167-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb167-25"><a href="column-names-prepping-many-for-merge.html#cb167-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-26"><a href="column-names-prepping-many-for-merge.html#cb167-26" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb167-27"><a href="column-names-prepping-many-for-merge.html#cb167-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUBJECT  =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2002</span>),</span>
<span id="cb167-28"><a href="column-names-prepping-many-for-merge.html#cb167-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">TODAY_V3 =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2018-05-31&quot;</span>, <span class="st">&quot;2018-06-08&quot;</span>)),</span>
<span id="cb167-29"><a href="column-names-prepping-many-for-merge.html#cb167-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">VISIT_V3 =</span> <span class="dv">3</span>,</span>
<span id="cb167-30"><a href="column-names-prepping-many-for-merge.html#cb167-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">GROUP    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb167-31"><a href="column-names-prepping-many-for-merge.html#cb167-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">WEIGHT3  =</span> <span class="fu">c</span>(<span class="dv">179</span>, <span class="dv">194</span>),</span>
<span id="cb167-32"><a href="column-names-prepping-many-for-merge.html#cb167-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">DEM14GV3 =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb167-33"><a href="column-names-prepping-many-for-merge.html#cb167-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V3  =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb167-34"><a href="column-names-prepping-many-for-merge.html#cb167-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V3A =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb167-35"><a href="column-names-prepping-many-for-merge.html#cb167-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V3B =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb167-36"><a href="column-names-prepping-many-for-merge.html#cb167-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">T31_V3B  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb167-37"><a href="column-names-prepping-many-for-merge.html#cb167-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">T31B_V3  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb167-38"><a href="column-names-prepping-many-for-merge.html#cb167-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Making these up to test standardize_col_names when more than one duplicate </span></span>
<span id="cb167-39"><a href="column-names-prepping-many-for-merge.html#cb167-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">T32_V3B  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb167-40"><a href="column-names-prepping-many-for-merge.html#cb167-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">T32B_V3  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb167-41"><a href="column-names-prepping-many-for-merge.html#cb167-41" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="standardize-new-column-names-1" class="section level3" number="6.15.1">
<h3><span class="header-section-number">6.15.1</span> Standardize new column names</h3>
<ul>
<li>Remove _v{1, 2, 3} and v{1, 2, 3} from column names</li>
<li>Replace spaces with underscores</li>
<li>Convert to lower case</li>
<li>Add underscore in-between the abbreviated tool name and question number</li>
</ul>
<p>This wonâ€™t be perfect, but it will drastically reduce the number of manual changes we have to make.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="column-names-prepping-many-for-merge.html#cb168-1" aria-hidden="true" tabindex="-1"></a>standardize_col_names <span class="ot">&lt;-</span> <span class="cf">function</span>(.data) {</span>
<span id="cb168-2"><a href="column-names-prepping-many-for-merge.html#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the existing column names</span></span>
<span id="cb168-3"><a href="column-names-prepping-many-for-merge.html#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># When used inside of rename_with(), the column names are automatically</span></span>
<span id="cb168-4"><a href="column-names-prepping-many-for-merge.html#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># passed into the function with/as .data. There is no need for names(.data).</span></span>
<span id="cb168-5"><a href="column-names-prepping-many-for-merge.html#cb168-5" aria-hidden="true" tabindex="-1"></a>  old_names <span class="ot">&lt;-</span> .data</span>
<span id="cb168-6"><a href="column-names-prepping-many-for-merge.html#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a string that contains _V1 through _V5 and V1 through V5 to pass to</span></span>
<span id="cb168-7"><a href="column-names-prepping-many-for-merge.html#cb168-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the regular expression below</span></span>
<span id="cb168-8"><a href="column-names-prepping-many-for-merge.html#cb168-8" aria-hidden="true" tabindex="-1"></a>  v_num <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;_V&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">collapse =</span> <span class="st">&quot;|&quot;</span>)</span>
<span id="cb168-9"><a href="column-names-prepping-many-for-merge.html#cb168-9" aria-hidden="true" tabindex="-1"></a>  vnum <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;V&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">collapse =</span> <span class="st">&quot;|&quot;</span>)</span>
<span id="cb168-10"><a href="column-names-prepping-many-for-merge.html#cb168-10" aria-hidden="true" tabindex="-1"></a>  v_pattern <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">paste</span>(v_num, vnum, <span class="at">sep =</span> <span class="st">&quot;|&quot;</span>), <span class="at">collapse =</span> <span class="st">&quot;|&quot;</span>)</span>
<span id="cb168-11"><a href="column-names-prepping-many-for-merge.html#cb168-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove _v{1, 2, 3} from column name</span></span>
<span id="cb168-12"><a href="column-names-prepping-many-for-merge.html#cb168-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove v{1, 2, 3} at end of column name (e.g., DEM1v3)</span></span>
<span id="cb168-13"><a href="column-names-prepping-many-for-merge.html#cb168-13" aria-hidden="true" tabindex="-1"></a>  new_names <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(old_names, v_pattern, <span class="st">&quot;&quot;</span>)</span>
<span id="cb168-14"><a href="column-names-prepping-many-for-merge.html#cb168-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace spaces with underscores</span></span>
<span id="cb168-15"><a href="column-names-prepping-many-for-merge.html#cb168-15" aria-hidden="true" tabindex="-1"></a>  new_names <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(new_names, <span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>)</span>
<span id="cb168-16"><a href="column-names-prepping-many-for-merge.html#cb168-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to lower case</span></span>
<span id="cb168-17"><a href="column-names-prepping-many-for-merge.html#cb168-17" aria-hidden="true" tabindex="-1"></a>  new_names <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(new_names)</span>
<span id="cb168-18"><a href="column-names-prepping-many-for-merge.html#cb168-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add underscore in-between the abbreviated tool name and question number</span></span>
<span id="cb168-19"><a href="column-names-prepping-many-for-merge.html#cb168-19" aria-hidden="true" tabindex="-1"></a>  new_names <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(new_names, <span class="st">&quot;([a-z])(</span><span class="sc">\\</span><span class="st">d)&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1_</span><span class="sc">\\</span><span class="st">2&quot;</span>)</span>
<span id="cb168-20"><a href="column-names-prepping-many-for-merge.html#cb168-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for duplicate names</span></span>
<span id="cb168-21"><a href="column-names-prepping-many-for-merge.html#cb168-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">length</span>(new_names) <span class="sc">==</span> <span class="fu">length</span>(<span class="fu">unique</span>(new_names))) {</span>
<span id="cb168-22"><a href="column-names-prepping-many-for-merge.html#cb168-22" aria-hidden="true" tabindex="-1"></a>    name_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(new_names)</span>
<span id="cb168-23"><a href="column-names-prepping-many-for-merge.html#cb168-23" aria-hidden="true" tabindex="-1"></a>    dup_names <span class="ot">&lt;-</span> name_counts[name_counts <span class="sc">&gt;</span> <span class="dv">1</span>]</span>
<span id="cb168-24"><a href="column-names-prepping-many-for-merge.html#cb168-24" aria-hidden="true" tabindex="-1"></a>    dup_names <span class="ot">&lt;-</span> <span class="fu">names</span>(dup_names)</span>
<span id="cb168-25"><a href="column-names-prepping-many-for-merge.html#cb168-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set the second instance of the duplicate name back to its original name</span></span>
<span id="cb168-26"><a href="column-names-prepping-many-for-merge.html#cb168-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(dup_names)) {</span>
<span id="cb168-27"><a href="column-names-prepping-many-for-merge.html#cb168-27" aria-hidden="true" tabindex="-1"></a>      index <span class="ot">&lt;-</span> <span class="fu">which</span>(new_names <span class="sc">==</span> dup_names[[i]])</span>
<span id="cb168-28"><a href="column-names-prepping-many-for-merge.html#cb168-28" aria-hidden="true" tabindex="-1"></a>      new_names[index][<span class="dv">2</span>] <span class="ot">&lt;-</span> old_names[index][<span class="dv">2</span>]</span>
<span id="cb168-29"><a href="column-names-prepping-many-for-merge.html#cb168-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Print a message letting the user know what happened</span></span>
<span id="cb168-30"><a href="column-names-prepping-many-for-merge.html#cb168-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">warning</span>(</span>
<span id="cb168-31"><a href="column-names-prepping-many-for-merge.html#cb168-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Warning: &quot;</span>, old_names[index][<span class="dv">2</span>], </span>
<span id="cb168-32"><a href="column-names-prepping-many-for-merge.html#cb168-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot; Could not be standardized because it would have created a duplicate column name. </span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb168-33"><a href="column-names-prepping-many-for-merge.html#cb168-33" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb168-34"><a href="column-names-prepping-many-for-merge.html#cb168-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb168-35"><a href="column-names-prepping-many-for-merge.html#cb168-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb168-36"><a href="column-names-prepping-many-for-merge.html#cb168-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return character vector of standardized column names</span></span>
<span id="cb168-37"><a href="column-names-prepping-many-for-merge.html#cb168-37" aria-hidden="true" tabindex="-1"></a>  new_names</span>
<span id="cb168-38"><a href="column-names-prepping-many-for-merge.html#cb168-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-39"><a href="column-names-prepping-many-for-merge.html#cb168-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-40"><a href="column-names-prepping-many-for-merge.html#cb168-40" aria-hidden="true" tabindex="-1"></a><span class="co"># For testing</span></span>
<span id="cb168-41"><a href="column-names-prepping-many-for-merge.html#cb168-41" aria-hidden="true" tabindex="-1"></a><span class="co"># standardize_col_names(names(v1))</span></span>
<span id="cb168-42"><a href="column-names-prepping-many-for-merge.html#cb168-42" aria-hidden="true" tabindex="-1"></a><span class="co"># rename_with(v1, standardize_col_names)</span></span></code></pre></div>
<p>Standardize all 3 data frames in one step</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="column-names-prepping-many-for-merge.html#cb169-1" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">walk</span>(</span>
<span id="cb169-2"><a href="column-names-prepping-many-for-merge.html#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">paste0</span>(<span class="st">&quot;v&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb169-3"><a href="column-names-prepping-many-for-merge.html#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span> <span class="cf">function</span>(df_name) {</span>
<span id="cb169-4"><a href="column-names-prepping-many-for-merge.html#cb169-4" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">get</span>(df_name, <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb169-5"><a href="column-names-prepping-many-for-merge.html#cb169-5" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">rename_with</span>(df, standardize_col_names)</span>
<span id="cb169-6"><a href="column-names-prepping-many-for-merge.html#cb169-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(df_name, df, <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb169-7"><a href="column-names-prepping-many-for-merge.html#cb169-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb169-8"><a href="column-names-prepping-many-for-merge.html#cb169-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in .fn(names[cols], ...): Warning: T31B_V1 Could not be standardized because it would have created a duplicate column name.</code></pre>
<pre><code>## Warning in .fn(names[cols], ...): Warning: T32B_V1 Could not be standardized because it would have created a duplicate column name.</code></pre>
<pre><code>## Warning in .fn(names[cols], ...): Warning: T31B_V3 Could not be standardized because it would have created a duplicate column name.</code></pre>
<pre><code>## Warning in .fn(names[cols], ...): Warning: T32B_V3 Could not be standardized because it would have created a duplicate column name.</code></pre>
</div>
<div id="manual-changes-to-column-names-1" class="section level3" number="6.15.2">
<h3><span class="header-section-number">6.15.2</span> Manual changes to column names 1</h3>
<p>The step above used to standardize column names fixes most of them, but some manual changes to variable names still need to be made.</p>
<p>First, only make the changes to the individual data frames that will affect the merge (e.g., weight and weight_3).</p>
<p>After the merge, we will make changes to column names that need to be changed in multiple data frames (e.g., t_26a). By doing this after the merge, it reduces code repetition and reduces the risk of typos in the column names.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="column-names-prepping-many-for-merge.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># demo_16g was incorrectly numbered when the data was created</span></span>
<span id="cb174-2"><a href="column-names-prepping-many-for-merge.html#cb174-2" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">rename</span>(v1, <span class="at">dem_14g =</span> demo_16g)</span></code></pre></div>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="column-names-prepping-many-for-merge.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># weight_3 was missing a &quot;v&quot; when it was created in the data frame</span></span>
<span id="cb175-2"><a href="column-names-prepping-many-for-merge.html#cb175-2" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> <span class="fu">rename</span>(v3, <span class="at">weight =</span> weight_3)</span></code></pre></div>
</div>
<div id="merge-all-3-visits-1" class="section level3" number="6.15.3">
<h3><span class="header-section-number">6.15.3</span> Merge all 3 visits</h3>
<p>Merge all 3 visits into a single data frame</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="column-names-prepping-many-for-merge.html#cb176-1" aria-hidden="true" tabindex="-1"></a>qds_all_visits <span class="ot">&lt;-</span> v1 <span class="sc">%&gt;%</span> </span>
<span id="cb176-2"><a href="column-names-prepping-many-for-merge.html#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(v2) <span class="sc">%&gt;%</span> </span>
<span id="cb176-3"><a href="column-names-prepping-many-for-merge.html#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(v3) <span class="sc">%&gt;%</span> </span>
<span id="cb176-4"><a href="column-names-prepping-many-for-merge.html#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(subject, visit)</span></code></pre></div>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="column-names-prepping-many-for-merge.html#cb177-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(qds_all_visits, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-1fc8c616fcf1dc981d87" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1fc8c616fcf1dc981d87">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[2001,2001,2001,2002,2002,2002],["2018-04-07","2018-04-30","2018-05-31","2018-05-03","2018-05-07","2018-06-08"],[1,2,3,1,2,3],[1,null,null,0,null,null],[179,null,179,194,null,194],[0,null,2,1,null,3],[1,null,null,0,null,null],[2,null,2,4,null,4],[0,null,0,0,null,0],[1,null,1,0,null,0],[0,null,0,0,null,0],[0,null,null,0,null,null],[1,null,1,1,null,1],[1,null,null,1,null,null],[null,null,1,null,null,2],[null,null,0,null,null,0],[null,null,1,null,null,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>subject<\/th>\n      <th>today<\/th>\n      <th>visit<\/th>\n      <th>sq_2<\/th>\n      <th>weight<\/th>\n      <th>dem_14g<\/th>\n      <th>dem_15<\/th>\n      <th>t_26a<\/th>\n      <th>t_26aa<\/th>\n      <th>t_26ab<\/th>\n      <th>t_31b<\/th>\n      <th>T31B_V1<\/th>\n      <th>t_32b<\/th>\n      <th>T32B_V1<\/th>\n      <th>group<\/th>\n      <th>T31B_V3<\/th>\n      <th>T32B_V3<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="manual-changes-to-column-names-2" class="section level3" number="6.15.4">
<h3><span class="header-section-number">6.15.4</span> Manual changes to column names 2</h3>
<p>We already made changes to the individual data frames that would have affected the merge (e.g., weight and weight_3).</p>
<p>Now, we will make changes to column names that need to be changed in multiple data frames (e.g., t_26a).</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="column-names-prepping-many-for-merge.html#cb178-1" aria-hidden="true" tabindex="-1"></a>qds_all_visits <span class="ot">&lt;-</span> qds_all_visits <span class="sc">%&gt;%</span></span>
<span id="cb178-2"><a href="column-names-prepping-many-for-merge.html#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb178-3"><a href="column-names-prepping-many-for-merge.html#cb178-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> subject, </span>
<span id="cb178-4"><a href="column-names-prepping-many-for-merge.html#cb178-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_visit =</span> today,</span>
<span id="cb178-5"><a href="column-names-prepping-many-for-merge.html#cb178-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sq_hispanic =</span> sq_2,</span>
<span id="cb178-6"><a href="column-names-prepping-many-for-merge.html#cb178-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dem_veteran =</span> dem_15</span>
<span id="cb178-7"><a href="column-names-prepping-many-for-merge.html#cb178-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb178-8"><a href="column-names-prepping-many-for-merge.html#cb178-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Take the extra &quot;a&quot; out of all the T26 col names</span></span>
<span id="cb178-9"><a href="column-names-prepping-many-for-merge.html#cb178-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(</span>
<span id="cb178-10"><a href="column-names-prepping-many-for-merge.html#cb178-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">str_replace</span>(.x, <span class="st">&quot;t_26a&quot;</span>, <span class="st">&quot;t_26&quot;</span>)</span>
<span id="cb178-11"><a href="column-names-prepping-many-for-merge.html#cb178-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb178-12"><a href="column-names-prepping-many-for-merge.html#cb178-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine T31B_V1 and T31B_V3 as t_33</span></span>
<span id="cb178-13"><a href="column-names-prepping-many-for-merge.html#cb178-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine T32B_V1 and T32B_V3 as t_34</span></span>
<span id="cb178-14"><a href="column-names-prepping-many-for-merge.html#cb178-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb178-15"><a href="column-names-prepping-many-for-merge.html#cb178-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_33 =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(T31B_V1), T31B_V3, T31B_V1),</span>
<span id="cb178-16"><a href="column-names-prepping-many-for-merge.html#cb178-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">t_34 =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(T32B_V1), T32B_V3, T32B_V1)</span>
<span id="cb178-17"><a href="column-names-prepping-many-for-merge.html#cb178-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb178-18"><a href="column-names-prepping-many-for-merge.html#cb178-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>T31B_V1, <span class="sc">-</span>T31B_V3, <span class="sc">-</span>T32B_V1, <span class="sc">-</span>T32B_V3)</span></code></pre></div>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="column-names-prepping-many-for-merge.html#cb179-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(qds_all_visits, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-aa5e4c067739b253e4aa" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-aa5e4c067739b253e4aa">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[2001,2001,2001,2002,2002,2002],["2018-04-07","2018-04-30","2018-05-31","2018-05-03","2018-05-07","2018-06-08"],[1,2,3,1,2,3],[1,null,null,0,null,null],[179,null,179,194,null,194],[0,null,2,1,null,3],[1,null,null,0,null,null],[2,null,2,4,null,4],[0,null,0,0,null,0],[1,null,1,0,null,0],[0,null,0,0,null,0],[1,null,1,1,null,1],[null,null,1,null,null,2],[0,null,0,0,null,0],[1,null,1,1,null,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>date_visit<\/th>\n      <th>visit<\/th>\n      <th>sq_hispanic<\/th>\n      <th>weight<\/th>\n      <th>dem_14g<\/th>\n      <th>dem_veteran<\/th>\n      <th>t_26<\/th>\n      <th>t_26a<\/th>\n      <th>t_26b<\/th>\n      <th>t_31b<\/th>\n      <th>t_32b<\/th>\n      <th>group<\/th>\n      <th>t_33<\/th>\n      <th>t_34<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6,7,8,9,10,11,12,13,14,15]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="final-data-cleaning-1" class="section level3" number="6.15.5">
<h3><span class="header-section-number">6.15.5</span> Final data cleaning</h3>
<ul>
<li>Carry forward time-invariant variables</li>
</ul>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="column-names-prepping-many-for-merge.html#cb180-1" aria-hidden="true" tabindex="-1"></a>qds_all_visits <span class="sc">%&gt;%</span> </span>
<span id="cb180-2"><a href="column-names-prepping-many-for-merge.html#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Carry forward time-invariant variables</span></span>
<span id="cb180-3"><a href="column-names-prepping-many-for-merge.html#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb180-4"><a href="column-names-prepping-many-for-merge.html#cb180-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(sq_hispanic, dem_veteran, group, <span class="at">.direction =</span> <span class="st">&quot;downup&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb180-5"><a href="column-names-prepping-many-for-merge.html#cb180-5" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb180-6"><a href="column-names-prepping-many-for-merge.html#cb180-6" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-09b31d705c2945d3badd" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-09b31d705c2945d3badd">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[2001,2001,2001,2002,2002,2002],["2018-04-07","2018-04-30","2018-05-31","2018-05-03","2018-05-07","2018-06-08"],[1,2,3,1,2,3],[1,1,1,0,0,0],[179,null,179,194,null,194],[0,null,2,1,null,3],[1,1,1,0,0,0],[2,null,2,4,null,4],[0,null,0,0,null,0],[1,null,1,0,null,0],[0,null,0,0,null,0],[1,null,1,1,null,1],[1,1,1,2,2,2],[0,null,0,0,null,0],[1,null,1,1,null,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>date_visit<\/th>\n      <th>visit<\/th>\n      <th>sq_hispanic<\/th>\n      <th>weight<\/th>\n      <th>dem_14g<\/th>\n      <th>dem_veteran<\/th>\n      <th>t_26<\/th>\n      <th>t_26a<\/th>\n      <th>t_26b<\/th>\n      <th>t_31b<\/th>\n      <th>t_32b<\/th>\n      <th>group<\/th>\n      <th>t_33<\/th>\n      <th>t_34<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6,7,8,9,10,11,12,13,14,15]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="making-a-key-in-google-sheets" class="section level2" number="6.16">
<h2><span class="header-section-number">6.16</span> ğŸŸ¢ Making a key in Google Sheets</h2>
<p>Why might I want to do this in the first place?</p>
<p>Pros:</p>
<ul>
<li>Everyone can use Excel. Not everyone is comfortable using RStudio. So, people other than me may be intimidated if they need to look up the changes to the column names by opening an Rmd file in RStudio.<br />
</li>
<li>If I need to look up changes to column names, it may be faster to do so in Excel.</li>
</ul>
<p>Cons:</p>
<ul>
<li>Creating the Excel sheet may be an additional layer of work.<br />
</li>
<li>This process creates additional documents (i.e., other than the Rmd files) to keep track of and update. However, if ALL of the updates to column names go in this spreadsheet, then it should really be the only one that requires tracking and updating.<br />
</li>
<li>Hard to use versioning for Excel.</li>
</ul>
<p>Why use Google Sheets instead of Excel?</p>
<p>It has all of the pros above, plus versioning. Also, Google Sheets makes it easy to use regular expressions, which Iâ€™ve found useful in the past.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="column-names-prepping-many-for-merge.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up environment first</span></span>
<span id="cb181-2"><a href="column-names-prepping-many-for-merge.html#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="column-names-prepping-many-for-merge.html#cb182-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb182-2"><a href="column-names-prepping-many-for-merge.html#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUBJECT  =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2002</span>),</span>
<span id="cb182-3"><a href="column-names-prepping-many-for-merge.html#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">TODAY_V1 =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2018-04-07&quot;</span>, <span class="st">&quot;2018-05-03&quot;</span>)),</span>
<span id="cb182-4"><a href="column-names-prepping-many-for-merge.html#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">VISIT_V1 =</span> <span class="dv">1</span>,</span>
<span id="cb182-5"><a href="column-names-prepping-many-for-merge.html#cb182-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SQ_2     =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb182-6"><a href="column-names-prepping-many-for-merge.html#cb182-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">WEIGHT   =</span> <span class="fu">c</span>(<span class="dv">179</span>, <span class="dv">194</span>),</span>
<span id="cb182-7"><a href="column-names-prepping-many-for-merge.html#cb182-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">DEMO16G  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb182-8"><a href="column-names-prepping-many-for-merge.html#cb182-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">DEM15V1  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb182-9"><a href="column-names-prepping-many-for-merge.html#cb182-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V1  =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb182-10"><a href="column-names-prepping-many-for-merge.html#cb182-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V1A =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb182-11"><a href="column-names-prepping-many-for-merge.html#cb182-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V1B =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb182-12"><a href="column-names-prepping-many-for-merge.html#cb182-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">T31_V1B  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb182-13"><a href="column-names-prepping-many-for-merge.html#cb182-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">T31B_V1  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb182-14"><a href="column-names-prepping-many-for-merge.html#cb182-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Making these up to test standardize_col_names when more than one duplicate </span></span>
<span id="cb182-15"><a href="column-names-prepping-many-for-merge.html#cb182-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># column name would be created.</span></span>
<span id="cb182-16"><a href="column-names-prepping-many-for-merge.html#cb182-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">T32_V1B  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb182-17"><a href="column-names-prepping-many-for-merge.html#cb182-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">T32B_V1  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb182-18"><a href="column-names-prepping-many-for-merge.html#cb182-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb182-19"><a href="column-names-prepping-many-for-merge.html#cb182-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-20"><a href="column-names-prepping-many-for-merge.html#cb182-20" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb182-21"><a href="column-names-prepping-many-for-merge.html#cb182-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUBJECT  =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2002</span>),</span>
<span id="cb182-22"><a href="column-names-prepping-many-for-merge.html#cb182-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">TODAY_V2 =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2018-04-30&quot;</span>, <span class="st">&quot;2018-05-07&quot;</span>)),</span>
<span id="cb182-23"><a href="column-names-prepping-many-for-merge.html#cb182-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">VISIT_V2 =</span> <span class="dv">2</span></span>
<span id="cb182-24"><a href="column-names-prepping-many-for-merge.html#cb182-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb182-25"><a href="column-names-prepping-many-for-merge.html#cb182-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-26"><a href="column-names-prepping-many-for-merge.html#cb182-26" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb182-27"><a href="column-names-prepping-many-for-merge.html#cb182-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">SUBJECT  =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2002</span>),</span>
<span id="cb182-28"><a href="column-names-prepping-many-for-merge.html#cb182-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">TODAY_V3 =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2018-05-31&quot;</span>, <span class="st">&quot;2018-06-08&quot;</span>)),</span>
<span id="cb182-29"><a href="column-names-prepping-many-for-merge.html#cb182-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">VISIT_V3 =</span> <span class="dv">3</span>,</span>
<span id="cb182-30"><a href="column-names-prepping-many-for-merge.html#cb182-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">GROUP    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb182-31"><a href="column-names-prepping-many-for-merge.html#cb182-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">WEIGHT3  =</span> <span class="fu">c</span>(<span class="dv">179</span>, <span class="dv">194</span>),</span>
<span id="cb182-32"><a href="column-names-prepping-many-for-merge.html#cb182-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">DEM14GV3 =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb182-33"><a href="column-names-prepping-many-for-merge.html#cb182-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V3  =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb182-34"><a href="column-names-prepping-many-for-merge.html#cb182-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V3A =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb182-35"><a href="column-names-prepping-many-for-merge.html#cb182-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">T26A_V3B =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb182-36"><a href="column-names-prepping-many-for-merge.html#cb182-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">T31_V3B  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb182-37"><a href="column-names-prepping-many-for-merge.html#cb182-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">T31B_V3  =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb182-38"><a href="column-names-prepping-many-for-merge.html#cb182-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Making these up to test standardize_col_names when more than one duplicate </span></span>
<span id="cb182-39"><a href="column-names-prepping-many-for-merge.html#cb182-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">T32_V3B  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb182-40"><a href="column-names-prepping-many-for-merge.html#cb182-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">T32B_V3  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb182-41"><a href="column-names-prepping-many-for-merge.html#cb182-41" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="create-the-google-sheet-column-name-key" class="section level3" number="6.16.1">
<h3><span class="header-section-number">6.16.1</span> Create the Google Sheet column name key</h3>
<p><strong>NOTE:</strong> You should only have to do this once. After you create the initial spreadsheet, all future changes to column names should occur directly in the spreadsheet.</p>
<ol style="list-style-type: decimal">
<li>Create a new Google sheet.
<ul>
<li>Name it.</li>
<li>Rename the first sheet â€œvisit1.â€</li>
<li>Name column A <code>old_name</code> and column B <code>new_name</code>.</li>
</ul></li>
<li>Create a character string of existing column names that you can copy and paste into the <code>old_name</code> column of the Google Sheet.</li>
</ol>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="column-names-prepping-many-for-merge.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(v1) <span class="sc">%&gt;%</span> </span>
<span id="cb183-2"><a href="column-names-prepping-many-for-merge.html#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb183-3"><a href="column-names-prepping-many-for-merge.html#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>()</span></code></pre></div>
<pre><code>## SUBJECT
## TODAY_V1
## VISIT_V1
## SQ_2
## WEIGHT
## DEMO16G
## DEM15V1
## T26A_V1
## T26A_V1A
## T26A_V1B
## T31_V1B
## T31B_V1
## T32_V1B
## T32B_V1</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>You can directly type new names into the <code>new_name</code> column. Or, you can use regular expressions in steps similar to what the <code>standardize_col_names()</code> function we created above does:
<ul>
<li>Move <code>new_name</code> to column E<br />
</li>
<li>Name column B <code>lower</code> and type the following function into B2: <code>=LOWER(A2)</code>. Paste the formula down.<br />
</li>
<li>Name column C <code>remove_v1</code> and type the following function into C2: <code>=REGEXREPLACE(B2, "v1|_v1", "")</code>. Paste the formula down.<br />
</li>
<li>Name column D <code>add_underscore</code> and type the following function into D2: <code>=REGEXREPLACE(C2,"([a-z])(\d)", "$1_$2")</code>. Paste the formula down. Notice that Google Sheets uses <code>$1</code> instead of <code>\\1</code> for replacing with a capture group.<br />
</li>
<li>Make final edits in the <code>new_name</code> column.</li>
</ul></li>
</ol>
</div>
<div id="import-the-google-sheet-column-name-key" class="section level3" number="6.16.2">
<h3><span class="header-section-number">6.16.2</span> Import the Google Sheet column name key</h3>
<p>The first time you attempt to read-in a Google Sheet you will need to authenticate your Google user name and password. Make sure to click the check box next to â€œGrant Tidyverse API Packages permission to See, edit, create, delete, spreadsheets in Google Drive.â€</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="column-names-prepping-many-for-merge.html#cb185-1" aria-hidden="true" tabindex="-1"></a>gs_col_name_key <span class="ot">&lt;-</span> <span class="fu">read_sheet</span>(</span>
<span id="cb185-2"><a href="column-names-prepping-many-for-merge.html#cb185-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;https://docs.google.com/spreadsheets/d/1cnoOvVdblnKarVf_WQIyWtJDIOumI9VSP1WK2gTy0gU/edit?usp=sharing&quot;</span>,</span>
<span id="cb185-3"><a href="column-names-prepping-many-for-merge.html#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">&quot;visit1&quot;</span></span>
<span id="cb185-4"><a href="column-names-prepping-many-for-merge.html#cb185-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## ! Using an auto-discovered, cached token.</code></pre>
<pre><code>##   To suppress this message, modify your code or options to clearly consent to
##   the use of a cached token.</code></pre>
<pre><code>##   See gargle&#39;s &quot;Non-interactive auth&quot; vignette for more details:</code></pre>
<pre><code>##   &lt;https://gargle.r-lib.org/articles/non-interactive-auth.html&gt;</code></pre>
<pre><code>## â„¹ The googlesheets4 package is using a cached token for
##   &#39;brad.cannell@gmail.com&#39;.</code></pre>
<pre><code>## âœ“ Reading from &quot;Google Sheet for column_names_prepping_many_for_merge.Rmd&quot;.</code></pre>
<pre><code>## âœ“ Range &#39;&#39;visit1&#39;&#39;.</code></pre>
</div>
<div id="reorder-and-rename-the-current-data-frame" class="section level3" number="6.16.3">
<h3><span class="header-section-number">6.16.3</span> Reorder and rename the current data frame</h3>
<p>You might be tempted to just rename the columns by doing something like this:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="column-names-prepping-many-for-merge.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(v1) <span class="ot">&lt;-</span> gs_col_name_key<span class="sc">$</span>new_name</span></code></pre></div>
<p>That will work as long as there are the exact same number of columns in <code>v1</code> as there are in are in <code>gs_col_name_key$new_name</code>, and the order of the columns in <code>v1</code> perfectly matches the order of <code>gs_col_name_key$new_name</code>. A slightly more complex, but safer, way to do this is with <code>rename()</code>. Using <code>new_name = old_name</code> inside the rename function make it less likely to accidentally assign the wrong <code>new_name</code> to a column.</p>
<div id="create-a-named-vector" class="section level4" number="6.16.3.1">
<h4><span class="header-section-number">6.16.3.1</span> Create a named vector</h4>
<p>Create a named vector of old names and new names that you can pass to <code>select()</code> or <code>rename()</code>.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="column-names-prepping-many-for-merge.html#cb194-1" aria-hidden="true" tabindex="-1"></a>rename_vector <span class="ot">&lt;-</span> gs_col_name_key<span class="sc">$</span>old_name</span>
<span id="cb194-2"><a href="column-names-prepping-many-for-merge.html#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rename_vector) <span class="ot">&lt;-</span> gs_col_name_key<span class="sc">$</span>new_name</span>
<span id="cb194-3"><a href="column-names-prepping-many-for-merge.html#cb194-3" aria-hidden="true" tabindex="-1"></a>rename_vector</span></code></pre></div>
<pre><code>##          id  date_visit       visit sq_hispanic      weight     dem_14g 
##   &quot;SUBJECT&quot;  &quot;TODAY_V1&quot;  &quot;VISIT_V1&quot;      &quot;SQ_2&quot;    &quot;WEIGHT&quot;   &quot;DEMO16G&quot; 
## dem_veteran        t_26       t_26a       t_26b       t_31b        t_33 
##   &quot;DEM15V1&quot;   &quot;T26A_V1&quot;  &quot;T26A_V1A&quot;  &quot;T26A_V1B&quot;   &quot;T31_V1B&quot;   &quot;T31B_V1&quot; 
##       t_32b        t_34 
##   &quot;T32_V1B&quot;   &quot;T32B_V1&quot;</code></pre>
</div>
<div id="reorder-and-rename-the-current-data-frame-1" class="section level4" number="6.16.3.2">
<h4><span class="header-section-number">6.16.3.2</span> Reorder and rename the current data frame</h4>
<p>Reorder and rename the current data frame using <code>rename_vector</code>.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="column-names-prepping-many-for-merge.html#cb196-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="sc">%&gt;%</span> </span>
<span id="cb196-2"><a href="column-names-prepping-many-for-merge.html#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!!!</span> rename_vector) <span class="sc">%&gt;%</span> </span>
<span id="cb196-3"><a href="column-names-prepping-many-for-merge.html#cb196-3" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-3f421a57d1931fd18147" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3f421a57d1931fd18147">{"x":{"filter":"none","vertical":false,"data":[["1","2"],[2001,2002],["2018-04-07","2018-05-03"],[1,1],[1,0],[179,194],[0,1],[1,0],[2,4],[0,0],[1,0],[0,0],[0,0],[1,1],[1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>date_visit<\/th>\n      <th>visit<\/th>\n      <th>sq_hispanic<\/th>\n      <th>weight<\/th>\n      <th>dem_14g<\/th>\n      <th>dem_veteran<\/th>\n      <th>t_26<\/th>\n      <th>t_26a<\/th>\n      <th>t_26b<\/th>\n      <th>t_31b<\/th>\n      <th>t_33<\/th>\n      <th>t_32b<\/th>\n      <th>t_34<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="more-columns-in-df-than-sheet" class="section level4" number="6.16.3.3">
<h4><span class="header-section-number">6.16.3.3</span> More columns in df than Sheet</h4>
<p>What if there are columns in the data frame that havenâ€™t yet been added to the Google Sheet?</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="column-names-prepping-many-for-merge.html#cb197-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="sc">%&gt;%</span> </span>
<span id="cb197-2"><a href="column-names-prepping-many-for-merge.html#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb197-3"><a href="column-names-prepping-many-for-merge.html#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">T_Total =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(T26A_V1<span class="sc">:</span>T32B_V1))) <span class="sc">%&gt;%</span> </span>
<span id="cb197-4"><a href="column-names-prepping-many-for-merge.html#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb197-5"><a href="column-names-prepping-many-for-merge.html#cb197-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="sc">!!!</span> rename_vector) <span class="sc">%&gt;%</span> </span>
<span id="cb197-6"><a href="column-names-prepping-many-for-merge.html#cb197-6" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-358cefc6ce7c947ef27a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-358cefc6ce7c947ef27a">{"x":{"filter":"none","vertical":false,"data":[["1","2"],[2001,2002],["2018-04-07","2018-05-03"],[1,1],[1,0],[179,194],[0,1],[1,0],[2,4],[0,0],[1,0],[0,0],[0,0],[1,1],[1,1],[5,6]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>date_visit<\/th>\n      <th>visit<\/th>\n      <th>sq_hispanic<\/th>\n      <th>weight<\/th>\n      <th>dem_14g<\/th>\n      <th>dem_veteran<\/th>\n      <th>t_26<\/th>\n      <th>t_26a<\/th>\n      <th>t_26b<\/th>\n      <th>t_31b<\/th>\n      <th>t_33<\/th>\n      <th>t_32b<\/th>\n      <th>t_34<\/th>\n      <th>T_Total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6,7,8,9,10,11,12,13,14,15]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>It just leaves the extra columnâ€™s name unchanged, which is exactly what we want.</p>
</div>
<div id="more-columns-in-sheet-and-df" class="section level4" number="6.16.3.4">
<h4><span class="header-section-number">6.16.3.4</span> More columns in Sheet and df</h4>
<p>What if there are columns in the Google Sheet that arenâ€™t in the data frame?</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="column-names-prepping-many-for-merge.html#cb198-1" aria-hidden="true" tabindex="-1"></a>rename_vector_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(rename_vector, <span class="st">&quot;mms_1&quot;</span> <span class="ot">=</span> <span class="st">&quot;MMS1&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="column-names-prepping-many-for-merge.html#cb199-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="sc">%&gt;%</span> </span>
<span id="cb199-2"><a href="column-names-prepping-many-for-merge.html#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="sc">!!!</span> rename_vector_2) <span class="sc">%&gt;%</span> </span>
<span id="cb199-3"><a href="column-names-prepping-many-for-merge.html#cb199-3" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## Error: Can&#39;t rename columns that don&#39;t exist.
## x Column `MMS1` doesn&#39;t exist.</code></pre>
<p>R gives us a warning that we can work out.</p>
<!--
Clean up and add session info
-->

</div>
</div>
</div>
</div>




</div>
            </section>

          </div>
        </div>
      </div>
<a href="arranging-columns-with-across.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="contingency-tables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
