<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15 Tables | R Notes</title>
  <meta name="description" content="This is the Bookdown for Brad Cannellâ€™s R Notes." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="15 Tables | R Notes" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://brad-cannell.github.io/r_notes/" />
  
  <meta property="og:description" content="This is the Bookdown for Brad Cannellâ€™s R Notes." />
  <meta name="github-repo" content="brad-cannell/r_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15 Tables | R Notes" />
  
  <meta name="twitter:description" content="This is the Bookdown for Brad Cannellâ€™s R Notes." />
  

<meta name="author" content="Brad Cannell" />


<meta name="date" content="2021-11-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="officer.html"/>
<link rel="next" href="git-and-github.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i>Organization</a></li>
</ul></li>
<li class="part"><span><b>I Programming</b></span></li>
<li class="chapter" data-level="1" data-path="my-package-notes.html"><a href="my-package-notes.html"><i class="fa fa-check"></i><b>1</b> Packages: Quick Start</a>
<ul>
<li class="chapter" data-level="1.1" data-path="my-package-notes.html"><a href="my-package-notes.html#overview"><i class="fa fa-check"></i><b>1.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="1.2" data-path="my-package-notes.html"><a href="my-package-notes.html#useful-websites"><i class="fa fa-check"></i><b>1.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="1.3" data-path="my-package-notes.html"><a href="my-package-notes.html#step-1-create-the-package-project"><i class="fa fa-check"></i><b>1.3</b> Step 1: Create the package project</a></li>
<li class="chapter" data-level="1.4" data-path="my-package-notes.html"><a href="my-package-notes.html#step-3-writing-help-pages"><i class="fa fa-check"></i><b>1.4</b> Step 3: Writing help pages</a></li>
<li class="chapter" data-level="1.5" data-path="my-package-notes.html"><a href="my-package-notes.html#step-4-synchronize-with-github"><i class="fa fa-check"></i><b>1.5</b> Step 4: Synchronize with GitHub</a></li>
<li class="chapter" data-level="1.6" data-path="my-package-notes.html"><a href="my-package-notes.html#step-5-testing"><i class="fa fa-check"></i><b>1.6</b> Step 5: Testing</a></li>
<li class="chapter" data-level="1.7" data-path="my-package-notes.html"><a href="my-package-notes.html#vignettes"><i class="fa fa-check"></i><b>1.7</b> Vignettes</a></li>
<li class="chapter" data-level="1.8" data-path="my-package-notes.html"><a href="my-package-notes.html#adding-and-documenting-data"><i class="fa fa-check"></i><b>1.8</b> Adding and documenting data</a></li>
<li class="chapter" data-level="1.9" data-path="my-package-notes.html"><a href="my-package-notes.html#errors-warnings-notes"><i class="fa fa-check"></i><b>1.9</b> Errors, warnings, notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="creating-rmd-templates.html"><a href="creating-rmd-templates.html"><i class="fa fa-check"></i><b>2</b> Creating Rmd Templates</a>
<ul>
<li class="chapter" data-level="2.1" data-path="creating-rmd-templates.html"><a href="creating-rmd-templates.html#overview-1"><i class="fa fa-check"></i><b>2.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="2.2" data-path="creating-rmd-templates.html"><a href="creating-rmd-templates.html#useful-websites-1"><i class="fa fa-check"></i><b>2.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="2.3" data-path="creating-rmd-templates.html"><a href="creating-rmd-templates.html#create-a-package"><i class="fa fa-check"></i><b>2.3</b> Create a package</a></li>
<li class="chapter" data-level="2.4" data-path="creating-rmd-templates.html"><a href="creating-rmd-templates.html#add-a-template-to-your-package"><i class="fa fa-check"></i><b>2.4</b> Add a template to your package</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html"><i class="fa fa-check"></i><b>3</b> Tidy Evaluation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#overview-2"><i class="fa fa-check"></i><b>3.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="3.2" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#useful-websites-2"><i class="fa fa-check"></i><b>3.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="3.3" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#load-packages"><i class="fa fa-check"></i><b>3.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="3.4" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#simulate-data"><i class="fa fa-check"></i><b>3.4</b> ğŸ”¢Simulate data</a></li>
<li class="chapter" data-level="3.5" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#load-starwars-data"><i class="fa fa-check"></i><b>3.5</b> Load Starwars data</a></li>
<li class="chapter" data-level="3.6" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#key_functions"><i class="fa fa-check"></i><b>3.6</b> Key Functions</a></li>
<li class="chapter" data-level="3.7" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#for_loop"><i class="fa fa-check"></i><b>3.7</b> Example using Tidy Eval in For Loop</a></li>
<li class="chapter" data-level="3.8" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#functions"><i class="fa fa-check"></i><b>3.8</b> Example using Tidy Eval in Functions</a></li>
<li class="chapter" data-level="3.9" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#purrr"><i class="fa fa-check"></i><b>3.9</b> Using tidyeval with purrr</a></li>
<li class="chapter" data-level="3.10" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#quirks"><i class="fa fa-check"></i><b>3.10</b> Other Quirks and Lessons Learned</a></li>
<li class="chapter" data-level="3.11" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#example-i-created-for-steph-yap"><i class="fa fa-check"></i><b>3.11</b> Example I created for Steph Yap</a></li>
<li class="chapter" data-level="3.12" data-path="tidy-evaluation.html"><a href="tidy-evaluation.html#other"><i class="fa fa-check"></i><b>3.12</b> Other questions / notes / reminders</a></li>
</ul></li>
<li class="part"><span><b>II Working with External Files</b></span></li>
<li class="part"><span><b>III Data Management</b></span></li>
<li class="chapter" data-level="4" data-path="arranging-columns-with-across.html"><a href="arranging-columns-with-across.html"><i class="fa fa-check"></i><b>4</b> Arranging Columns with Across</a>
<ul>
<li class="chapter" data-level="4.1" data-path="arranging-columns-with-across.html"><a href="arranging-columns-with-across.html#solution-by-lmc"><i class="fa fa-check"></i><b>4.1</b> Solution by LMc:</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html"><i class="fa fa-check"></i><b>5</b> Column Names: Prepping Many for Merge</a>
<ul>
<li class="chapter" data-level="5.1" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#overview-3"><i class="fa fa-check"></i><b>5.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="5.2" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#useful-websites-3"><i class="fa fa-check"></i><b>5.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="5.3" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#load-packages-1"><i class="fa fa-check"></i><b>5.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="5.4" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#simulate-data-1"><i class="fa fa-check"></i><b>5.4</b> ğŸ”¢Simulate data</a></li>
<li class="chapter" data-level="5.5" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#get-the-existing-column-names"><i class="fa fa-check"></i><b>5.5</b> Get the existing column names</a></li>
<li class="chapter" data-level="5.6" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#standardize-new-column-names"><i class="fa fa-check"></i><b>5.6</b> Standardize new column names</a></li>
<li class="chapter" data-level="5.7" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#turn-this-into-a-function"><i class="fa fa-check"></i><b>5.7</b> Turn this into a function</a></li>
<li class="chapter" data-level="5.8" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#manual-changes-to-column-names"><i class="fa fa-check"></i><b>5.8</b> Manual changes to column names</a></li>
<li class="chapter" data-level="5.9" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#have-r-write-out-the-rename-code"><i class="fa fa-check"></i><b>5.9</b> Have R write out the rename code</a></li>
<li class="chapter" data-level="5.10" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#rename-the-columns"><i class="fa fa-check"></i><b>5.10</b> Rename the columns</a></li>
<li class="chapter" data-level="5.11" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#repeat-the-process-for-v2"><i class="fa fa-check"></i><b>5.11</b> Repeat the process for V2</a></li>
<li class="chapter" data-level="5.12" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#repeat-the-process-for-v3"><i class="fa fa-check"></i><b>5.12</b> Repeat the process for V3</a></li>
<li class="chapter" data-level="5.13" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#merge-all-3-visits"><i class="fa fa-check"></i><b>5.13</b> Merge all 3 visits</a></li>
<li class="chapter" data-level="5.14" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#final-data-cleaning"><i class="fa fa-check"></i><b>5.14</b> Final data cleaning</a></li>
<li class="chapter" data-level="5.15" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#the-dplyr-way"><i class="fa fa-check"></i><b>5.15</b> ğŸŸ£The dplyr way</a></li>
<li class="chapter" data-level="5.16" data-path="column-names-prepping-many-for-merge.html"><a href="column-names-prepping-many-for-merge.html#making-a-key-in-google-sheets"><i class="fa fa-check"></i><b>5.16</b> ğŸŸ¢ Making a key in Google Sheets</a></li>
</ul></li>
<li class="part"><span><b>IV Analysis</b></span></li>
<li class="chapter" data-level="6" data-path="contingency-tables.html"><a href="contingency-tables.html"><i class="fa fa-check"></i><b>6</b> Contingency Tables</a>
<ul>
<li class="chapter" data-level="6.1" data-path="contingency-tables.html"><a href="contingency-tables.html#overview-4"><i class="fa fa-check"></i><b>6.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="6.2" data-path="contingency-tables.html"><a href="contingency-tables.html#useful-websites-4"><i class="fa fa-check"></i><b>6.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="6.3" data-path="contingency-tables.html"><a href="contingency-tables.html#load-packages-2"><i class="fa fa-check"></i><b>6.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="6.4" data-path="contingency-tables.html"><a href="contingency-tables.html#scenario"><i class="fa fa-check"></i><b>6.4</b> Scenario</a></li>
<li class="chapter" data-level="6.5" data-path="contingency-tables.html"><a href="contingency-tables.html#manually-create-data"><i class="fa fa-check"></i><b>6.5</b> Manually create data</a></li>
<li class="chapter" data-level="6.6" data-path="contingency-tables.html"><a href="contingency-tables.html#matrix"><i class="fa fa-check"></i><b>6.6</b> Matrix</a></li>
<li class="chapter" data-level="6.7" data-path="contingency-tables.html"><a href="contingency-tables.html#table"><i class="fa fa-check"></i><b>6.7</b> Table</a></li>
<li class="chapter" data-level="6.8" data-path="contingency-tables.html"><a href="contingency-tables.html#base-r-data-frame-with-rownames"><i class="fa fa-check"></i><b>6.8</b> Base R data frame with rownames</a></li>
<li class="chapter" data-level="6.9" data-path="contingency-tables.html"><a href="contingency-tables.html#tibble"><i class="fa fa-check"></i><b>6.9</b> Tibble</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="effect-measure-modification.html"><a href="effect-measure-modification.html"><i class="fa fa-check"></i><b>7</b> Effect-measure modification</a>
<ul>
<li class="chapter" data-level="7.1" data-path="effect-measure-modification.html"><a href="effect-measure-modification.html#overview-5"><i class="fa fa-check"></i><b>7.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="7.2" data-path="effect-measure-modification.html"><a href="effect-measure-modification.html#useful-websites-5"><i class="fa fa-check"></i><b>7.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="7.3" data-path="effect-measure-modification.html"><a href="effect-measure-modification.html#load-packages-3"><i class="fa fa-check"></i><b>7.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="7.4" data-path="effect-measure-modification.html"><a href="effect-measure-modification.html#simulate-data-2"><i class="fa fa-check"></i><b>7.4</b> ğŸ”¢Simulate data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="risk-difference.html"><a href="risk-difference.html"><i class="fa fa-check"></i><b>8</b> Risk Difference</a>
<ul>
<li class="chapter" data-level="8.1" data-path="risk-difference.html"><a href="risk-difference.html#overview-6"><i class="fa fa-check"></i><b>8.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="8.2" data-path="risk-difference.html"><a href="risk-difference.html#useful-websites-6"><i class="fa fa-check"></i><b>8.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="8.3" data-path="risk-difference.html"><a href="risk-difference.html#load-packages-4"><i class="fa fa-check"></i><b>8.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="8.4" data-path="risk-difference.html"><a href="risk-difference.html#data-summary"><i class="fa fa-check"></i><b>8.4</b> Data Summary</a></li>
<li class="chapter" data-level="8.5" data-path="risk-difference.html"><a href="risk-difference.html#simulate-data-3"><i class="fa fa-check"></i><b>8.5</b> ğŸ”¢Simulate data</a></li>
<li class="chapter" data-level="8.6" data-path="risk-difference.html"><a href="risk-difference.html#analysis"><i class="fa fa-check"></i><b>8.6</b> ğŸ“ˆAnalysis</a></li>
</ul></li>
<li class="part"><span><b>V Data Visualization</b></span></li>
<li class="part"><span><b>VI Presenting Results</b></span></li>
<li class="chapter" data-level="9" data-path="book-chapters.html"><a href="book-chapters.html"><i class="fa fa-check"></i><b>9</b> Bookdown: Creating Book Chapters</a>
<ul>
<li class="chapter" data-level="9.1" data-path="book-chapters.html"><a href="book-chapters.html#chapter-overview"><i class="fa fa-check"></i><b>9.1</b> Chapter overview</a></li>
<li class="chapter" data-level="9.2" data-path="book-chapters.html"><a href="book-chapters.html#motivating-example"><i class="fa fa-check"></i><b>9.2</b> Motivating example</a></li>
<li class="chapter" data-level="9.3" data-path="book-chapters.html"><a href="book-chapters.html#body"><i class="fa fa-check"></i><b>9.3</b> Body</a></li>
<li class="chapter" data-level="9.4" data-path="book-chapters.html"><a href="book-chapters.html#cross-references"><i class="fa fa-check"></i><b>9.4</b> Cross-references</a></li>
<li class="chapter" data-level="9.5" data-path="book-chapters.html"><a href="book-chapters.html#citations"><i class="fa fa-check"></i><b>9.5</b> Citations</a></li>
<li class="chapter" data-level="9.6" data-path="book-chapters.html"><a href="book-chapters.html#previewing-the-chapter"><i class="fa fa-check"></i><b>9.6</b> Previewing the chapter</a></li>
<li class="chapter" data-level="9.7" data-path="book-chapters.html"><a href="book-chapters.html#additional-resources-function-to-check"><i class="fa fa-check"></i><b>9.7</b> Additional resources: function to check</a></li>
<li class="chapter" data-level="9.8" data-path="book-chapters.html"><a href="book-chapters.html#key-terms-function-to-add-to-appendix"><i class="fa fa-check"></i><b>9.8</b> Key terms : function to add to appendix</a></li>
<li class="chapter" data-level="9.9" data-path="book-chapters.html"><a href="book-chapters.html#final-example-code-function-to-add-to-appendix"><i class="fa fa-check"></i><b>9.9</b> Final example code : function to add to appendix</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html"><i class="fa fa-check"></i><b>10</b> Bookdown: Quick Start</a>
<ul>
<li class="chapter" data-level="10.1" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#overview-7"><i class="fa fa-check"></i><b>10.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="10.2" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#useful-websites-7"><i class="fa fa-check"></i><b>10.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="10.3" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#creating-the-bookdown-project-locally"><i class="fa fa-check"></i><b>10.3</b> Creating the bookdown project locally</a></li>
<li class="chapter" data-level="10.4" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#initiate-a-git-repository"><i class="fa fa-check"></i><b>10.4</b> Initiate a git repository</a></li>
<li class="chapter" data-level="10.5" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#create-a-github-repository-for-the-book"><i class="fa fa-check"></i><b>10.5</b> Create a github repository for the book</a></li>
<li class="chapter" data-level="10.6" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#configuring-a-publishing-source-for-the-github-pages-site"><i class="fa fa-check"></i><b>10.6</b> Configuring a publishing source for the GitHub Pages site</a></li>
<li class="chapter" data-level="10.7" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#modify-_bookdown.yml"><i class="fa fa-check"></i><b>10.7</b> Modify _bookdown.yml</a></li>
<li class="chapter" data-level="10.8" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#modify-_output.yml"><i class="fa fa-check"></i><b>10.8</b> Modify _output.yml</a></li>
<li class="chapter" data-level="10.9" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#modify-style.css"><i class="fa fa-check"></i><b>10.9</b> Modify style.css</a></li>
<li class="chapter" data-level="10.10" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#modify-index.rmd"><i class="fa fa-check"></i><b>10.10</b> Modify index.Rmd</a></li>
<li class="chapter" data-level="10.11" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#creating-bookdown-chapters"><i class="fa fa-check"></i><b>10.11</b> Creating bookdown chapters</a></li>
<li class="chapter" data-level="10.12" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#knitting-the-book"><i class="fa fa-check"></i><b>10.12</b> Knitting the book</a></li>
<li class="chapter" data-level="10.13" data-path="bookdown-quick-start.html"><a href="bookdown-quick-start.html#errors-and-warnings"><i class="fa fa-check"></i><b>10.13</b> Errors and warnings</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="flexdashboard.html"><a href="flexdashboard.html"><i class="fa fa-check"></i><b>11</b> Flexdashboard</a>
<ul>
<li class="chapter" data-level="11.1" data-path="flexdashboard.html"><a href="flexdashboard.html#overview-8"><i class="fa fa-check"></i><b>11.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="11.2" data-path="flexdashboard.html"><a href="flexdashboard.html#useful-websites-8"><i class="fa fa-check"></i><b>11.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="11.3" data-path="flexdashboard.html"><a href="flexdashboard.html#load-packages-5"><i class="fa fa-check"></i><b>11.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="11.4" data-path="flexdashboard.html"><a href="flexdashboard.html#tips"><i class="fa fa-check"></i><b>11.4</b> Tips</a></li>
<li class="chapter" data-level="11.5" data-path="flexdashboard.html"><a href="flexdashboard.html#simulate-data-4"><i class="fa fa-check"></i><b>11.5</b> ğŸ”¢Simulate data</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="flextable.html"><a href="flextable.html"><i class="fa fa-check"></i><b>12</b> Flextable</a>
<ul>
<li class="chapter" data-level="12.1" data-path="flextable.html"><a href="flextable.html#overview-9"><i class="fa fa-check"></i><b>12.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="12.2" data-path="flextable.html"><a href="flextable.html#useful-websites-9"><i class="fa fa-check"></i><b>12.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="12.3" data-path="flextable.html"><a href="flextable.html#load-packages-6"><i class="fa fa-check"></i><b>12.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="12.4" data-path="flextable.html"><a href="flextable.html#load-data"><i class="fa fa-check"></i><b>12.4</b> Load data</a></li>
<li class="chapter" data-level="12.5" data-path="flextable.html"><a href="flextable.html#i-and-j"><i class="fa fa-check"></i><b>12.5</b> ğŸ”µ i and j</a></li>
<li class="chapter" data-level="12.6" data-path="flextable.html"><a href="flextable.html#flextable-wrappers"><i class="fa fa-check"></i><b>12.6</b> ğŸ”µ Flextable wrappers</a></li>
<li class="chapter" data-level="12.7" data-path="flextable.html"><a href="flextable.html#addingmodifying-table-content"><i class="fa fa-check"></i><b>12.7</b> ğŸ”µ Adding/modifying table content</a></li>
<li class="chapter" data-level="12.8" data-path="flextable.html"><a href="flextable.html#formatting"><i class="fa fa-check"></i><b>12.8</b> ğŸ”µ Formatting</a></li>
<li class="chapter" data-level="12.9" data-path="flextable.html"><a href="flextable.html#layout"><i class="fa fa-check"></i><b>12.9</b> ğŸ”µLayout</a></li>
<li class="chapter" data-level="12.10" data-path="flextable.html"><a href="flextable.html#examples"><i class="fa fa-check"></i><b>12.10</b> ğŸ”µ Examples</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="language-for-publications.html"><a href="language-for-publications.html"><i class="fa fa-check"></i><b>13</b> Language for publications</a>
<ul>
<li class="chapter" data-level="13.1" data-path="language-for-publications.html"><a href="language-for-publications.html#overview-10"><i class="fa fa-check"></i><b>13.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="13.2" data-path="language-for-publications.html"><a href="language-for-publications.html#useful-websites-10"><i class="fa fa-check"></i><b>13.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="13.3" data-path="language-for-publications.html"><a href="language-for-publications.html#load-packages-7"><i class="fa fa-check"></i><b>13.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="13.4" data-path="language-for-publications.html"><a href="language-for-publications.html#statistical-software"><i class="fa fa-check"></i><b>13.4</b> Statistical software</a></li>
<li class="chapter" data-level="13.5" data-path="language-for-publications.html"><a href="language-for-publications.html#irb"><i class="fa fa-check"></i><b>13.5</b> IRB</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="officer.html"><a href="officer.html"><i class="fa fa-check"></i><b>14</b> Officer</a>
<ul>
<li class="chapter" data-level="14.1" data-path="officer.html"><a href="officer.html#overview-11"><i class="fa fa-check"></i><b>14.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="14.2" data-path="officer.html"><a href="officer.html#useful-websites-11"><i class="fa fa-check"></i><b>14.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="14.3" data-path="officer.html"><a href="officer.html#load-packages-8"><i class="fa fa-check"></i><b>14.3</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="14.4" data-path="officer.html"><a href="officer.html#formatted-text"><i class="fa fa-check"></i><b>14.4</b> Formatted text</a></li>
<li class="chapter" data-level="14.5" data-path="officer.html"><a href="officer.html#bulleted-list"><i class="fa fa-check"></i><b>14.5</b> Bulleted list</a></li>
<li class="chapter" data-level="14.6" data-path="officer.html"><a href="officer.html#adding-on-to-the-end-of-a-file."><i class="fa fa-check"></i><b>14.6</b> Adding on to the end of a file.</a></li>
<li class="chapter" data-level="14.7" data-path="officer.html"><a href="officer.html#using-bookmarks"><i class="fa fa-check"></i><b>14.7</b> Using bookmarks</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>15</b> Tables</a>
<ul>
<li class="chapter" data-level="15.1" data-path="tables.html"><a href="tables.html#overview-12"><i class="fa fa-check"></i><b>15.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="15.2" data-path="tables.html"><a href="tables.html#projects-to-review-and-incorporate"><i class="fa fa-check"></i><b>15.2</b> Projects to review and incorporate</a></li>
<li class="chapter" data-level="15.3" data-path="tables.html"><a href="tables.html#useful-websites-12"><i class="fa fa-check"></i><b>15.3</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="15.4" data-path="tables.html"><a href="tables.html#load-packages-9"><i class="fa fa-check"></i><b>15.4</b> ğŸ“¦Load packages</a></li>
<li class="chapter" data-level="15.5" data-path="tables.html"><a href="tables.html#simulate-data-5"><i class="fa fa-check"></i><b>15.5</b> ğŸ”¢Simulate data</a></li>
<li class="chapter" data-level="15.6" data-path="tables.html"><a href="tables.html#example-table-1"><i class="fa fa-check"></i><b>15.6</b> ğŸ”µ Example: Table 1</a></li>
</ul></li>
<li class="part"><span><b>VII Shiny</b></span></li>
<li class="part"><span><b>VIII Collaborating</b></span></li>
<li class="chapter" data-level="16" data-path="git-and-github.html"><a href="git-and-github.html"><i class="fa fa-check"></i><b>16</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="16.1" data-path="git-and-github.html"><a href="git-and-github.html#overview-13"><i class="fa fa-check"></i><b>16.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="16.2" data-path="git-and-github.html"><a href="git-and-github.html#useful-websites-13"><i class="fa fa-check"></i><b>16.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="16.3" data-path="git-and-github.html"><a href="git-and-github.html#get-rid-of-.ds_store-1"><i class="fa fa-check"></i><b>16.3</b> Get rid of .DS_Store</a></li>
<li class="chapter" data-level="16.4" data-path="git-and-github.html"><a href="git-and-github.html#amend"><i class="fa fa-check"></i><b>16.4</b> Amend</a></li>
<li class="chapter" data-level="16.5" data-path="git-and-github.html"><a href="git-and-github.html#pull-requests"><i class="fa fa-check"></i><b>16.5</b> Pull Requests</a></li>
<li class="chapter" data-level="16.6" data-path="git-and-github.html"><a href="git-and-github.html#branches"><i class="fa fa-check"></i><b>16.6</b> Branches</a></li>
</ul></li>
<li class="part"><span><b>IX Appendix</b></span></li>
<li class="chapter" data-level="17" data-path="appendix-a-terms-and-definitions.html"><a href="appendix-a-terms-and-definitions.html"><i class="fa fa-check"></i><b>17</b> Appendix A: Terms and Definitions</a>
<ul>
<li class="chapter" data-level="17.1" data-path="appendix-a-terms-and-definitions.html"><a href="appendix-a-terms-and-definitions.html#overview-14"><i class="fa fa-check"></i><b>17.1</b> â­ï¸Overview</a></li>
<li class="chapter" data-level="17.2" data-path="appendix-a-terms-and-definitions.html"><a href="appendix-a-terms-and-definitions.html#useful-websites-14"><i class="fa fa-check"></i><b>17.2</b> ğŸŒUseful websites</a></li>
<li class="chapter" data-level="17.3" data-path="appendix-a-terms-and-definitions.html"><a href="appendix-a-terms-and-definitions.html#terms"><i class="fa fa-check"></i><b>17.3</b> ğŸ“–Terms</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tables" class="section level1" number="15">
<h1><span class="header-section-number">15</span> Tables</h1>
<!--
Links to fix if you add to R4Epi (search):
- Flexdashboard
- Officer
- iterative processing
- R4Epi Descriptive Analysis
- meantables
- freqtables
- restructuring data frames
- writing functions
-->
<p><img src="https://picsum.photos/200/300" /><!-- --></p>
<div id="overview-12" class="section level2" number="15.1">
<h2><span class="header-section-number">15.1</span> â­ï¸Overview</h2>
<p>This chapter is about <strong>formatting and presenting statistical results in tables.</strong></p>
<p>The immediate results of statistical analyses are rarely fit for general consumption. This chapter walks through strategies and functions we can use to make our results ready for presentation/dissemination.</p>
<p>Tables are one of the most popular ways to present information to our audience. When our goal is to show our readers precise numerical summaries of our data, the exact values that resulted from our analysis are important.</p>
<p>However, the specific details that we may want to present from table to table, or the way in which we want to present them, can vary widely. For example, an initial table of descriptive information about our participants may or may not be stratified by subgroups of interest. Additionally, it may include variables of different types, and for any given type, it may include various different kinds of numerical summaries. Further, there are numerous types of inferential models that result in numerical summaries that we may want to present in a table. For these reasons, it is difficult to create a good one-size-fits-all approach to automating the process of making results ready for presentation and dissemination.</p>
<p>Having said that, below we walk through some basic strategies for automating the processes of putting results into presentation-ready summary tables â€“ and in a way that makes updating them (which happens A LOT) as painless as possible.</p>
</div>
<div id="projects-to-review-and-incorporate" class="section level2" number="15.2">
<h2><span class="header-section-number">15.2</span> Projects to review and incorporate</h2>
<p>stroke study -&gt; table_characteristics_by_network.Rmd to see an example of doing this with purrr::map. When you have time, you should add an example into this document.</p>
<p>See Sun Study Report Template for a good example of automating this with Officer and Flextable.</p>
<p>I used a little different method in Link2Care &gt; paper_smartphone_app &gt; table_use_app.Rmd. Try to work some of that in below.</p>
<p>/Users/bradcannell/Dropbox/01 Research/Elder Abuse/DETECT NIH RFA-AG-18-010/LEAD Panel/summarise_lead_votes/report_filemaker.Rmd</p>
<p>This chapter also kind of overlaps with the <a href="flexdashboard.html#flexdashboard">Flexdashboard</a> and <a href="officer.html#officer">Officer</a> chapters. At some point, I should think about the best way to link and organize the chapters. Another option is to put all the flextable stuff in this chapter. I might still want a separate chapter about officer.</p>
</div>
<div id="useful-websites-12" class="section level2" number="15.3">
<h2><span class="header-section-number">15.3</span> ğŸŒUseful websites</h2>
<ul>
<li><a href="https://davidgohel.github.io/officer/articles/offcran/word.html">Officer Word document generation</a><br />
</li>
<li><a href="https://davidgohel.github.io/flextable/articles/overview.html">Flextable Overview</a><br />
</li>
<li><a href="http://www.danieldsjoberg.com/gtsummary/">R gtsummary package</a></li>
</ul>
</div>
<div id="load-packages-9" class="section level2" number="15.4">
<h2><span class="header-section-number">15.4</span> ğŸ“¦Load packages</h2>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="tables.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb289-2"><a href="tables.html#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb289-3"><a href="tables.html#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(meantables)</span>
<span id="cb289-4"><a href="tables.html#cb289-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(freqtables)</span>
<span id="cb289-5"><a href="tables.html#cb289-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb289-6"><a href="tables.html#cb289-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb289-7"><a href="tables.html#cb289-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb289-8"><a href="tables.html#cb289-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(officer)</span></code></pre></div>
</div>
<div id="simulate-data-5" class="section level2" number="15.5">
<h2><span class="header-section-number">15.5</span> ğŸ”¢Simulate data</h2>
<p>Have you noticed how we will often calculate the same statistical measures for many different variables in our data? For example, letâ€™s say that we have some pretty standard data about some study participants that looks like this:</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="tables.html#cb290-1" aria-hidden="true" tabindex="-1"></a>study <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb290-2"><a href="tables.html#cb290-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">id        =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>),</span>
<span id="cb290-3"><a href="tables.html#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">age       =</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">30</span>, <span class="dv">32</span>, <span class="dv">29</span>, <span class="dv">24</span>, <span class="dv">38</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">48</span>, <span class="dv">29</span>, <span class="dv">22</span>, <span class="dv">29</span>, <span class="dv">24</span>, <span class="dv">28</span>, <span class="dv">24</span>, <span class="dv">25</span>, </span>
<span id="cb290-4"><a href="tables.html#cb290-4" aria-hidden="true" tabindex="-1"></a>                <span class="dv">25</span>, <span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">29</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">26</span>, <span class="dv">23</span>, </span>
<span id="cb290-5"><a href="tables.html#cb290-5" aria-hidden="true" tabindex="-1"></a>                <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">33</span>, <span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">24</span>, <span class="dv">43</span>, <span class="dv">25</span>, <span class="dv">24</span>, </span>
<span id="cb290-6"><a href="tables.html#cb290-6" aria-hidden="true" tabindex="-1"></a>                <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">31</span>, <span class="dv">34</span>, </span>
<span id="cb290-7"><a href="tables.html#cb290-7" aria-hidden="true" tabindex="-1"></a>                <span class="dv">26</span>, <span class="dv">25</span>, <span class="dv">27</span>, <span class="dv">40</span>, <span class="dv">35</span>, <span class="dv">43</span>, <span class="dv">81</span>, <span class="dv">18</span>, <span class="dv">79</span>, <span class="dv">45</span>, <span class="dv">37</span>, <span class="dv">66</span>, <span class="dv">35</span>, <span class="dv">81</span>, <span class="dv">50</span>, <span class="dv">54</span>, </span>
<span id="cb290-8"><a href="tables.html#cb290-8" aria-hidden="true" tabindex="-1"></a>                <span class="dv">24</span>, <span class="dv">47</span>, <span class="dv">84</span>, <span class="dv">38</span>, <span class="dv">23</span>, <span class="dv">74</span>, <span class="dv">77</span>, <span class="dv">65</span>, <span class="dv">46</span>, <span class="dv">55</span>, <span class="dv">41</span>, <span class="dv">84</span>, <span class="dv">41</span>, <span class="dv">29</span>, <span class="dv">60</span>, <span class="dv">60</span>, </span>
<span id="cb290-9"><a href="tables.html#cb290-9" aria-hidden="true" tabindex="-1"></a>                <span class="dv">40</span>, <span class="dv">53</span>, <span class="dv">31</span>, <span class="dv">77</span>),</span>
<span id="cb290-10"><a href="tables.html#cb290-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb290-11"><a href="tables.html#cb290-11" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb290-12"><a href="tables.html#cb290-12" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, </span>
<span id="cb290-13"><a href="tables.html#cb290-13" aria-hidden="true" tabindex="-1"></a>                <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, </span>
<span id="cb290-14"><a href="tables.html#cb290-14" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb290-15"><a href="tables.html#cb290-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb290-16"><a href="tables.html#cb290-16" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, </span>
<span id="cb290-17"><a href="tables.html#cb290-17" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, </span>
<span id="cb290-18"><a href="tables.html#cb290-18" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, </span>
<span id="cb290-19"><a href="tables.html#cb290-19" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb290-20"><a href="tables.html#cb290-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ht_in     =</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">63</span>, <span class="dv">62</span>, <span class="dv">67</span>, <span class="dv">67</span>, <span class="dv">58</span>, <span class="dv">64</span>, <span class="dv">69</span>, <span class="dv">65</span>, <span class="dv">68</span>, <span class="dv">63</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">65</span>, </span>
<span id="cb290-21"><a href="tables.html#cb290-21" aria-hidden="true" tabindex="-1"></a>                <span class="dv">64</span>, <span class="dv">75</span>, <span class="dv">67</span>, <span class="dv">63</span>, <span class="dv">60</span>, <span class="dv">67</span>, <span class="dv">64</span>, <span class="dv">73</span>, <span class="dv">62</span>, <span class="dv">69</span>, <span class="dv">67</span>, <span class="dv">62</span>, <span class="dv">68</span>, <span class="dv">66</span>, <span class="dv">66</span>, <span class="dv">62</span>, </span>
<span id="cb290-22"><a href="tables.html#cb290-22" aria-hidden="true" tabindex="-1"></a>                <span class="dv">64</span>, <span class="dv">68</span>, <span class="cn">NA</span>, <span class="dv">68</span>, <span class="dv">70</span>, <span class="dv">68</span>, <span class="dv">68</span>, <span class="dv">66</span>, <span class="dv">71</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">63</span>, <span class="dv">67</span>, <span class="dv">66</span>, </span>
<span id="cb290-23"><a href="tables.html#cb290-23" aria-hidden="true" tabindex="-1"></a>                <span class="dv">69</span>, <span class="dv">76</span>, <span class="cn">NA</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">65</span>, <span class="dv">71</span>, <span class="dv">66</span>, <span class="dv">65</span>, <span class="dv">65</span>, <span class="dv">71</span>, <span class="dv">64</span>, <span class="dv">71</span>, <span class="dv">60</span>, <span class="dv">62</span>, </span>
<span id="cb290-24"><a href="tables.html#cb290-24" aria-hidden="true" tabindex="-1"></a>                <span class="dv">61</span>, <span class="dv">69</span>, <span class="dv">66</span>, <span class="cn">NA</span>, <span class="dv">73</span>, <span class="dv">71</span>, <span class="dv">72</span>, <span class="dv">76</span>, <span class="dv">74</span>, <span class="dv">63</span>, <span class="dv">65</span>, <span class="dv">65</span>, <span class="dv">73</span>, <span class="dv">76</span>, <span class="dv">66</span>, <span class="dv">58</span>, </span>
<span id="cb290-25"><a href="tables.html#cb290-25" aria-hidden="true" tabindex="-1"></a>                <span class="dv">65</span>, <span class="dv">65</span>, <span class="dv">65</span>, <span class="dv">68</span>, <span class="dv">71</span>, <span class="dv">68</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">68</span>, <span class="dv">62</span>, <span class="dv">74</span>, <span class="dv">68</span>, <span class="dv">76</span>, <span class="dv">72</span>, <span class="dv">59</span>, <span class="dv">76</span>, </span>
<span id="cb290-26"><a href="tables.html#cb290-26" aria-hidden="true" tabindex="-1"></a>                <span class="dv">61</span>, <span class="dv">72</span>, <span class="dv">69</span>, <span class="dv">59</span>),</span>
<span id="cb290-27"><a href="tables.html#cb290-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">wt_lbs    =</span> <span class="fu">c</span>(<span class="dv">216</span>, <span class="dv">106</span>, <span class="dv">145</span>, <span class="dv">195</span>, <span class="dv">143</span>, <span class="dv">125</span>, <span class="dv">138</span>, <span class="dv">140</span>, <span class="dv">158</span>, <span class="dv">167</span>, <span class="dv">145</span>, <span class="dv">297</span>, <span class="dv">146</span>, </span>
<span id="cb290-28"><a href="tables.html#cb290-28" aria-hidden="true" tabindex="-1"></a>                <span class="dv">125</span>, <span class="dv">111</span>, <span class="dv">125</span>, <span class="dv">130</span>, <span class="dv">182</span>, <span class="dv">170</span>, <span class="dv">121</span>, <span class="dv">98</span>, <span class="dv">150</span>, <span class="dv">132</span>, <span class="dv">250</span>, <span class="dv">137</span>, <span class="dv">124</span>, </span>
<span id="cb290-29"><a href="tables.html#cb290-29" aria-hidden="true" tabindex="-1"></a>                <span class="dv">186</span>, <span class="dv">148</span>, <span class="dv">134</span>, <span class="dv">155</span>, <span class="dv">122</span>, <span class="dv">142</span>, <span class="dv">110</span>, <span class="dv">132</span>, <span class="dv">188</span>, <span class="dv">176</span>, <span class="dv">188</span>, <span class="dv">166</span>, <span class="dv">136</span>, </span>
<span id="cb290-30"><a href="tables.html#cb290-30" aria-hidden="true" tabindex="-1"></a>                <span class="dv">147</span>, <span class="dv">178</span>, <span class="dv">125</span>, <span class="dv">102</span>, <span class="dv">140</span>, <span class="dv">139</span>, <span class="dv">60</span>, <span class="dv">147</span>, <span class="dv">147</span>, <span class="dv">141</span>, <span class="dv">232</span>, <span class="dv">186</span>, <span class="dv">212</span>, </span>
<span id="cb290-31"><a href="tables.html#cb290-31" aria-hidden="true" tabindex="-1"></a>                <span class="dv">110</span>, <span class="dv">110</span>, <span class="dv">115</span>, <span class="dv">154</span>, <span class="dv">140</span>, <span class="dv">150</span>, <span class="dv">130</span>, <span class="cn">NA</span>, <span class="dv">171</span>, <span class="dv">156</span>, <span class="dv">92</span>, <span class="dv">122</span>, <span class="dv">102</span>, </span>
<span id="cb290-32"><a href="tables.html#cb290-32" aria-hidden="true" tabindex="-1"></a>                <span class="dv">163</span>, <span class="dv">141</span>, <span class="cn">NA</span>, <span class="dv">106</span>, <span class="dv">118</span>, <span class="dv">205</span>, <span class="dv">229</span>, <span class="dv">198</span>, <span class="dv">255</span>, <span class="dv">268</span>, <span class="dv">203</span>, <span class="dv">269</span>, <span class="dv">162</span>, </span>
<span id="cb290-33"><a href="tables.html#cb290-33" aria-hidden="true" tabindex="-1"></a>                <span class="dv">115</span>, <span class="dv">106</span>, <span class="dv">139</span>, <span class="dv">246</span>, <span class="dv">147</span>, <span class="dv">206</span>, <span class="dv">202</span>, <span class="dv">209</span>, <span class="dv">123</span>, <span class="dv">265</span>, <span class="dv">119</span>, <span class="dv">171</span>, <span class="dv">195</span>, </span>
<span id="cb290-34"><a href="tables.html#cb290-34" aria-hidden="true" tabindex="-1"></a>                <span class="dv">136</span>, <span class="dv">208</span>, <span class="dv">108</span>, <span class="dv">201</span>, <span class="dv">224</span>, <span class="dv">261</span>, <span class="dv">169</span>, <span class="dv">295</span>, <span class="dv">93</span>)</span>
<span id="cb290-35"><a href="tables.html#cb290-35" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb290-36"><a href="tables.html#cb290-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Add calculated variables</span></span>
<span id="cb290-37"><a href="tables.html#cb290-37" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb290-38"><a href="tables.html#cb290-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">bmi      =</span> <span class="fu">round</span>(wt_lbs <span class="sc">/</span> ht_in<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="dv">703</span>, <span class="dv">2</span>),</span>
<span id="cb290-39"><a href="tables.html#cb290-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">bmi_4cat =</span> <span class="fu">case_when</span>(</span>
<span id="cb290-40"><a href="tables.html#cb290-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(bmi) <span class="sc">~</span> <span class="cn">NA_real_</span>, <span class="co"># Missing</span></span>
<span id="cb290-41"><a href="tables.html#cb290-41" aria-hidden="true" tabindex="-1"></a>    bmi <span class="sc">&lt;</span> <span class="fl">18.5</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># Underweight</span></span>
<span id="cb290-42"><a href="tables.html#cb290-42" aria-hidden="true" tabindex="-1"></a>    bmi <span class="sc">&lt;</span> <span class="dv">25</span>   <span class="sc">~</span> <span class="dv">2</span>, <span class="co"># Normal weight</span></span>
<span id="cb290-43"><a href="tables.html#cb290-43" aria-hidden="true" tabindex="-1"></a>    bmi <span class="sc">&lt;</span> <span class="dv">30</span>   <span class="sc">~</span> <span class="dv">3</span>, <span class="co"># Overweight</span></span>
<span id="cb290-44"><a href="tables.html#cb290-44" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span>       <span class="sc">~</span> <span class="dv">4</span>  <span class="co"># Obese</span></span>
<span id="cb290-45"><a href="tables.html#cb290-45" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb290-46"><a href="tables.html#cb290-46" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb290-47"><a href="tables.html#cb290-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Create exposure and outcome where,</span></span>
<span id="cb290-48"><a href="tables.html#cb290-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Exposure is more likely in people over age 30 and</span></span>
<span id="cb290-49"><a href="tables.html#cb290-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Outcome is more likely in peeople with exposure</span></span>
<span id="cb290-50"><a href="tables.html#cb290-50" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb290-51"><a href="tables.html#cb290-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="fu">if_else</span>(</span>
<span id="cb290-52"><a href="tables.html#cb290-52" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb290-53"><a href="tables.html#cb290-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">100</span>, <span class="cn">TRUE</span>, <span class="fu">c</span>(.<span class="dv">9</span>, .<span class="dv">1</span>)),</span>
<span id="cb290-54"><a href="tables.html#cb290-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">100</span>, <span class="cn">TRUE</span>, <span class="fu">c</span>(.<span class="dv">7</span>, .<span class="dv">3</span>))</span>
<span id="cb290-55"><a href="tables.html#cb290-55" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb290-56"><a href="tables.html#cb290-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="fu">if_else</span>(</span>
<span id="cb290-57"><a href="tables.html#cb290-57" aria-hidden="true" tabindex="-1"></a>    exposure <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb290-58"><a href="tables.html#cb290-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">100</span>, <span class="cn">TRUE</span>, <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">2</span>)),</span>
<span id="cb290-59"><a href="tables.html#cb290-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">100</span>, <span class="cn">TRUE</span>, <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>))</span>
<span id="cb290-60"><a href="tables.html#cb290-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb290-61"><a href="tables.html#cb290-61" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb290-62"><a href="tables.html#cb290-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Make factors</span></span>
<span id="cb290-63"><a href="tables.html#cb290-63" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb290-64"><a href="tables.html#cb290-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">factor</span>(age_group, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Younger than 30&quot;</span>, <span class="st">&quot;30 and Older&quot;</span>)),</span>
<span id="cb290-65"><a href="tables.html#cb290-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender    =</span> <span class="fu">factor</span>(gender, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>)),</span>
<span id="cb290-66"><a href="tables.html#cb290-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">bmi_4cat  =</span> <span class="fu">factor</span>(bmi_4cat, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Underweight&quot;</span>, <span class="st">&quot;Normal&quot;</span>, <span class="st">&quot;Overweight&quot;</span>, <span class="st">&quot;Obese&quot;</span>)),</span>
<span id="cb290-67"><a href="tables.html#cb290-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure  =</span> <span class="fu">factor</span>(exposure, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>)),</span>
<span id="cb290-68"><a href="tables.html#cb290-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome   =</span> <span class="fu">factor</span>(outcome, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))</span>
<span id="cb290-69"><a href="tables.html#cb290-69" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="tables.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(study, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-b0c92a8726938565a059" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b0c92a8726938565a059">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],[32,30,32,29,24,38,25,24,48,29,22,29,24,28,24,25,25,22,25,24,25,24,23,24,31,24,29,24,22,23,26,23,24,25,24,33,27,25,26,26,26,26,26,27,24,43,25,24,27,28,29,24,26,28,25,24,26,24,26,31,24,26,31,34,26,25,27,40,35,43,81,18,79,45,37,66,35,81,50,54,24,47,84,38,23,74,77,65,46,55,41,84,41,29,60,60,40,53,31,77],["30 and Older","30 and Older","30 and Older","Younger than 30","Younger than 30","30 and Older","Younger than 30","Younger than 30","30 and Older","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","30 and Older","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","30 and Older","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","30 and Older","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","Younger than 30","30 and Older","Younger than 30","Younger than 30","30 and Older","30 and Older","Younger than 30","Younger than 30","Younger than 30","30 and Older","30 and Older","30 and Older","30 and Older","Younger than 30","30 and Older","30 and Older","30 and Older","30 and Older","30 and Older","30 and Older","30 and Older","30 and Older","Younger than 30","30 and Older","30 and Older","30 and Older","Younger than 30","30 and Older","30 and Older","30 and Older","30 and Older","30 and Older","30 and Older","30 and Older","30 and Older","Younger than 30","30 and Older","30 and Older","30 and Older","30 and Older","30 and Older","30 and Older"],["Male","Female","Female","Male","Female","Female","Female","Male","Male","Male","Female","Female","Male","Female","Female","Female","Female","Male","Male","Female","Female","Female","Female","Male","Female","Female","Male","Female","Female","Female","Male","Female","Female","Male","Male","Female","Male","Male","Female","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Male","Male","Female","Female","Female","Female","Male","Male","Female","Female","Male","Female","Male","Female","Female","Female","Male","Female","Male","Male","Female","Female","Male","Female","Female","Female","Female","Male","Male","Male","Male","Male","Female","Male","Male","Female","Male","Female","Male","Male","Male","Female","Male","Male","Female","Female","Male","Male","Male","Female","Female"],[70,63,62,67,67,58,64,69,65,68,63,68,69,66,67,65,64,75,67,63,60,67,64,73,62,69,67,62,68,66,66,62,64,68,null,68,70,68,68,66,71,61,62,64,64,63,67,66,69,76,null,63,64,65,65,71,66,65,65,71,64,71,60,62,61,69,66,null,73,71,72,76,74,63,65,65,73,76,66,58,65,65,65,68,71,68,60,70,68,62,74,68,76,72,59,76,61,72,69,59],[216,106,145,195,143,125,138,140,158,167,145,297,146,125,111,125,130,182,170,121,98,150,132,250,137,124,186,148,134,155,122,142,110,132,188,176,188,166,136,147,178,125,102,140,139,60,147,147,141,232,186,212,110,110,115,154,140,150,130,null,171,156,92,122,102,163,141,null,106,118,205,229,198,255,268,203,269,162,115,106,139,246,147,206,202,209,123,265,119,171,195,136,208,108,201,224,261,169,295,93],[30.99,18.78,26.52,30.54,22.39,26.12,23.69,20.67,26.29,25.39,25.68,45.15,21.56,20.17,17.38,20.8,22.31,22.75,26.62,21.43,19.14,23.49,22.66,32.98,25.05,18.31,29.13,27.07,20.37,25.01,19.69,25.97,18.88,20.07,null,26.76,26.97,25.24,20.68,23.72,24.82,23.62,18.65,24.03,23.86,10.63,23.02,23.72,20.82,28.24,null,37.55,18.88,18.3,19.13,21.48,22.59,24.96,21.63,null,29.35,21.76,17.97,22.31,19.27,24.07,22.76,null,13.98,16.46,27.8,27.87,25.42,45.17,44.59,33.78,35.49,19.72,18.56,22.15,23.13,40.93,24.46,31.32,28.17,31.77,24.02,38.02,18.09,31.27,25.03,20.68,25.32,14.65,40.59,27.26,49.31,22.92,43.56,18.78],["Obese","Normal","Overweight","Obese","Normal","Overweight","Normal","Normal","Overweight","Overweight","Overweight","Obese","Normal","Normal","Underweight","Normal","Normal","Normal","Overweight","Normal","Normal","Normal","Normal","Obese","Overweight","Underweight","Overweight","Overweight","Normal","Overweight","Normal","Overweight","Normal","Normal",null,"Overweight","Overweight","Overweight","Normal","Normal","Normal","Normal","Normal","Normal","Normal","Underweight","Normal","Normal","Normal","Overweight",null,"Obese","Normal","Underweight","Normal","Normal","Normal","Normal","Normal",null,"Overweight","Normal","Underweight","Normal","Normal","Normal","Normal",null,"Underweight","Underweight","Overweight","Overweight","Overweight","Obese","Obese","Obese","Obese","Normal","Normal","Normal","Normal","Obese","Normal","Obese","Overweight","Obese","Normal","Obese","Underweight","Obese","Overweight","Normal","Overweight","Underweight","Obese","Overweight","Obese","Normal","Obese","Normal"],["No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","Yes","No","No","No","Yes","No","No","Yes","No","Yes","No","Yes","No","Yes","No","Yes","Yes","No","No","No","No","No","No","Yes","No","No","No","No","No","No","No","Yes","No","Yes","No","No","No","No","No","No","No","Yes","Yes","Yes","No","No"],["No","Yes","No","No","No","Yes","Yes","No","Yes","Yes","No","Yes","Yes","No","Yes","Yes","Yes","Yes","Yes","Yes","No","Yes","No","No","No","Yes","Yes","No","No","No","Yes","No","No","No","No","Yes","Yes","Yes","No","Yes","No","No","Yes","Yes","Yes","Yes","Yes","No","No","Yes","No","No","Yes","Yes","No","Yes","Yes","No","No","No","Yes","No","Yes","Yes","No","No","Yes","Yes","No","No","No","Yes","No","No","Yes","Yes","Yes","Yes","No","No","Yes","No","Yes","No","Yes","No","Yes","Yes","Yes","No","No","Yes","No","No","No","No","No","No","No","Yes"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>age<\/th>\n      <th>age_group<\/th>\n      <th>gender<\/th>\n      <th>ht_in<\/th>\n      <th>wt_lbs<\/th>\n      <th>bmi<\/th>\n      <th>bmi_4cat<\/th>\n      <th>exposure<\/th>\n      <th>outcome<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="example-table-1" class="section level2" number="15.6">
<h2><span class="header-section-number">15.6</span> ğŸ”µ Example: Table 1</h2>
<p>This first example is perhaps the most common type of table we will create â€“ a Table 1 â€“ or basic descriptive table about our participants.</p>
<p>Letâ€™s start by looking at a complete example:</p>
<p><img src="img/06_presenting_results/example_table_1.png" /><!-- --></p>
<p>Here is the minimum code needed to achieve the result in the screenshot above. Below, we will break this code down step-by-step.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="tables.html#cb292-1" aria-hidden="true" tabindex="-1"></a>n_outcome <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb292-2"><a href="tables.html#cb292-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb292-3"><a href="tables.html#cb292-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb292-4"><a href="tables.html#cb292-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">levels</span>(study<span class="sc">$</span>outcome))</span></code></pre></div>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="tables.html#cb293-1" aria-hidden="true" tabindex="-1"></a>cont_stats_fn <span class="ot">&lt;-</span> <span class="cf">function</span>(.data, .outcome, .pred, <span class="at">.digits =</span> <span class="dv">0</span>) {</span>
<span id="cb293-2"><a href="tables.html#cb293-2" aria-hidden="true" tabindex="-1"></a>  .data <span class="sc">%&gt;%</span> </span>
<span id="cb293-3"><a href="tables.html#cb293-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculations</span></span>
<span id="cb293-4"><a href="tables.html#cb293-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>({{ .outcome }}) <span class="sc">%&gt;%</span> </span>
<span id="cb293-5"><a href="tables.html#cb293-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean_table</span>({{ .pred }}) <span class="sc">%&gt;%</span> </span>
<span id="cb293-6"><a href="tables.html#cb293-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format statistics</span></span>
<span id="cb293-7"><a href="tables.html#cb293-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean_format</span>(<span class="st">&quot;mean (lcl - ucl)&quot;</span>, <span class="at">name =</span> <span class="st">&quot;mean_95&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb293-8"><a href="tables.html#cb293-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">var =</span> response_var, group_cat, mean_95) <span class="sc">%&gt;%</span> </span>
<span id="cb293-9"><a href="tables.html#cb293-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Display by group_cat</span></span>
<span id="cb293-10"><a href="tables.html#cb293-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb293-11"><a href="tables.html#cb293-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_from =</span> <span class="st">&quot;group_cat&quot;</span>,</span>
<span id="cb293-12"><a href="tables.html#cb293-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_from =</span> <span class="st">&quot;mean_95&quot;</span></span>
<span id="cb293-13"><a href="tables.html#cb293-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb293-14"><a href="tables.html#cb293-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a blank row</span></span>
<span id="cb293-15"><a href="tables.html#cb293-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(<span class="at">var =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb293-16"><a href="tables.html#cb293-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="tables.html#cb294-1" aria-hidden="true" tabindex="-1"></a>cat_stats_fn <span class="ot">&lt;-</span> <span class="cf">function</span>(.data, .outcome, .pred, <span class="at">.digits =</span> <span class="dv">0</span>) {</span>
<span id="cb294-2"><a href="tables.html#cb294-2" aria-hidden="true" tabindex="-1"></a>  .data <span class="sc">%&gt;%</span> </span>
<span id="cb294-3"><a href="tables.html#cb294-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove rows with missing values</span></span>
<span id="cb294-4"><a href="tables.html#cb294-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ .pred }})) <span class="sc">%&gt;%</span> </span>
<span id="cb294-5"><a href="tables.html#cb294-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculations</span></span>
<span id="cb294-6"><a href="tables.html#cb294-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">freq_table</span>({{ .outcome }}, {{ .pred }}) <span class="sc">%&gt;%</span>  </span>
<span id="cb294-7"><a href="tables.html#cb294-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format statistics</span></span>
<span id="cb294-8"><a href="tables.html#cb294-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">freq_format</span>(<span class="st">&quot;percent_row (lcl_row - ucl_row)&quot;</span>, <span class="at">name =</span> <span class="st">&quot;percent_95&quot;</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb294-9"><a href="tables.html#cb294-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep columns of interest</span></span>
<span id="cb294-10"><a href="tables.html#cb294-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(row_cat, <span class="at">var =</span> col_var, col_cat, percent_95) <span class="sc">%&gt;%</span> </span>
<span id="cb294-11"><a href="tables.html#cb294-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Display by row_cat</span></span>
<span id="cb294-12"><a href="tables.html#cb294-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb294-13"><a href="tables.html#cb294-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_from =</span> <span class="st">&quot;row_cat&quot;</span>,</span>
<span id="cb294-14"><a href="tables.html#cb294-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_from =</span> <span class="st">&quot;percent_95&quot;</span></span>
<span id="cb294-15"><a href="tables.html#cb294-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb294-16"><a href="tables.html#cb294-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add spaces in front of category labels</span></span>
<span id="cb294-17"><a href="tables.html#cb294-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">col_cat =</span> <span class="fu">paste0</span>(<span class="st">&quot;  &quot;</span>, col_cat)) <span class="sc">%&gt;%</span> </span>
<span id="cb294-18"><a href="tables.html#cb294-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Slide category labels under row variable label</span></span>
<span id="cb294-19"><a href="tables.html#cb294-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(<span class="at">col_cat =</span> <span class="sc">!!</span><span class="fu">quo_name</span>(<span class="fu">enquo</span>(.pred)), <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb294-20"><a href="tables.html#cb294-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>var, <span class="at">var =</span> col_cat) <span class="sc">%&gt;%</span> </span>
<span id="cb294-21"><a href="tables.html#cb294-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a blank row</span></span>
<span id="cb294-22"><a href="tables.html#cb294-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(<span class="at">var =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb294-23"><a href="tables.html#cb294-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="tables.html#cb295-1" aria-hidden="true" tabindex="-1"></a>cont_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;ht_in&quot;</span>, <span class="st">&quot;wt_lbs&quot;</span>, <span class="st">&quot;bmi&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="tables.html#cb296-1" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;bmi_4cat&quot;</span>, <span class="st">&quot;exposure&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="tables.html#cb297-1" aria-hidden="true" tabindex="-1"></a>stats_list <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb297-2"><a href="tables.html#cb297-2" aria-hidden="true" tabindex="-1"></a>  cont_cols <span class="sc">%&gt;%</span></span>
<span id="cb297-3"><a href="tables.html#cb297-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(cont_cols) <span class="sc">%&gt;%</span> </span>
<span id="cb297-4"><a href="tables.html#cb297-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">cont_stats_fn</span>(study, outcome, <span class="sc">!!</span> <span class="fu">sym</span>(.x))),</span>
<span id="cb297-5"><a href="tables.html#cb297-5" aria-hidden="true" tabindex="-1"></a>  cat_cols <span class="sc">%&gt;%</span></span>
<span id="cb297-6"><a href="tables.html#cb297-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(cat_cols) <span class="sc">%&gt;%</span> </span>
<span id="cb297-7"><a href="tables.html#cb297-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">cat_stats_fn</span>(study, outcome, <span class="sc">!!</span> <span class="fu">sym</span>(.x)))</span>
<span id="cb297-8"><a href="tables.html#cb297-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="tables.html#cb298-1" aria-hidden="true" tabindex="-1"></a>table_1 <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb298-2"><a href="tables.html#cb298-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">c</span>(<span class="st">&quot;exposure&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;ht_in&quot;</span>, <span class="st">&quot;wt_lbs&quot;</span>, <span class="st">&quot;bmi&quot;</span>, <span class="st">&quot;bmi_4cat&quot;</span>),</span>
<span id="cb298-3"><a href="tables.html#cb298-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">bind_rows</span>(stats_list[[.x]])</span>
<span id="cb298-4"><a href="tables.html#cb298-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="tables.html#cb299-1" aria-hidden="true" tabindex="-1"></a>table_1_ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(table_1) <span class="sc">%&gt;%</span> </span>
<span id="cb299-2"><a href="tables.html#cb299-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change column widths. figure out through trial and error</span></span>
<span id="cb299-3"><a href="tables.html#cb299-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">width =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">2.01</span>, <span class="fl">2.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-4"><a href="tables.html#cb299-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Center the final two columns</span></span>
<span id="cb299-5"><a href="tables.html#cb299-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">j =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="at">align =</span> <span class="st">&quot;center&quot;</span>, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-6"><a href="tables.html#cb299-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change header names -- add subgroup Ns to headers</span></span>
<span id="cb299-7"><a href="tables.html#cb299-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb299-8"><a href="tables.html#cb299-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> <span class="st">&quot;Characteristic&quot;</span>,</span>
<span id="cb299-9"><a href="tables.html#cb299-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">No =</span> <span class="fu">paste0</span>(<span class="st">&quot;No</span><span class="sc">\n</span><span class="st">(n=&quot;</span>, n_outcome[<span class="st">&quot;No&quot;</span>], <span class="st">&quot;)&quot;</span>), </span>
<span id="cb299-10"><a href="tables.html#cb299-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Yes =</span> <span class="fu">paste0</span>(<span class="st">&quot;Yes</span><span class="sc">\n</span><span class="st">(n=&quot;</span>, n_outcome[<span class="st">&quot;Yes&quot;</span>], <span class="st">&quot;)&quot;</span>)</span>
<span id="cb299-11"><a href="tables.html#cb299-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb299-12"><a href="tables.html#cb299-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bold column headers</span></span>
<span id="cb299-13"><a href="tables.html#cb299-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-14"><a href="tables.html#cb299-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Edit row headers</span></span>
<span id="cb299-15"><a href="tables.html#cb299-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;exposure&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;Exposure, row percent (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-16"><a href="tables.html#cb299-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;age&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;Age, mean (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-17"><a href="tables.html#cb299-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;age_group&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;Age group, row percent (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb299-18"><a href="tables.html#cb299-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;gender&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;Gender, row percent (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-19"><a href="tables.html#cb299-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;ht_in&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;Height, mean (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-20"><a href="tables.html#cb299-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;wt_lbs&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;Weight, mean (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-21"><a href="tables.html#cb299-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;bmi&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;BMI, mean (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-22"><a href="tables.html#cb299-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;bmi_4cat&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;BMI category, row percent (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb299-23"><a href="tables.html#cb299-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add footnotes</span></span>
<span id="cb299-24"><a href="tables.html#cb299-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(</span>
<span id="cb299-25"><a href="tables.html#cb299-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">17</span>), <span class="at">j =</span> <span class="dv">1</span>,</span>
<span id="cb299-26"><a href="tables.html#cb299-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as_paragraph</span>(</span>
<span id="cb299-27"><a href="tables.html#cb299-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">&quot;Age in years.&quot;</span>, <span class="st">&quot;Height in inches.&quot;</span>, <span class="st">&quot;Weight in pounds.&quot;</span>)</span>
<span id="cb299-28"><a href="tables.html#cb299-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb299-29"><a href="tables.html#cb299-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb299-30"><a href="tables.html#cb299-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove vertical cell padding</span></span>
<span id="cb299-31"><a href="tables.html#cb299-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">padding</span>(<span class="at">padding.top =</span> <span class="dv">0</span>, <span class="at">padding.bottom =</span> <span class="dv">0</span>, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-32"><a href="tables.html#cb299-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change font to TNR 11</span></span>
<span id="cb299-33"><a href="tables.html#cb299-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">fontname =</span> <span class="st">&quot;Times New Roman&quot;</span>, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb299-34"><a href="tables.html#cb299-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">&quot;all&quot;</span>, <span class="at">size =</span> <span class="dv">11</span>)</span></code></pre></div>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="tables.html#cb300-1" aria-hidden="true" tabindex="-1"></a>doc <span class="ot">&lt;-</span> <span class="fu">read_docx</span>(<span class="st">&quot;examples/template_descriptive_analysis.docx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb300-2"><a href="tables.html#cb300-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_replace_text_at_bkm</span>(<span class="st">&quot;date&quot;</span>, <span class="fu">as.character</span>(<span class="fu">Sys.Date</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb300-3"><a href="tables.html#cb300-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_replace_text_at_bkm</span>(<span class="st">&quot;n_table_1&quot;</span>, <span class="fu">as.character</span>(<span class="fu">sum</span>(n_outcome))) <span class="sc">%&gt;%</span> </span>
<span id="cb300-4"><a href="tables.html#cb300-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_replace_flextable_at_bkm</span>(<span class="st">&quot;table_1&quot;</span>, table_1_ft)</span></code></pre></div>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="tables.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(</span>
<span id="cb301-2"><a href="tables.html#cb301-2" aria-hidden="true" tabindex="-1"></a>  doc,</span>
<span id="cb301-3"><a href="tables.html#cb301-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;examples/Example Table 1.docx&quot;</span></span>
<span id="cb301-4"><a href="tables.html#cb301-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><a href="https://www.dropbox.com/s/hgludqft5mpdtf0/Example%20Table%201.docx?dl=0">Link to Word Document on Dropbox</a></p>
<p>After cleaning your data, which isnâ€™t covered in this chapter, a typical workflow for creating a Table 1 like this may look like the following:</p>
<div id="step-1.-calculate-the-outcome-distribution" class="section level3" number="15.6.1">
<h3><span class="header-section-number">15.6.1</span> Step 1. Calculate the outcome distribution</h3>
<p>As our first step, we typically want to see how many people have each value for the outcome of interest. We will also store these values so that we can add them to our table header as (N = XX) later.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="tables.html#cb302-1" aria-hidden="true" tabindex="-1"></a>n_outcome <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb302-2"><a href="tables.html#cb302-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb302-3"><a href="tables.html#cb302-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb302-4"><a href="tables.html#cb302-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">levels</span>(study<span class="sc">$</span>outcome))</span>
<span id="cb302-5"><a href="tables.html#cb302-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-6"><a href="tables.html#cb302-6" aria-hidden="true" tabindex="-1"></a>n_outcome</span></code></pre></div>
<pre><code>##  No Yes 
##  51  49</code></pre>
</div>
<div id="step-2.-prepare-to-calculate-summary-statistics" class="section level3" number="15.6.2">
<h3><span class="header-section-number">15.6.2</span> Step 2. Prepare to calculate summary statistics</h3>
<div id="calculate-statistics-for-single-variables" class="section level4" number="15.6.2.1">
<h4><span class="header-section-number">15.6.2.1</span> Calculate statistics for single variables</h4>
<p>Eventually, we are going to want to calculate summary statistics for multiple different variables that will go into our Table 1. Before we do that, it can be useful to write code that will calculate the summary statistics we are interested in for one continuous variable and one categorical variable. Later, we can use <a href="https://www.r4epi.com/introduction-to-repeated-operations.html">iterative processing</a> to apply that code to all of the variables we are interested in.</p>
<div class="note">
<p>ğŸ—’<strong>Side Note:</strong> This chapter isnâ€™t about how to calculate or interpret all the various different statistics we may want to calculate from project to project. For more details on descriptive statistics see:</p>
<ul>
<li><a href="https://www.r4epi.com/introduction-to-descriptive-analysis.html">R4Epi Descriptive Analysis</a><br />
</li>
<li><a href="placeholder">meantables</a><br />
</li>
<li><a href="placeholder">freqtables</a><br />
</li>
</ul>
</div>
<div id="one-continuous-variable" class="section level5" number="15.6.2.1.1">
<h5><span class="header-section-number">15.6.2.1.1</span> One continuous variable</h5>
<p>In this example, we want to calculate the mean and 95% confidence interval for continuous variables. Because this is an example, we will break it down into multiple steps. In a real analysis, we would probably put all of the code in this section into a single code chunk.</p>
<div id="calculations" class="section level6" number="15.6.2.1.1.1">
<h6><span class="header-section-number">15.6.2.1.1.1</span> Calculations</h6>
<p>Do the basic calculations. Here we are using the <code>mean_table()</code> function from the <code>meantables</code> package.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="tables.html#cb304-1" aria-hidden="true" tabindex="-1"></a>one_cont_var <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb304-2"><a href="tables.html#cb304-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb304-3"><a href="tables.html#cb304-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_table</span>(age) <span class="sc">%&gt;%</span> </span>
<span id="cb304-4"><a href="tables.html#cb304-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 Ã— 11
##   response_var group_var group_cat     n  mean    sd   sem   lcl   ucl   min
##   &lt;chr&gt;        &lt;chr&gt;     &lt;fct&gt;     &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 age          outcome   No           51  34.9  15.2  2.13  30.6  39.2    22
## 2 age          outcome   Yes          49  35.4  18.2  2.59  30.1  40.6    18
## # â€¦ with 1 more variable: max &lt;dbl&gt;</code></pre>
</div>
<div id="format-statistics" class="section level6" number="15.6.2.1.1.2">
<h6><span class="header-section-number">15.6.2.1.1.2</span> Format statistics</h6>
<p>Combine the mean and 95% confidence interval into a single variable and keep only the columns of interest for reporting.</p>
<p>Additionally, we no longer need the <code>group_var</code> column and we will rename <code>response_var</code> to <code>var</code> to make it easier to row bind with our categorical variables later.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="tables.html#cb306-1" aria-hidden="true" tabindex="-1"></a>one_cont_var <span class="ot">&lt;-</span> one_cont_var <span class="sc">%&gt;%</span> </span>
<span id="cb306-2"><a href="tables.html#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_format</span>(<span class="st">&quot;mean (lcl - ucl)&quot;</span>, <span class="at">name =</span> <span class="st">&quot;mean_95&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb306-3"><a href="tables.html#cb306-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">var =</span> response_var, group_cat, mean_95) <span class="sc">%&gt;%</span> </span>
<span id="cb306-4"><a href="tables.html#cb306-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 Ã— 3
##   var   group_cat mean_95              
##   &lt;chr&gt; &lt;fct&gt;     &lt;chr&gt;                
## 1 age   No        34.9 (30.62 - 39.18) 
## 2 age   Yes       35.35 (30.13 - 40.56)</code></pre>
</div>
<div id="display-by-group_cat" class="section level6" number="15.6.2.1.1.3">
<h6><span class="header-section-number">15.6.2.1.1.3</span> Display by group_cat</h6>
<p>In the final table, we donâ€™t want the results stacked on top of each other vertically, we want them spread out horizontally across columns â€“ one column for each level (i.e., category) of our outcome variable. We can use <code>pivot_wider()</code> from the <code>tidyr</code> package to do this. See the chapter on <a href="https://www.r4epi.com/restructuring-data-frames.html">restructuring data frames</a> for more info on pivot_wider.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="tables.html#cb308-1" aria-hidden="true" tabindex="-1"></a>one_cont_var <span class="ot">&lt;-</span> one_cont_var <span class="sc">%&gt;%</span> </span>
<span id="cb308-2"><a href="tables.html#cb308-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb308-3"><a href="tables.html#cb308-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="st">&quot;group_cat&quot;</span>,</span>
<span id="cb308-4"><a href="tables.html#cb308-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="st">&quot;mean_95&quot;</span></span>
<span id="cb308-5"><a href="tables.html#cb308-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb308-6"><a href="tables.html#cb308-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 Ã— 3
##   var   No                   Yes                  
##   &lt;chr&gt; &lt;chr&gt;                &lt;chr&gt;                
## 1 age   34.9 (30.62 - 39.18) 35.35 (30.13 - 40.56)</code></pre>
</div>
<div id="add-a-blank-row" class="section level6" number="15.6.2.1.1.4">
<h6><span class="header-section-number">15.6.2.1.1.4</span> Add a blank row</h6>
<p>Finally, we want to add a blank row to the bottom of our results table. This will create some vertical separation between variables in our table when we eventually row bind all the variables together.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="tables.html#cb310-1" aria-hidden="true" tabindex="-1"></a>one_cont_var <span class="ot">&lt;-</span> one_cont_var <span class="sc">%&gt;%</span></span>
<span id="cb310-2"><a href="tables.html#cb310-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">var =</span> <span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb310-3"><a href="tables.html#cb310-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 Ã— 3
##   var   No                   Yes                  
##   &lt;chr&gt; &lt;chr&gt;                &lt;chr&gt;                
## 1 &quot;age&quot; 34.9 (30.62 - 39.18) 35.35 (30.13 - 40.56)
## 2 &quot;&quot;    &lt;NA&gt;                 &lt;NA&gt;</code></pre>
</div>
<div id="putting-it-all-together" class="section level6" number="15.6.2.1.1.5">
<h6><span class="header-section-number">15.6.2.1.1.5</span> Putting it all together</h6>
<p>And thatâ€™s the final result we are looking for. Putting it all together, it looks like this:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="tables.html#cb312-1" aria-hidden="true" tabindex="-1"></a>one_cont_var <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb312-2"><a href="tables.html#cb312-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculations</span></span>
<span id="cb312-3"><a href="tables.html#cb312-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb312-4"><a href="tables.html#cb312-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_table</span>(age) <span class="sc">%&gt;%</span> </span>
<span id="cb312-5"><a href="tables.html#cb312-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Format statistics</span></span>
<span id="cb312-6"><a href="tables.html#cb312-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_format</span>(<span class="st">&quot;mean (lcl - ucl)&quot;</span>, <span class="at">name =</span> <span class="st">&quot;mean_95&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb312-7"><a href="tables.html#cb312-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">var =</span> response_var, group_cat, mean_95) <span class="sc">%&gt;%</span> </span>
<span id="cb312-8"><a href="tables.html#cb312-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display by group_cat</span></span>
<span id="cb312-9"><a href="tables.html#cb312-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb312-10"><a href="tables.html#cb312-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="st">&quot;group_cat&quot;</span>,</span>
<span id="cb312-11"><a href="tables.html#cb312-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="st">&quot;mean_95&quot;</span></span>
<span id="cb312-12"><a href="tables.html#cb312-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb312-13"><a href="tables.html#cb312-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a blank row</span></span>
<span id="cb312-14"><a href="tables.html#cb312-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">var =</span> <span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb312-15"><a href="tables.html#cb312-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 Ã— 3
##   var   No                   Yes                  
##   &lt;chr&gt; &lt;chr&gt;                &lt;chr&gt;                
## 1 &quot;age&quot; 34.9 (30.62 - 39.18) 35.35 (30.13 - 40.56)
## 2 &quot;&quot;    &lt;NA&gt;                 &lt;NA&gt;</code></pre>
<p><a href="tables.html#table-functions-1">Below</a>, we will combine the whole sequence together into a function that we can call repeatedly on each of our continuous variables.</p>
</div>
</div>
<div id="one-categorical-variable" class="section level5" number="15.6.2.1.2">
<h5><span class="header-section-number">15.6.2.1.2</span> One categorical variable</h5>
<p>In this example, we want to calculate the row percent and 95% confidence interval for categorical variables. Because this is an example, we will break it down into multiple steps. In a real analysis, we would probably put all of the code in this section into a single code chunk.</p>
<div id="calculations-1" class="section level6" number="15.6.2.1.2.1">
<h6><span class="header-section-number">15.6.2.1.2.1</span> Calculations</h6>
<p>Do the basic calculations. Here we are using the <code>freq_table()</code> function from the <code>freqtables</code> package.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="tables.html#cb314-1" aria-hidden="true" tabindex="-1"></a>one_cat_var <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb314-2"><a href="tables.html#cb314-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">freq_table</span>(outcome, age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb314-3"><a href="tables.html#cb314-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 4 Ã— 17
##   row_var row_cat col_var   col_cat       n n_row n_total percent_total se_total
##   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;int&gt; &lt;int&gt;   &lt;int&gt;         &lt;dbl&gt;    &lt;dbl&gt;
## 1 outcome No      age_group Younger â€¦    29    51     100            29     4.56
## 2 outcome No      age_group 30 and Oâ€¦    22    51     100            22     4.16
## 3 outcome Yes     age_group Younger â€¦    31    49     100            31     4.65
## 4 outcome Yes     age_group 30 and Oâ€¦    18    49     100            18     3.86
## # â€¦ with 8 more variables: t_crit_total &lt;dbl&gt;, lcl_total &lt;dbl&gt;,
## #   ucl_total &lt;dbl&gt;, percent_row &lt;dbl&gt;, se_row &lt;dbl&gt;, t_crit_row &lt;dbl&gt;,
## #   lcl_row &lt;dbl&gt;, ucl_row &lt;dbl&gt;</code></pre>
</div>
<div id="format-statistics-1" class="section level6" number="15.6.2.1.2.2">
<h6><span class="header-section-number">15.6.2.1.2.2</span> Format statistics</h6>
<p>Combine the row percent and 95% confidence interval into a single variable and keep only the columns of interest for reporting.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="tables.html#cb316-1" aria-hidden="true" tabindex="-1"></a>one_cat_var <span class="ot">&lt;-</span> one_cat_var <span class="sc">%&gt;%</span></span>
<span id="cb316-2"><a href="tables.html#cb316-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">freq_format</span>(<span class="st">&quot;percent_row (lcl_row - ucl_row)&quot;</span>, <span class="at">name =</span> <span class="st">&quot;percent_95&quot;</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb316-3"><a href="tables.html#cb316-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 4 Ã— 18
##   row_var row_cat col_var   col_cat       n n_row n_total percent_total se_total
##   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;int&gt; &lt;int&gt;   &lt;int&gt;         &lt;dbl&gt;    &lt;dbl&gt;
## 1 outcome No      age_group Younger â€¦    29    51     100            29     4.56
## 2 outcome No      age_group 30 and Oâ€¦    22    51     100            22     4.16
## 3 outcome Yes     age_group Younger â€¦    31    49     100            31     4.65
## 4 outcome Yes     age_group 30 and Oâ€¦    18    49     100            18     3.86
## # â€¦ with 9 more variables: t_crit_total &lt;dbl&gt;, lcl_total &lt;dbl&gt;,
## #   ucl_total &lt;dbl&gt;, percent_row &lt;dbl&gt;, se_row &lt;dbl&gt;, t_crit_row &lt;dbl&gt;,
## #   lcl_row &lt;dbl&gt;, ucl_row &lt;dbl&gt;, percent_95 &lt;chr&gt;</code></pre>
</div>
<div id="keep-columns-of-interest" class="section level6" number="15.6.2.1.2.3">
<h6><span class="header-section-number">15.6.2.1.2.3</span> Keep columns of interest</h6>
<p>We only need the values from <code>row_cat</code>, <code>col_var</code>, <code>col_cat</code>, and <code>percent_95</code> in our final table. Additionally, we will rename <code>col_var</code> to <code>var</code> to make it easier to row bind with our continuous variables later.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="tables.html#cb318-1" aria-hidden="true" tabindex="-1"></a>one_cat_var <span class="ot">&lt;-</span> one_cat_var <span class="sc">%&gt;%</span></span>
<span id="cb318-2"><a href="tables.html#cb318-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(row_cat, <span class="at">var =</span> col_var, col_cat, percent_95) <span class="sc">%&gt;%</span> </span>
<span id="cb318-3"><a href="tables.html#cb318-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 4 Ã— 4
##   row_cat var       col_cat         percent_95           
##   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;                
## 1 No      age_group Younger than 30 56.86 (42.79 - 69.91)
## 2 No      age_group 30 and Older    43.14 (30.09 - 57.21)
## 3 Yes     age_group Younger than 30 63.27 (48.74 - 75.73)
## 4 Yes     age_group 30 and Older    36.73 (24.27 - 51.26)</code></pre>
</div>
<div id="display-by-row_cat" class="section level6" number="15.6.2.1.2.4">
<h6><span class="header-section-number">15.6.2.1.2.4</span> Display by row_cat</h6>
<p>In the final table, we donâ€™t want all of the results stacked on top of each other vertically as it is above. Instead, we want the results spread out horizontally across columns â€“ one column for each level (i.e., category) of our outcome variable. We can use <code>pivot_wider()</code> from the <code>tidyr</code> package to do this. See the chapter on <a href="https://www.r4epi.com/restructuring-data-frames.html">restructuring data frames</a> for more info on pivot_wider.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="tables.html#cb320-1" aria-hidden="true" tabindex="-1"></a>one_cat_var <span class="ot">&lt;-</span> one_cat_var <span class="sc">%&gt;%</span> </span>
<span id="cb320-2"><a href="tables.html#cb320-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb320-3"><a href="tables.html#cb320-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="st">&quot;row_cat&quot;</span>,</span>
<span id="cb320-4"><a href="tables.html#cb320-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="st">&quot;percent_95&quot;</span></span>
<span id="cb320-5"><a href="tables.html#cb320-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb320-6"><a href="tables.html#cb320-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 Ã— 4
##   var       col_cat         No                    Yes                  
##   &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;                 &lt;chr&gt;                
## 1 age_group Younger than 30 56.86 (42.79 - 69.91) 63.27 (48.74 - 75.73)
## 2 age_group 30 and Older    43.14 (30.09 - 57.21) 36.73 (24.27 - 51.26)</code></pre>
</div>
<div id="add-spaces-in-front-of-category-labels" class="section level6" number="15.6.2.1.2.5">
<h6><span class="header-section-number">15.6.2.1.2.5</span> Add spaces in front of category labels</h6>
<p>In our final Word table, we will want our category labels (e.g., â€œYounger than 30â€ and â€œ30 and Olderâ€) to be indented slightly relative to the row variable label (e.g., â€œage_groupâ€). We will go ahead and add 2 spaces now.</p>
<p class="note">
ğŸ—’<strong>Side Note:</strong> The spaces wonâ€™t be visible while testing in RStudio, but they will show up in the final Word document.
</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="tables.html#cb322-1" aria-hidden="true" tabindex="-1"></a>one_cat_var <span class="ot">&lt;-</span> one_cat_var <span class="sc">%&gt;%</span> </span>
<span id="cb322-2"><a href="tables.html#cb322-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col_cat =</span> <span class="fu">paste0</span>(<span class="st">&quot;  &quot;</span>, col_cat)) <span class="sc">%&gt;%</span></span>
<span id="cb322-3"><a href="tables.html#cb322-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 Ã— 4
##   var       col_cat             No                    Yes                  
##   &lt;chr&gt;     &lt;chr&gt;               &lt;chr&gt;                 &lt;chr&gt;                
## 1 age_group &quot;  Younger than 30&quot; 56.86 (42.79 - 69.91) 63.27 (48.74 - 75.73)
## 2 age_group &quot;  30 and Older&quot;    43.14 (30.09 - 57.21) 36.73 (24.27 - 51.26)</code></pre>
</div>
<div id="slide-category-labels-under-row-variable-label" class="section level6" number="15.6.2.1.2.6">
<h6><span class="header-section-number">15.6.2.1.2.6</span> Slide category labels under row variable label</h6>
<p>In our final Word table, we will want our category labels (e.g., â€œYounger than 30â€ and â€œ30 and Olderâ€) to be in the same column â€“ and underneath â€“ the row variable label (e.g., â€œage_groupâ€).</p>
<p>In other words, we want our final table to look like this:</p>
<table>
<thead>
<tr class="header">
<th align="left">Characteristic</th>
<th align="center">No</th>
<th align="center">Yes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Age Group</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Younger than 30</td>
<td align="center">56.14 (42.86 - 68.59)</td>
<td align="center">65.12 (49.54 - 78.02)</td>
</tr>
<tr class="odd">
<td align="left">30 and Older</td>
<td align="center">43.86 (31.41 - 57.14)</td>
<td align="center">34.88 (21.98 - 50.46)</td>
</tr>
</tbody>
</table>
<p>Instead of this:</p>
<table>
<thead>
<tr class="header">
<th align="left">Characteristic</th>
<th align="center">Category</th>
<th align="center">No</th>
<th align="center">Yes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Age Group</td>
<td align="center">Younger than 30</td>
<td align="center">56.14 (42.86 - 68.59)</td>
<td align="center">65.12 (49.54 - 78.02)</td>
</tr>
<tr class="even">
<td align="left">Age group</td>
<td align="center">30 and Older</td>
<td align="center">43.86 (31.41 - 57.14)</td>
<td align="center">34.88 (21.98 - 50.46)</td>
</tr>
</tbody>
</table>
<p>To do this, we will:</p>
<ol style="list-style-type: decimal">
<li>Add a new top row to the data frame that will contain the variable label in the current col_cat column.<br />
</li>
<li>Drop the current <code>var</code> column, which is no longer needed.<br />
</li>
<li>Rename the <code>col_cat</code> to <code>var</code> to make it easier to row bind with our categorical variables later.</li>
</ol>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="tables.html#cb324-1" aria-hidden="true" tabindex="-1"></a>one_cat_var <span class="ot">&lt;-</span> one_cat_var <span class="sc">%&gt;%</span></span>
<span id="cb324-2"><a href="tables.html#cb324-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">col_cat =</span> <span class="st">&quot;age_group&quot;</span>, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb324-3"><a href="tables.html#cb324-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>var, <span class="at">var =</span> col_cat) <span class="sc">%&gt;%</span> </span>
<span id="cb324-4"><a href="tables.html#cb324-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 Ã— 3
##   var                 No                    Yes                  
##   &lt;chr&gt;               &lt;chr&gt;                 &lt;chr&gt;                
## 1 &quot;age_group&quot;         &lt;NA&gt;                  &lt;NA&gt;                 
## 2 &quot;  Younger than 30&quot; 56.86 (42.79 - 69.91) 63.27 (48.74 - 75.73)
## 3 &quot;  30 and Older&quot;    43.14 (30.09 - 57.21) 36.73 (24.27 - 51.26)</code></pre>
</div>
<div id="add-a-blank-row-1" class="section level6" number="15.6.2.1.2.7">
<h6><span class="header-section-number">15.6.2.1.2.7</span> Add a blank row</h6>
<p>Finally, we want to add a blank row to the bottom of our results table. This will create some vertical separation between variables in our table when we eventually row bind all the variables together.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="tables.html#cb326-1" aria-hidden="true" tabindex="-1"></a>one_cat_var <span class="ot">&lt;-</span> one_cat_var <span class="sc">%&gt;%</span></span>
<span id="cb326-2"><a href="tables.html#cb326-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">var =</span> <span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb326-3"><a href="tables.html#cb326-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 4 Ã— 3
##   var                 No                    Yes                  
##   &lt;chr&gt;               &lt;chr&gt;                 &lt;chr&gt;                
## 1 &quot;age_group&quot;         &lt;NA&gt;                  &lt;NA&gt;                 
## 2 &quot;  Younger than 30&quot; 56.86 (42.79 - 69.91) 63.27 (48.74 - 75.73)
## 3 &quot;  30 and Older&quot;    43.14 (30.09 - 57.21) 36.73 (24.27 - 51.26)
## 4 &quot;&quot;                  &lt;NA&gt;                  &lt;NA&gt;</code></pre>
</div>
<div id="putting-it-all-together-1" class="section level6" number="15.6.2.1.2.8">
<h6><span class="header-section-number">15.6.2.1.2.8</span> Putting it all together</h6>
<p>And thatâ€™s the final result we are looking for. Putting it all together, it looks like this:</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="tables.html#cb328-1" aria-hidden="true" tabindex="-1"></a>one_cat_var <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb328-2"><a href="tables.html#cb328-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculations</span></span>
<span id="cb328-3"><a href="tables.html#cb328-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">freq_table</span>(outcome, age_group) <span class="sc">%&gt;%</span>  </span>
<span id="cb328-4"><a href="tables.html#cb328-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Format statistics</span></span>
<span id="cb328-5"><a href="tables.html#cb328-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">freq_format</span>(<span class="st">&quot;percent_row (lcl_row - ucl_row)&quot;</span>, <span class="at">name =</span> <span class="st">&quot;percent_95&quot;</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb328-6"><a href="tables.html#cb328-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep columns of interest</span></span>
<span id="cb328-7"><a href="tables.html#cb328-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(row_cat, <span class="at">var =</span> col_var, col_cat, percent_95) <span class="sc">%&gt;%</span> </span>
<span id="cb328-8"><a href="tables.html#cb328-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display by row_cat</span></span>
<span id="cb328-9"><a href="tables.html#cb328-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb328-10"><a href="tables.html#cb328-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="st">&quot;row_cat&quot;</span>,</span>
<span id="cb328-11"><a href="tables.html#cb328-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="st">&quot;percent_95&quot;</span></span>
<span id="cb328-12"><a href="tables.html#cb328-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb328-13"><a href="tables.html#cb328-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add spaces in front of category labels</span></span>
<span id="cb328-14"><a href="tables.html#cb328-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col_cat =</span> <span class="fu">paste0</span>(<span class="st">&quot;  &quot;</span>, col_cat)) <span class="sc">%&gt;%</span> </span>
<span id="cb328-15"><a href="tables.html#cb328-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Slide category labels under row variable label</span></span>
<span id="cb328-16"><a href="tables.html#cb328-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">col_cat =</span> <span class="st">&quot;age_group&quot;</span>, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb328-17"><a href="tables.html#cb328-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>var, <span class="at">var =</span> col_cat) <span class="sc">%&gt;%</span> </span>
<span id="cb328-18"><a href="tables.html#cb328-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a blank row</span></span>
<span id="cb328-19"><a href="tables.html#cb328-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">var =</span> <span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb328-20"><a href="tables.html#cb328-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 4 Ã— 3
##   var                 No                    Yes                  
##   &lt;chr&gt;               &lt;chr&gt;                 &lt;chr&gt;                
## 1 &quot;age_group&quot;         &lt;NA&gt;                  &lt;NA&gt;                 
## 2 &quot;  Younger than 30&quot; 56.86 (42.79 - 69.91) 63.27 (48.74 - 75.73)
## 3 &quot;  30 and Older&quot;    43.14 (30.09 - 57.21) 36.73 (24.27 - 51.26)
## 4 &quot;&quot;                  &lt;NA&gt;                  &lt;NA&gt;</code></pre>
<p><a href="tables.html#table-functions-1">Below</a>, we will combine the whole sequence together into a function that we can call repeatedly on each of our continuous variables.</p>
</div>
</div>
</div>
<div id="table-functions-1" class="section level4" number="15.6.2.2">
<h4><span class="header-section-number">15.6.2.2</span> Create helper functions</h4>
<p>Above, we saw how to calculate the summary statistics we wanted for one continuous variable and one categorical variable. We could repeat that process for each variable we are interested in using copy and paste, but it is much more efficient and much less error prone to wrap those processes in a function that we can call repeatedly on each variable we want to analyze. Thatâ€™s what we will do in this section.</p>
<p>In each of the code chunks below, all weâ€™re going to do is cut the copy the code from above, paste it below, wrap it in the <code>function()</code> function, and then make a few tweaks that will allow us to repeatedly pass variable names into the code. See the chapter on <a href="https://www.r4epi.com/writing-functions.html">writing functions</a> for more info on pivot_wider.</p>
<div id="continuous-stats-function" class="section level5" number="15.6.2.2.1">
<h5><span class="header-section-number">15.6.2.2.1</span> Continuous stats function</h5>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="tables.html#cb330-1" aria-hidden="true" tabindex="-1"></a>cont_stats_fn <span class="ot">&lt;-</span> <span class="cf">function</span>(.data, .outcome, .pred, <span class="at">.digits =</span> <span class="dv">0</span>) {</span>
<span id="cb330-2"><a href="tables.html#cb330-2" aria-hidden="true" tabindex="-1"></a>  .data <span class="sc">%&gt;%</span> </span>
<span id="cb330-3"><a href="tables.html#cb330-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculations</span></span>
<span id="cb330-4"><a href="tables.html#cb330-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>({{ .outcome }}) <span class="sc">%&gt;%</span> </span>
<span id="cb330-5"><a href="tables.html#cb330-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean_table</span>({{ .pred }}) <span class="sc">%&gt;%</span> </span>
<span id="cb330-6"><a href="tables.html#cb330-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format statistics</span></span>
<span id="cb330-7"><a href="tables.html#cb330-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean_format</span>(<span class="st">&quot;mean (lcl - ucl)&quot;</span>, <span class="at">name =</span> <span class="st">&quot;mean_95&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb330-8"><a href="tables.html#cb330-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">var =</span> response_var, group_cat, mean_95) <span class="sc">%&gt;%</span> </span>
<span id="cb330-9"><a href="tables.html#cb330-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Display by group_cat</span></span>
<span id="cb330-10"><a href="tables.html#cb330-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb330-11"><a href="tables.html#cb330-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_from =</span> <span class="st">&quot;group_cat&quot;</span>,</span>
<span id="cb330-12"><a href="tables.html#cb330-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_from =</span> <span class="st">&quot;mean_95&quot;</span></span>
<span id="cb330-13"><a href="tables.html#cb330-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb330-14"><a href="tables.html#cb330-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a blank row</span></span>
<span id="cb330-15"><a href="tables.html#cb330-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(<span class="at">var =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb330-16"><a href="tables.html#cb330-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb330-17"><a href="tables.html#cb330-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-18"><a href="tables.html#cb330-18" aria-hidden="true" tabindex="-1"></a><span class="co"># For testing</span></span>
<span id="cb330-19"><a href="tables.html#cb330-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cont_stats_fn</span>(study, outcome, age, <span class="at">.digits =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 Ã— 3
##   var   No                   Yes                  
##   &lt;chr&gt; &lt;chr&gt;                &lt;chr&gt;                
## 1 &quot;age&quot; 34.9 (30.62 - 39.18) 35.35 (30.13 - 40.56)
## 2 &quot;&quot;    &lt;NA&gt;                 &lt;NA&gt;</code></pre>
</div>
<div id="categoorical-stats-function" class="section level5" number="15.6.2.2.2">
<h5><span class="header-section-number">15.6.2.2.2</span> Categoorical stats function</h5>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="tables.html#cb332-1" aria-hidden="true" tabindex="-1"></a>cat_stats_fn <span class="ot">&lt;-</span> <span class="cf">function</span>(.data, .outcome, .pred, <span class="at">.digits =</span> <span class="dv">0</span>) {</span>
<span id="cb332-2"><a href="tables.html#cb332-2" aria-hidden="true" tabindex="-1"></a>  .data <span class="sc">%&gt;%</span> </span>
<span id="cb332-3"><a href="tables.html#cb332-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove rows with missing values</span></span>
<span id="cb332-4"><a href="tables.html#cb332-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>({{ .pred }})) <span class="sc">%&gt;%</span> </span>
<span id="cb332-5"><a href="tables.html#cb332-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculations</span></span>
<span id="cb332-6"><a href="tables.html#cb332-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">freq_table</span>({{ .outcome }}, {{ .pred }}) <span class="sc">%&gt;%</span>  </span>
<span id="cb332-7"><a href="tables.html#cb332-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format statistics</span></span>
<span id="cb332-8"><a href="tables.html#cb332-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">freq_format</span>(<span class="st">&quot;percent_row (lcl_row - ucl_row)&quot;</span>, <span class="at">name =</span> <span class="st">&quot;percent_95&quot;</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb332-9"><a href="tables.html#cb332-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep columns of interest</span></span>
<span id="cb332-10"><a href="tables.html#cb332-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(row_cat, <span class="at">var =</span> col_var, col_cat, percent_95) <span class="sc">%&gt;%</span> </span>
<span id="cb332-11"><a href="tables.html#cb332-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Display by row_cat</span></span>
<span id="cb332-12"><a href="tables.html#cb332-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb332-13"><a href="tables.html#cb332-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_from =</span> <span class="st">&quot;row_cat&quot;</span>,</span>
<span id="cb332-14"><a href="tables.html#cb332-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_from =</span> <span class="st">&quot;percent_95&quot;</span></span>
<span id="cb332-15"><a href="tables.html#cb332-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb332-16"><a href="tables.html#cb332-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add spaces in front of category labels</span></span>
<span id="cb332-17"><a href="tables.html#cb332-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">col_cat =</span> <span class="fu">paste0</span>(<span class="st">&quot;  &quot;</span>, col_cat)) <span class="sc">%&gt;%</span> </span>
<span id="cb332-18"><a href="tables.html#cb332-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Slide category labels under row variable label</span></span>
<span id="cb332-19"><a href="tables.html#cb332-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(<span class="at">col_cat =</span> <span class="sc">!!</span><span class="fu">quo_name</span>(<span class="fu">enquo</span>(.pred)), <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb332-20"><a href="tables.html#cb332-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>var, <span class="at">var =</span> col_cat) <span class="sc">%&gt;%</span> </span>
<span id="cb332-21"><a href="tables.html#cb332-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a blank row</span></span>
<span id="cb332-22"><a href="tables.html#cb332-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_row</span>(<span class="at">var =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb332-23"><a href="tables.html#cb332-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb332-24"><a href="tables.html#cb332-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-25"><a href="tables.html#cb332-25" aria-hidden="true" tabindex="-1"></a><span class="co"># For testing</span></span>
<span id="cb332-26"><a href="tables.html#cb332-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat_stats_fn</span>(study, outcome, bmi_4cat, <span class="at">.digits =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 Ã— 3
##   var             No                    Yes                  
##   &lt;chr&gt;           &lt;chr&gt;                 &lt;chr&gt;                
## 1 &quot;bmi_4cat&quot;      &lt;NA&gt;                  &lt;NA&gt;                 
## 2 &quot;  Underweight&quot; 6.25 (1.98 - 18.07)   12.50 (5.62 - 25.53) 
## 3 &quot;  Normal&quot;      45.83 (32.12 - 60.21) 52.08 (37.84 - 65.99)
## 4 &quot;  Overweight&quot;  22.92 (12.99 - 37.19) 25.00 (14.59 - 39.42)
## 5 &quot;  Obese&quot;       25.00 (14.59 - 39.42) 10.42 (4.31 - 23.08) 
## 6 &quot;&quot;              &lt;NA&gt;                  &lt;NA&gt;</code></pre>
</div>
</div>
</div>
<div id="step-3.-create-a-data-frame-that-contains-our-summary-statistics" class="section level3" number="15.6.3">
<h3><span class="header-section-number">15.6.3</span> Step 3. Create a data frame that contains our summary statistics</h3>
<p>In general, we wonâ€™t want to <strong>present</strong> or <strong>distribute</strong> summary statistics in the form of an R data frame. However, an preliminary step in creating our final table â€“ regardless of the method we use â€“ will usually be to create an R data frame that contains our summary statistics of interest.</p>
<p>The next step in this proc</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="tables.html#cb334-1" aria-hidden="true" tabindex="-1"></a>cont_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;ht_in&quot;</span>, <span class="st">&quot;wt_lbs&quot;</span>, <span class="st">&quot;bmi&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="tables.html#cb335-1" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;bmi_4cat&quot;</span>, <span class="st">&quot;exposure&quot;</span>)</span></code></pre></div>
<div id="repeatedly-apply-cont_stats_fn" class="section level4" number="15.6.3.1">
<h4><span class="header-section-number">15.6.3.1</span> Repeatedly apply cont_stats_fn</h4>
<p>Calculate summary statistics for each of the continuous variables we are interested in. Each time we pass a new variable to <code>cont_stats_fn</code> the result will be a data frame of summary statistics for that variable. For now, we will save each of those data frames to a list that we can later reorder and row bind together.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="tables.html#cb336-1" aria-hidden="true" tabindex="-1"></a>stats_list <span class="ot">&lt;-</span> cont_cols <span class="sc">%&gt;%</span></span>
<span id="cb336-2"><a href="tables.html#cb336-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(cont_cols) <span class="sc">%&gt;%</span> </span>
<span id="cb336-3"><a href="tables.html#cb336-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">cont_stats_fn</span>(study, outcome, <span class="sc">!!</span> <span class="fu">sym</span>(.x)))</span></code></pre></div>
</div>
<div id="repeatedly-apply-cat_stats_fn" class="section level4" number="15.6.3.2">
<h4><span class="header-section-number">15.6.3.2</span> Repeatedly apply cat_stats_fn</h4>
<p>Calculate summary statistics for each of the categorical variables we are interested in. Each time we pass a new variable to <code>cat_stats_fn</code> the result will be a data frame of summary statistics for that variable. For now, we will save each of those data frames to a list that we can later reorder and row bind together.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="tables.html#cb337-1" aria-hidden="true" tabindex="-1"></a>stats_list <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb337-2"><a href="tables.html#cb337-2" aria-hidden="true" tabindex="-1"></a>  stats_list,</span>
<span id="cb337-3"><a href="tables.html#cb337-3" aria-hidden="true" tabindex="-1"></a>  cat_cols <span class="sc">%&gt;%</span></span>
<span id="cb337-4"><a href="tables.html#cb337-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(cat_cols) <span class="sc">%&gt;%</span> </span>
<span id="cb337-5"><a href="tables.html#cb337-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">cat_stats_fn</span>(study, outcome, <span class="sc">!!</span> <span class="fu">sym</span>(.x)))</span>
<span id="cb337-6"><a href="tables.html#cb337-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>At this point, <code>stats_list</code> contains all of our summary statistics of interest as a list of data frames.</p>
</div>
<div id="bind-together-the-continuous-and-categorical-summary-stats" class="section level4" number="15.6.3.3">
<h4><span class="header-section-number">15.6.3.3</span> Bind together the continuous and categorical summary stats</h4>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="tables.html#cb338-1" aria-hidden="true" tabindex="-1"></a>table_1 <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb338-2"><a href="tables.html#cb338-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">c</span>(<span class="st">&quot;exposure&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;ht_in&quot;</span>, <span class="st">&quot;wt_lbs&quot;</span>, <span class="st">&quot;bmi&quot;</span>, <span class="st">&quot;bmi_4cat&quot;</span>),</span>
<span id="cb338-3"><a href="tables.html#cb338-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">bind_rows</span>(stats_list[[.x]])</span>
<span id="cb338-4"><a href="tables.html#cb338-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb338-5"><a href="tables.html#cb338-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 26 Ã— 3
##    var                 No                    Yes                  
##    &lt;chr&gt;               &lt;chr&gt;                 &lt;chr&gt;                
##  1 &quot;exposure&quot;          &lt;NA&gt;                  &lt;NA&gt;                 
##  2 &quot;  No&quot;              76.47 (62.65 - 86.30) 91.84 (79.81 - 96.97)
##  3 &quot;  Yes&quot;             23.53 (13.70 - 37.35) 8.16 (3.03 - 20.19)  
##  4 &quot;&quot;                  &lt;NA&gt;                  &lt;NA&gt;                 
##  5 &quot;age&quot;               34.9 (30.62 - 39.18)  35.35 (30.13 - 40.56)
##  6 &quot;&quot;                  &lt;NA&gt;                  &lt;NA&gt;                 
##  7 &quot;age_group&quot;         &lt;NA&gt;                  &lt;NA&gt;                 
##  8 &quot;  Younger than 30&quot; 56.86 (42.79 - 69.91) 63.27 (48.74 - 75.73)
##  9 &quot;  30 and Older&quot;    43.14 (30.09 - 57.21) 36.73 (24.27 - 51.26)
## 10 &quot;&quot;                  &lt;NA&gt;                  &lt;NA&gt;                 
## # â€¦ with 16 more rows</code></pre>
<p>Remove the final blank row. It makes the Word table look cleaner.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="tables.html#cb340-1" aria-hidden="true" tabindex="-1"></a>table_1 <span class="ot">&lt;-</span> <span class="fu">slice</span>(table_1, <span class="sc">-</span><span class="fu">nrow</span>(table_1))</span></code></pre></div>
<p class="note">
ğŸ—’<strong>Side Note:</strong> It might be interesting/worthwhile to come back to this at some point and turn everything from in â€œStep 3. Create a data frame that contains our summary statisticsâ€ into a function.
</p>
</div>
</div>
<div id="step-5.-create-flextable" class="section level3" number="15.6.4">
<h3><span class="header-section-number">15.6.4</span> Step 5. Create flextable</h3>
<p>At this point, we have a complete table of summary statistics and it is roughly laid out in the way we want it to be. But, as we discussed above, we donâ€™t want to <strong>present</strong> or <strong>distribute</strong> summary statistics in the form of an R data frame. The <code>flextable</code> package is one awesome tool we can use to transform our data frames of summary statistics into presentation-ready tables for Word, PowerPoint, or HTML documents. The <a href="flextable.html#flextable">flextable</a> chapter gives more details on using the <code>flextable</code> package. But, for the sake of completeness, we will go ahead and finish our formatted Table 1.</p>
<p>Technically, the following single function call will turn our Table 1 into a <code>flextable</code> object.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="tables.html#cb341-1" aria-hidden="true" tabindex="-1"></a>table_1_ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(table_1)</span>
<span id="cb341-2"><a href="tables.html#cb341-2" aria-hidden="true" tabindex="-1"></a>table_1_ft</span></code></pre></div>
<template id="5768c53c-45f8-4013-86a0-291ce97e23ec"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-e5444064{border-collapse:collapse;}.cl-e53ed458{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e53ee290{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e53f1daa{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e53f1dc8{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e53f1ddc{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-e5444064'>
<thead><tr style="overflow-wrap:break-word;"><td class="cl-e53f1ddc"><p class="cl-e53ee290"><span class="cl-e53ed458">var</span></p></td><td class="cl-e53f1ddc"><p class="cl-e53ee290"><span class="cl-e53ed458">No</span></p></td><td class="cl-e53f1ddc"><p class="cl-e53ee290"><span class="cl-e53ed458">Yes</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">exposure</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">  No</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">76.47 (62.65 - 86.30)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">91.84 (79.81 - 96.97)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">  Yes</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">23.53 (13.70 - 37.35)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">8.16 (3.03 - 20.19)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">age</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">34.9 (30.62 - 39.18)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">35.35 (30.13 - 40.56)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">age_group</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">  Younger than 30</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">56.86 (42.79 - 69.91)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">63.27 (48.74 - 75.73)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">  30 and Older</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">43.14 (30.09 - 57.21)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">36.73 (24.27 - 51.26)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">gender</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">  Female</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">58.82 (44.68 - 71.64)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">55.10 (40.83 - 68.58)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">  Male</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">41.18 (28.36 - 55.32)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">44.90 (31.42 - 59.17)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">ht_in</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">66.88 (65.56 - 68.2)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">66.5 (65.29 - 67.71)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">wt_lbs</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">165.44 (151.92 - 178.96)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">155.21 (140.71 - 169.71)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">bmi</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">26.03 (23.76 - 28.31)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">24.38 (22.5 - 26.27)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">bmi_4cat</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">  Underweight</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">6.25 (1.98 - 18.07)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">12.50 (5.62 - 25.53)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">  Normal</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">45.83 (32.12 - 60.21)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">52.08 (37.84 - 65.99)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">  Overweight</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">22.92 (12.99 - 37.19)</span></p></td><td class="cl-e53f1daa"><p class="cl-e53ee290"><span class="cl-e53ed458">25.00 (14.59 - 39.42)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e53f1dc8"><p class="cl-e53ee290"><span class="cl-e53ed458">  Obese</span></p></td><td class="cl-e53f1dc8"><p class="cl-e53ee290"><span class="cl-e53ed458">25.00 (14.59 - 39.42)</span></p></td><td class="cl-e53f1dc8"><p class="cl-e53ee290"><span class="cl-e53ed458">10.42 (4.31 - 23.08)</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="3775dcb1-e9ac-440c-b715-d3cd1cc60f2b"></div>
<script>
var dest = document.getElementById("3775dcb1-e9ac-440c-b715-d3cd1cc60f2b");
var template = document.getElementById("5768c53c-45f8-4013-86a0-291ce97e23ec");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

</div>
<div id="step-6.-formatting-flextable" class="section level3" number="15.6.5">
<h3><span class="header-section-number">15.6.5</span> Step 6. Formatting flextable</h3>
<p>The <code>flextable</code> object we created above is a good start; however, we will still want to do some additional formatting before presenting our final table 1 to others.</p>
<p class="note">
ğŸ—’<strong>Side Note:</strong> We could have done some of this formatting directly in the R data frame, but itâ€™s generally a good idea to do formatting in the <code>flextable</code> object when possible.
</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="tables.html#cb342-1" aria-hidden="true" tabindex="-1"></a>table_1_ft <span class="ot">&lt;-</span> table_1_ft <span class="sc">%&gt;%</span> </span>
<span id="cb342-2"><a href="tables.html#cb342-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change column widths. figure out through trial and error</span></span>
<span id="cb342-3"><a href="tables.html#cb342-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">width =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">2.01</span>, <span class="fl">2.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb342-4"><a href="tables.html#cb342-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Center the final two columns</span></span>
<span id="cb342-5"><a href="tables.html#cb342-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">j =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="at">align =</span> <span class="st">&quot;center&quot;</span>, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb342-6"><a href="tables.html#cb342-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change header names -- add subgroup Ns to headers</span></span>
<span id="cb342-7"><a href="tables.html#cb342-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb342-8"><a href="tables.html#cb342-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> <span class="st">&quot;Characteristic&quot;</span>,</span>
<span id="cb342-9"><a href="tables.html#cb342-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">No =</span> <span class="fu">paste0</span>(<span class="st">&quot;No</span><span class="sc">\n</span><span class="st">(n=&quot;</span>, n_outcome[<span class="st">&quot;No&quot;</span>], <span class="st">&quot;)&quot;</span>), </span>
<span id="cb342-10"><a href="tables.html#cb342-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Yes =</span> <span class="fu">paste0</span>(<span class="st">&quot;Yes</span><span class="sc">\n</span><span class="st">(n=&quot;</span>, n_outcome[<span class="st">&quot;Yes&quot;</span>], <span class="st">&quot;)&quot;</span>)</span>
<span id="cb342-11"><a href="tables.html#cb342-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb342-12"><a href="tables.html#cb342-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bold column headers</span></span>
<span id="cb342-13"><a href="tables.html#cb342-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb342-14"><a href="tables.html#cb342-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Edit row headers</span></span>
<span id="cb342-15"><a href="tables.html#cb342-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;exposure&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;Exposure, row percent (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb342-16"><a href="tables.html#cb342-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;age&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;Age, mean (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb342-17"><a href="tables.html#cb342-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;age_group&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;Age group, row percent (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb342-18"><a href="tables.html#cb342-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;gender&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;Gender, row percent (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb342-19"><a href="tables.html#cb342-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;ht_in&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;Height, mean (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb342-20"><a href="tables.html#cb342-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;wt_lbs&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;Weight, mean (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb342-21"><a href="tables.html#cb342-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;bmi&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;BMI, mean (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb342-22"><a href="tables.html#cb342-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">i =</span> <span class="sc">~</span> var <span class="sc">==</span> <span class="st">&quot;bmi_4cat&quot;</span>, <span class="at">j =</span> <span class="dv">1</span>, <span class="fu">as_paragraph</span>(<span class="st">&quot;BMI category, row percent (95% CI)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb342-23"><a href="tables.html#cb342-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add footnotes</span></span>
<span id="cb342-24"><a href="tables.html#cb342-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(</span>
<span id="cb342-25"><a href="tables.html#cb342-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">17</span>), <span class="at">j =</span> <span class="dv">1</span>,</span>
<span id="cb342-26"><a href="tables.html#cb342-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as_paragraph</span>(</span>
<span id="cb342-27"><a href="tables.html#cb342-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">&quot;Age in years.&quot;</span>, <span class="st">&quot;Height in inches.&quot;</span>, <span class="st">&quot;Weight in pounds.&quot;</span>)</span>
<span id="cb342-28"><a href="tables.html#cb342-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb342-29"><a href="tables.html#cb342-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb342-30"><a href="tables.html#cb342-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove vertical cell padding</span></span>
<span id="cb342-31"><a href="tables.html#cb342-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">padding</span>(<span class="at">padding.top =</span> <span class="dv">0</span>, <span class="at">padding.bottom =</span> <span class="dv">0</span>, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb342-32"><a href="tables.html#cb342-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change font to TNR 11</span></span>
<span id="cb342-33"><a href="tables.html#cb342-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">font</span>(<span class="at">fontname =</span> <span class="st">&quot;Times New Roman&quot;</span>, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb342-34"><a href="tables.html#cb342-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">&quot;all&quot;</span>, <span class="at">size =</span> <span class="dv">11</span>)</span>
<span id="cb342-35"><a href="tables.html#cb342-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb342-36"><a href="tables.html#cb342-36" aria-hidden="true" tabindex="-1"></a>table_1_ft</span></code></pre></div>
<template id="dc4f3f98-7f23-481a-9766-5c8880485319"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-e55924a2{border-collapse:collapse;}.cl-e5544eb4{font-family:'Times New Roman';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e5544ec8{font-family:'Times New Roman';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e5544ed2{font-family:'Times New Roman';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-e5545b02{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e5545b16{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e554927a{width:144.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e554928e{width:180pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5549298{width:180pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e5549299{width:144.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e55492a2{width:180pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e55492ac{width:144.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e55492b6{width:144.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e55492b7{width:180pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-e55924a2'>
<thead><tr style="overflow-wrap:break-word;"><td class="cl-e55492b7"><p class="cl-e5545b02"><span class="cl-e5544eb4">Characteristic</span></p></td><td class="cl-e55492b6"><p class="cl-e5545b16"><span class="cl-e5544eb4">No<br>(n=51)</span></p></td><td class="cl-e55492b6"><p class="cl-e5545b16"><span class="cl-e5544eb4">Yes<br>(n=49)</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">Exposure, row percent (95% CI)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">  No</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">76.47 (62.65 - 86.30)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">91.84 (79.81 - 96.97)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">  Yes</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">23.53 (13.70 - 37.35)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">8.16 (3.03 - 20.19)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">Age, mean (95% CI)</span><span class="cl-e5544ed2">1</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">34.9 (30.62 - 39.18)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">35.35 (30.13 - 40.56)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">Age group, row percent (95% CI)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">  Younger than 30</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">56.86 (42.79 - 69.91)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">63.27 (48.74 - 75.73)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">  30 and Older</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">43.14 (30.09 - 57.21)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">36.73 (24.27 - 51.26)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">Gender, row percent (95% CI)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">  Female</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">58.82 (44.68 - 71.64)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">55.10 (40.83 - 68.58)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">  Male</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">41.18 (28.36 - 55.32)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">44.90 (31.42 - 59.17)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">Height, mean (95% CI)</span><span class="cl-e5544ed2">2</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">66.88 (65.56 - 68.2)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">66.5 (65.29 - 67.71)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">Weight, mean (95% CI)</span><span class="cl-e5544ed2">3</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">165.44 (151.92 - 178.96)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">155.21 (140.71 - 169.71)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">BMI, mean (95% CI)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">26.03 (23.76 - 28.31)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">24.38 (22.5 - 26.27)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">BMI category, row percent (95% CI)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">  Underweight</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">6.25 (1.98 - 18.07)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">12.50 (5.62 - 25.53)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">  Normal</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">45.83 (32.12 - 60.21)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">52.08 (37.84 - 65.99)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e554928e"><p class="cl-e5545b02"><span class="cl-e5544ec8">  Overweight</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">22.92 (12.99 - 37.19)</span></p></td><td class="cl-e554927a"><p class="cl-e5545b16"><span class="cl-e5544ec8">25.00 (14.59 - 39.42)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e5549298"><p class="cl-e5545b02"><span class="cl-e5544ec8">  Obese</span></p></td><td class="cl-e5549299"><p class="cl-e5545b16"><span class="cl-e5544ec8">25.00 (14.59 - 39.42)</span></p></td><td class="cl-e5549299"><p class="cl-e5545b16"><span class="cl-e5544ec8">10.42 (4.31 - 23.08)</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td  colspan="3"class="cl-e55492a2"><p class="cl-e5545b02"><span class="cl-e5544ed2">1</span><span class="cl-e5544ec8">Age in years.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  colspan="3"class="cl-e55492a2"><p class="cl-e5545b02"><span class="cl-e5544ed2">2</span><span class="cl-e5544ec8">Height in inches.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  colspan="3"class="cl-e55492a2"><p class="cl-e5545b02"><span class="cl-e5544ed2">3</span><span class="cl-e5544ec8">Weight in pounds.</span></p></td></tr></tfoot></table></div></template>
<div class="flextable-shadow-host" id="2019e362-a563-4c53-a239-6d8941b3259f"></div>
<script>
var dest = document.getElementById("2019e362-a563-4c53-a239-6d8941b3259f");
var template = document.getElementById("dc4f3f98-7f23-481a-9766-5c8880485319");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

</div>
<div id="load-word-template-for-officer" class="section level3" number="15.6.6">
<h3><span class="header-section-number">15.6.6</span> ğŸ“ Load Word template for officer</h3>
<p>In general, it seems helpful/expedient to do as much of the prose and formatting as possible directly in the Word template. Then, just add numbers, tables, and graphs from R with bookmarks.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="tables.html#cb343-1" aria-hidden="true" tabindex="-1"></a>doc <span class="ot">&lt;-</span> <span class="fu">read_docx</span>(<span class="st">&quot;examples/template_descriptive_analysis.docx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb343-2"><a href="tables.html#cb343-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_replace_text_at_bkm</span>(<span class="st">&quot;date&quot;</span>, <span class="fu">as.character</span>(<span class="fu">Sys.Date</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb343-3"><a href="tables.html#cb343-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_replace_text_at_bkm</span>(<span class="st">&quot;n_table_1&quot;</span>, <span class="fu">as.character</span>(<span class="fu">sum</span>(n_outcome))) <span class="sc">%&gt;%</span> </span>
<span id="cb343-4"><a href="tables.html#cb343-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_replace_flextable_at_bkm</span>(<span class="st">&quot;table_1&quot;</span>, table_1_ft)</span></code></pre></div>
</div>
<div id="generate-word-reports" class="section level3" number="15.6.7">
<h3><span class="header-section-number">15.6.7</span> ğŸ“ Generate Word reports</h3>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="tables.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(</span>
<span id="cb344-2"><a href="tables.html#cb344-2" aria-hidden="true" tabindex="-1"></a>  doc,</span>
<span id="cb344-3"><a href="tables.html#cb344-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;examples/Example Table 1.docx&quot;</span></span>
<span id="cb344-4"><a href="tables.html#cb344-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><a href="https://www.dropbox.com/s/hgludqft5mpdtf0/Example%20Table%201.docx?dl=0">Link to Word Document on Dropbox</a></p>
<!--
Clean up and add session info
-->

</div>
</div>
</div>




</div>




</div>
            </section>

          </div>
        </div>
      </div>
<a href="officer.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="git-and-github.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
